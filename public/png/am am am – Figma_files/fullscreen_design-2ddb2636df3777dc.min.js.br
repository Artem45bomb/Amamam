
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="7baa5104-b8e8-590b-b8d5-69ff3dd61e38")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[1085],{120289:(e,t,n)=>{"use strict";n.d(t,{b:()=>r});var a=n(163638);async function r(e){let t=(0,a.D)(),n=new Map,r=RegExp("url\\(['\"]?(.+?)['\"]?\\)","g");for(let a of e.matchAll(r)){let e;let r=a[1];if(!r)continue;try{e=new URL(r)}catch(e){continue}let o=new URLSearchParams(e.hash.slice(1)).get("filename");if(!o||!o.endsWith(".png"))continue;let l=o.slice(0,-4),i=t.getImageByHash(l);if(!i)continue;let s=await i.getBytesAsync();if(!s)continue;let c=new Blob([s],{type:"image/png"}),d=await function(e){return new Promise((t,n)=>{let a=new FileReader;a.onloadend=()=>{let e=a.result;if("string"==typeof e){t(e);return}n(Error("Failed to convert blob to base64"))},a.onerror=n,a.readAsDataURL(e)})}(c);n.set(a.index,d)}return e.replace(r,(e,t,a)=>e.replace(t,n.get(a)??t))??e}},646738:(e,t,n)=>{"use strict";n.d(t,{A7:()=>i,i4:()=>l,nt:()=>o});var a=n(302245),r=n(109392);let o=e=>e.library.localStyleSelection,l=(0,a.Mz)([o,(e,t)=>t],(e,t)=>e?.type===t?e:null),i=(0,a.Mz)([l,(e,t,n)=>n],(e,t)=>{if(!e)return null;let n=new Set,a=new Set;return e.folderNames.forEach(e=>{let o=t.find(t=>"STYLE_FOLDER"===t.type&&t.name===e);o&&((0,r.KU)(o).forEach(e=>{n.add(e.name)}),(0,r.dm)(o).forEach(e=>{a.add(e.node_id)}))}),{type:e.type,folderNames:n,styleIds:a}})},666169:(e,t,n)=>{"use strict";let a;n.r(t),n.d(t,{DesignView:()=>gL});var r=n(411855),o=n(188507),l=n(511655),i=n(922827),s=n(474474),c=n(406755),d=n(301929),p=n(325202),m=n(263132),u=n(115630),E=n(298455),g=n(659302),y=n(740941),_=n(34087),h=n(917756),f=n(558134),v=n(56182),b=n(858799),S=n(271160),T=n(411171),N=n(118256),I=n(659283),P=n(542030),C=n(839980),k=n(404158),A=n(978760),w=n(325010),O=n(967617);let x=(0,s.ck)("bfb358109ac5994e69048d8390d3a0c334253aa8");function R(){let[e,t]=r.useState(null),[n,a]=r.useState(null),o=(0,N._X)({subscribeToUpdates_expensive:!0}),l=(0,g.Xr)(w.hj),i=(0,g.Xr)(w.d1),s=(0,y.md)(w.Sp),c=(0,g.Xr)(w.Sp),p=r.useRef(null),m=(0,S.Z)("dev-handoff-rfd-signals-frame-upsell"),R=r.useCallback(()=>{p.current&&a(p.current.absoluteBounds.height*o.zoomScale)},[o.zoomScale]);r.useEffect(()=>{if(!e)return;let t=`dev-node-change-upsell-${e}`,n=(0,T.EE)(t,[e],e=>{p.current=e.position,R()});return p.current=n.currentNodePosition[e]?.position||null,R(),()=>{(0,T.lB)(t)}},[e,R]);let L=(0,h.cR)(),{show:D,complete:M,uniqueId:K,isShowing:F}=(0,v.e)({overlay:A.kBA,priority:I.N.HIGH_PRIORITY_MODAL,experiment:{check:L,predicate:e=>e,postCheck:()=>!0}});return(r.useEffect(()=>{i({fn:M})},[M,i]),(0,f.E)(K,["frame_node_name_changed_with_rfd_indicator"],async e=>{if(!e.properties.nodeId)return;let n=(0,E.UN)().get(e.properties.nodeId);n&&0!==n.childCount&&!s&&(t(e.properties.nodeId),l(e.properties.nodeId),a(n.absoluteBoundingBox.h),await m(await (0,N.QZ)({nodeId:e.properties.nodeId,alwaysPan:!0})),D(),c(!0))}),e&&F)?r.createElement(C.NJ,{className:O.R3,targetKey:e,dismissModal:M,arrowPosition:P.F_.LEFT_TITLE,width:240,backgroundColor:"var(--color-bg)",topOffset:n?-n/2-15:0,leftOffset:12,closeButtonClassName:O.b,noAnimation:!0,isCanvasNode:!0,shouldNotWrapInParagraphTag:!0},r.createElement("div",{className:O.Rg},(0,d.t)("dev_handoff.rfd_signals_upsell.title")),r.createElement("div",{className:O.O6},r.createElement("div",{className:O.j},r.createElement(k.GV,{src:x,width:240})),r.createElement("div",{className:O.zu},(0,d.t)("dev_handoff.rfd_signals_upsell.description"))),r.createElement("div",{className:O.JP},r.createElement(u.v,{mode:"dev-handoff"},r.createElement(_.$z,{variant:"primary",onClick:function(){e&&(M(),b.z4.setNodesReady(!0,[e],"dev-node-change-upsell",null))}},(0,d.t)("dev_handoff.rfd_signals_upsell.mark_ready_for_dev"))))):null}var L=n(126517),D=n(327064),M=n(352074),K=n(775448),F=n(195909),V=n(256659),U=n(222903),B=n(349762),G=n(844882),z=n(846995),W=n(579557),H=n(840862),Y=n(60843),$=n(530313),X=n(472403),j=n(723319),Q=n(389790),J=n(187854),q=n(634484),Z=n(862151),ee=n(9063),et=n(912675),en=n(197416),ea=n(899469),er=n(139558),eo=n(556576),el=n(972973),ei=n(546619),es=n(1829),ec=n(378851),ed=n(432995),ep=n(122865);let em=(0,et.tf)(M.N);function eu(){let e=(0,h.o9)(),t=(0,eo.tS)(),n=(0,H.BI)(),a=function(){let e;let t=(0,es.hr)(e=>e).getRoot(),n=t=>{for(let a of t.childrenNodes)(a.isTopLevelFrame()||"CANVAS"===a.type)&&(a.hasReadyStatus?e?e.getStatusInfo().lastUpdateUnixTimestamp<a.getStatusInfo().lastUpdateUnixTimestamp&&(e=a):e=a:("SECTION"===a.type||"CANVAS"===a.type)&&n(a))};return n(t),e?.getStatusInfo()}(),o=(0,el.wW)(a?.userId??null),l=!!a&&B.A.unix(a.lastUpdateUnixTimestamp).isAfter((0,B.A)().subtract(60,"day")),i=(0,ed.U)("upsell"),c=G.Rs(ei.HdA,{key:t??""},{enabled:!!t})?.data?.file?.hasPermission,p=(0,y.md)(en.LZ),m=(0,er.aV)(),u=(0,$._I)(),E=(0,$.U4)(),g=(0,y.md)(ea.NT),_=(0,J.J)(),b=(0,h.Oc)(),{show:S,complete:T,isShowing:N,uniqueId:P}=(0,v.e)({overlay:A.koo,priority:I.N.OVERRIDING_MODAL},[g]);(0,r.useEffect)(()=>{S({canShow:t=>_&&p&&!u&&"loaded"===n.status&&!n.hasPendingRequest&&l&&E&&!m&&("developer"===t||"software-development"===t||e(t))})},[S,u,E,p,m,g,_,n,l,e]),(0,f.E)(P,"Enter Inspect Mode",()=>{N&&T()});let C=(0,q.BC)({dismissModal:T,onRequestAccess:()=>{c&&i("handoff")}}),k=r.useCallback(()=>{T(),C.hidden||C.onClick(Z.i$.Upsell)},[T,C]),w=r.createElement(em,{newTab:!0,trusted:!0,trackingProperties:{trackingDescriptor:ee.c.READ_THE_GUIDE},href:D.z},(0,d.tx)("dev_mode.onboarding_callout.read_the_guide")),O=r.createElement(r.Fragment,null,r.createElement("span",{className:ep.XQ},r.createElement(U.O,null)),r.createElement("span",{className:W.cx.textBodyMediumStrong.$},(0,d.tx)("dev_handoff.status.mark_status_sentence_part.ready_for_dev"))),x=b()?r.createElement(j.vB,null):r.createElement(r.Fragment,null,r.createElement("div",{className:ep.DD},(0,d.tx)("dev_handoff.paywall.blocking_modal.title.dev_onboarding")),r.createElement("ul",null,r.createElement("li",{className:ep.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.copy_code")),r.createElement("li",{className:ep.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.track_design_changes")),r.createElement("li",{className:ep.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.customize_plugins"))),r.createElement("div",{className:ep.jg},c?(0,d.tx)("dev_handoff.paywall.blocking_modal.content.explore_for_free_with_link",{learnMoreLink:w}):(0,d.tx)("dev_handoff.paywall.blocking_modal.content.curious_to_learn_more",{learnMoreLink:w}))),R=(0,X.W)(),L=K.hS({open:!0,onClose:z.lQ,preventUserClose:!0,recordingKey:"dev-mode-paywall-modal"});return r.createElement(ec.M,{testId:"rfd-upsell-upsell",isShowing:N},r.createElement("div",{"data-editor-theme":"dev-handoff"},r.createElement(Y.OM,null),r.createElement(et.fu,{name:"RFD Upsell Modal",properties:R,enabled:R?.gracePeriod!==void 0},r.createElement(F.bL,{width:392,manager:L},r.createElement(V.Wk,null,r.createElement("div",{className:ep.XV},o.loading?"":(0,d.tx)("dev_handoff.upsell.user_marked_a design",{userName:o.user?.name||o.user?.handle,status:O})),r.createElement("div",{className:W.cx.py8.px16.$},r.createElement(Q.E,{imgSrc:(0,s.ck)("6d5e9cb0e9ec7fd5dd58425c5527dc8a78143a19"),content:x,modalType:"RFD Upsell Modal",primaryButtonLabel:(0,d.tx)("dev_handoff.paywall.blocking_modal.button.request_access"),primaryButtonType:"request_access",primaryButtonOnClick:C.hidden?void 0:k,secondaryButtonLabel:(0,d.tx)("dev_handoff.paywall.blocking_modal.button.not_now"),secondaryButtonType:"not_now",secondaryButtonOnClick:T})))))))}var eE=n(550707),eg=n(317004),ey=n(897392),e_=n(720793),eh=n(865046),ef=n(994073),ev=n(232087),eb=n(381218),eS=n(985091),eT=n(132878),eN=n(72400),eI=n(157599),eP=n(447266),eC=n(837287),ek=n(915576),eA=n(764554),ew=n(723789),eO=n(847132),ex=n(551857),eR=n(983767),eL=n(686644),eD=n(15544),eM=n(438476),eK=n(545854),eF=n(565652),eV=n(727466),eU=n(139689),eB=n(629019),eG=n.n(eB),ez=n(196302),eW=n(376793),eH=n(772391),eY=n(315711),e$=n(919122),eX=n(101072),ej=n(628673),eQ=n(25448),eJ=n(244609),eq=n(43166),eZ=n(989364),e0=n(192567),e1=n(976411),e4=n(731922);let e2="starting_points_templates_modal--templateOption--qYXkm",e8="starting_points_templates_modal--templateOptionTitle--DmVPR",e5="starting_points_templates_modal--verticalTemplateImage--kAzQz";var e3=(e=>(e.DESKTOP="desktop",e.MOBILE="mobile",e.WEBSITE="website",e))(e3||{});let e7={x:0,y:0},e6={website:{x:0,y:1600},mobile:{x:0,y:300},desktop:{x:0,y:300}},e9={website:.1,mobile:.225,desktop:.1},te=e=>{let t=(0,s.Ay)().starting_points;switch(e){case"basics":return t?.figma_basics_hub_file_id;case"desktop":return t?.desktop_templates_hub_file_id;case"mobile":return t?.mobile_templates_hub_file_id;case"website":return t?.website_templates_hub_file_id}};function tt({onClose:e}){let t=(0,o.wA)(),n=r.useRef(null),[a,l]=r.useState(!1),[c,p]=r.useState(!1),[m,u]=r.useState(!1),[E,_]=r.useState(!1),[h,f]=r.useState(window.innerWidth),v=(0,eJ.q)(),b=(0,eo.tS)(),S=(0,o.d4)(e=>e.fileVersion),T=(0,o.d4)(e=>e.mirror.sceneGraph),N=v&&(0,eK.Qf)(T),I=!!N&&0===N.childCount,[P]=(0,eH.IT)((0,ej.tH)({})),C=!!(0,s.kc)().starting_points_ghost_previews,{insertTemplate:k}=(0,eQ.Fz)(),A=(0,e1.g)(),w=(0,g.Xr)(e4.Yq),O=(0,g.Xr)(e4.bj),[x,R]=r.useState(!1),L=(0,eZ.GQ)(),D=(0,e0.P)();(0,eW.h)(()=>{let e=()=>{f(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),r.useEffect(()=>{_(L+50>h/2-257||h-D-50<h/2+257),u(L+50>h/2-365||h-D-50<h/2+365)},[L,D,h]);let M=r.useCallback(()=>{if(!C||"loaded"!==P.status||!P.data)return;let e=[];for(let t of Object.values(e3)){let n=te(t);if(!n)return;let a=P.data[n];if(!a)return;let r={type:eq.n.HubFile,template:a};e.push(r)}Promise.all(e.map(e=>y.zl.get((0,e4.Re)({fileKey:b,fileVersion:S,template:e})))).then(()=>{R(!0)}).catch(e=>{console.error("Failed to load template buffers",e),R(!0)})},[b,S,P,C]);if(r.useEffect(()=>{"loaded"!==P.status||x||M()},[P,x,M]),r.useEffect(()=>{v&&N&&!I&&!c&&e()},[v,N,I,c,e]),!(0,s.kc)().starting_points_modal)return null;let K=async n=>{if("loaded"!==P.status)return;l(!0);let a=te(n);if(!a)return;let r=P.data[a];r&&(C&&"basics"!==n?await (0,eQ.Zg)({insert:()=>O({selectTemplateAfterCommit:!1,moveViewportAfterCommit:!1,priority:"user-visible",editScopeType:i.zkO.USER}),template:{template:r,type:eq.n.HubFile},fileKey:b,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1}):await k({template:{template:r,type:eq.n.HubFile},userTriggered:!1,editScopeType:i.zkO.ONBOARDING,triggeredFrom:"starting-points",templateInsertionDirection:i.hKj.RIGHT}),"basics"===n?(0,eX.YQ)({id:"starting_points_basics_template_inserted"}):(0,eX.YQ)({id:"starting_points_template_inserted"}),e(),l(!1))},F=r.createElement(et.$z,{onClick:()=>K("basics"),trackingProperties:{trackingDescriptor:ee.c.LEARN_THE_BASICS}},(0,d.tx)("starting_points.learn_the_basics")),V=e=>{if((0,ez.sx)("Starting Points Template Option Hover",{template:e}),!C)return;let n=te(e);if(!n||!P.data)return;let a=P.data[n];if(!a)return;let r={type:eq.n.HubFile,template:a},o=e9[e];window.innerWidth>1700&&(o*=1.5),(0,eQ.Zg)({insert:()=>A(r,{moveViewportAfterPreview:!0,priority:"user-visible",previewManager:{nodeType:i.Z6A.CANVAS},position:e7,viewportOptions:{position:e6[e],scale:o,duration:0}}),template:r,fileKey:b,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1,isPreview:!0})},U=()=>{C&&w()};return r.createElement(et.fu,{name:"Starting Points Modal"},r.createElement("div",{className:"starting_points_templates_modal--startingPointsTemplatesModalPositioner--R8g3u"},r.createElement(e$.x,{isLoading:a,className:"starting_points_templates_modal--loadingSpinner--UOrjg"},()=>r.createElement("div",{className:eG()({"starting_points_templates_modal--startingPointsTemplatesModal--dUQte":!0,"starting_points_templates_modal--isHidden--jVN1L":E,"starting_points_templates_modal--isCondensedView--3tVz6":m}),onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),ref:n},r.createElement("div",{className:"starting_points_templates_modal--modalInstructions--ZtdTL"},r.createElement("div",{className:"starting_points_templates_modal--modalTitle--HT3eZ"},(0,d.t)("starting_points.what_do_you_want_to_make_today")),r.createElement("div",{className:"starting_points_templates_modal--modalLearnMore--g-GWo"},(0,d.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:F}))),r.createElement("div",{className:"starting_points_templates_modal--optionContainer--mYEsG"},r.createElement(et.$z,{className:e2,onClick:()=>K("website"),onMouseEnter:()=>V("website"),onMouseLeave:U,trackingProperties:{trackingDescriptor:ee.c.WEBSITE_TEMPLATES}},r.createElement("div",{className:e8},(0,d.t)("starting_points.website")),r.createElement(eY.oW,{className:e5,src:(0,s.ck)("9b8475fdab7c1ed3cd1c0d16b957d65a80840b74"),alt:"Website template"})),r.createElement(et.$z,{className:e2,onClick:()=>K("mobile"),onMouseEnter:()=>V("mobile"),onMouseLeave:U,trackingProperties:{trackingDescriptor:ee.c.MOBILE_APP_TEMPLATES}},r.createElement("div",{className:e8},(0,d.t)("starting_points.mobile_app")),r.createElement(eY.oW,{className:e5,src:(0,s.ck)("b262e57bed515b9f0da45ae54fa43824d9704c14"),alt:"Mobile app template"})),r.createElement(et.$z,{className:e2,onClick:()=>K("desktop"),onMouseEnter:()=>V("desktop"),onMouseLeave:U,trackingProperties:{trackingDescriptor:ee.c.DESKTOP_APP_TEMPLATES}},r.createElement("div",{className:e8},(0,d.t)("starting_points.desktop_app")),r.createElement(eY.oW,{className:"starting_points_templates_modal--desktopTemplateImage--3kplg",src:(0,s.ck)("cb2f715253dacb4e7d3fb211ff2792fc28a38832"),alt:"Desktop app template"}))),r.createElement("div",{className:"starting_points_templates_modal--modalLearnMoreFooter--pSvfX"},(0,d.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:F})),r.createElement("div",{className:"starting_points_templates_modal--closeButton--io-14"},r.createElement(eV.K,{onClick:e,"aria-label":(0,d.t)("general.close"),htmlAttributes:{"data-testid":"close-button"}},r.createElement(eU.A,null)))))))}let tn=(0,ex.r1)("dismissed_starting_points_templates_modal");function ta(){let e=(0,o.wA)(),t=!!(0,s.kc)().starting_points_modal,n=(0,h.GM)(),a=(0,eO.QL)(eF.E_.key)===eF.E_.value,l=(0,er.aV)(),i=(0,o.d4)(e=>e.mirror.sceneGraph),c=!eK.Qf(i)?.childrenNodes?.length,d=(0,eO.QL)(eM.pt.KEY)===eM.pt.VALUE,p=(0,eo.q5)(),m=(0,eL.TA)(),u=p?.creatorId===m,E=(0,y.md)(ea.Fy),g=(0,y.md)(eR.UQ),_=!(0,eD.f)("not_gen_0"),f=(0,ew.GS)(),b=(0,y.md)(tn),S=(0,s.Ay)().starting_points,{show:T,isShowing:N,complete:P}=(0,v.e)({overlay:A.EYw,priority:I.N.OVERRIDING_MODAL+1,experiment:{check:n,predicate:e=>e,postCheck:(e,t)=>!t}},[E,b]);return(r.useEffect(()=>{t&&u&&!d&&!l&&c&&!N&&(a?T():_&&g&&f&&S&&T({canShow:e=>!e}))},[t,u,l,c,N,a,_,g,f,d,S,T]),N)?r.createElement(tt,{onClose:()=>{b.data||e(eA.b({dismissed_starting_points_templates_modal:!0})),P()}}):null}var tr=n(342482),to=n(761755),tl=n(815817),ti=n(475231),ts=n(855826),tc=n(284084),td=n(933717),tp=n(373094),tm=n(367984),tu=n(466585);let tE=(0,tu.Op)({initial:"ready_to_show",states:[{id:"ready_to_show",transitions:[(0,tu.nr)("curator_content_shown","ui3_onboarding_was_shown_in_current_session",{condition:({event:e})=>e.properties.shown===A.S$7.id})]},{id:"ui3_onboarding_was_shown_in_current_session",terminal:!0}]}),tg=(0,tu.rn)("track_ui3_onboarding_shown",tE);var ty=n(814003);function t_(){let{isShowing:e,complete:t,show:n,uniqueId:a}=(0,v.e)({overlay:A.l_p,priority:I.N.SECONDARY_MODAL}),l=(0,o.wA)(),s=(0,er.aV)(),c=(0,eo.q5)(),p=(0,eL.iZ)(),m=(0,tr.te)(),u=!!(0,eD.f)(tp.bo),E="ui3_onboarding_was_shown_in_current_session"===(0,tl.zl)(tg).currentState,g="no_figma_basics_onboarding_was_shown_in_current_session"===(0,tl.zl)(tm.j).currentState,_=(0,y.md)(td.Cl),h=(0,ti.jO)(),b=c?.canEdit,S=(0,o.d4)(e=>e.leftPanel.activeTab===i.xae.LAYERS);if((0,f.E)(a,["Reset Visual Assets Tooltips",tp.io],()=>{p&&c&&l(eA.b(ty.g))}),(0,r.useEffect)(()=>{!m()||!b||_||u||E||g||!h||s||!S||e||n()},[n,m,b,u,h,s,E,g,e,_,S]),(0,r.useEffect)(()=>{!S&&e&&t()},[S,e,t]),!e)return null;let T=r.createElement("strong",{style:{display:"contents"}},(0,d.tx)("design_systems.assets_panel.assets"));return r.createElement(ts.X,{isShowing:e,title:(0,d.tx)("rcs.visual_assets.elevate_your_designs"),description:(0,d.tx)("rcs.visual_assets.grab_visual_assets",{strongAssets:T}),primaryCta:{label:(0,d.tx)("rcs.presets_baseline.try_it"),type:"button",onClick:()=>{l(to.FP({tab:i.xae.ASSETS})),t()},ctaTrackingDescriptor:ee.c.PRESETS_TRY_IT},trackingContextName:"Visual Assets Intro Tooltip",userFlagOnShow:tp.bo,position:tc.Q.UI3_EDITOR_TOP_LEFT,onClose:t})}var th=n(173038),tf=n(824280),tv=n(216524),tb=n(232061);let tS=(0,ex.r1)(tb.WX),tT=(0,ex.r1)(tb.b6),tN=!1;function tI(){let e=(0,o.wA)(),t=(0,y.md)(en.wg),n=(0,er.aV)(),a=(0,y.md)(ea.mp),l=(0,$._I)(),i=(0,ew.GS)(),c=(0,y.md)(tT),p=(0,y.md)(tS),{uniqueId:m,show:u,complete:g,isShowing:_}=(0,v.e)({overlay:A.kc4,priority:I.N.SECONDARY_MODAL},[p,c,a]),h=(0,ed.U)("modal"),b=r.useCallback(()=>{!n&&!tN&&t&&l&&(0!==(E.UN().getCurrentPage()?.childCount||0)&&u({canShow:(e,t,n)=>!e&&!t&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),tN=!0)},[u,l,t,n]);function S(){e(eA.b({[tb.WX]:!0})),g()}r.useEffect(()=>{i||b()},[b,i]),(0,f.E)(m,(0,tv.wX)("design"),()=>{b()}),r.useEffect(()=>{"loaded"===p.status&&p.data&&g()},[p,g]),(0,f.E)(m,"Enter Inspect Mode",()=>{_&&S()});let T=(0,ew.GS)()?eF.ON:eF.JN;return r.createElement(tf.rq,{isShowing:_,trackingContextName:tb.WX,onClose:S,targetKey:T,title:(0,d.tx)("dev_handoff.annotations_introduction_overlay.title"),media:r.createElement(th.y,{src:(0,s.ck)("5b9addc96424c11577a1ec91e1bbadcd786fe343"),alt:(0,d.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,d.tx)("dev_handoff.annotations_introduction_overlay.description"),primaryCta:{label:(0,d.tx)("dev_handoff.annotations_introduction_overlay.primary_cta"),type:"button",onClick:function(){h("handoff")},ctaTrackingDescriptor:ee.c.SHOW_ME}})}var tP=n(556379);let tC=(0,ex.r1)(tb.b6),tk=(0,ex.r1)(tb.WX),tA=!1,tw=!1;function tO(){let e=(0,o.wA)(),t=(0,er.aV)(),n=(0,y.md)(ea.mp),a=(0,y.md)(tP.N),l=(0,eS.J2)(i.Ez5.annotationObserver().annotationInfoByTlf),c=y.md(eo.yV)?.creatorId,p=(0,y.md)(tC),m=(0,y.md)(tk),{uniqueId:u,show:E,complete:g,isShowing:_}=(0,v.e)({overlay:A.kc4,priority:I.N.SECONDARY_MODAL},[p,m,n,a]),h=(0,ed.U)("modal"),b=l.size>0;function S(){e(eA.b({[tb.b6]:!0})),g()}r.useEffect(()=>{t&&(tw=!0),!t&&!tA&&tw&&b&&(E({canShow:(e,t,n,a)=>!e&&!t&&c!==a&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),tA=!0)},[b,t,c,E]),r.useEffect(()=>{"loaded"===p.status&&p.data&&g()},[p,g]),(0,f.E)(u,"Enter Inspect Mode",()=>{_&&S()});let T=(0,ew.GS)()?eF.ON:eF.JN;return r.createElement(tf.rq,{isShowing:_,trackingContextName:tb.b6,onClose:S,targetKey:T,title:(0,d.tx)("dev_handoff.annotations_upsell_overlay.title"),media:r.createElement(th.y,{src:(0,s.ck)("e84a2faeb510847abd7bfb9c15a74ef974bb4c13"),alt:(0,d.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,d.tx)("dev_handoff.annotations_upsell_overlay.description"),primaryCta:{label:(0,d.tx)("dev_handoff.annotations_upsell_overlay.primary_cta"),type:"button",onClick:function(){h("handoff")},ctaTrackingDescriptor:ee.c.OPEN_DEV_MODE},secondaryCta:{label:(0,d.tx)("dev_handoff.annotations_upsell_overlay.secondary_cta"),type:"button",onClick:g,ctaTrackingDescriptor:ee.c.NOT_NOW}})}var tx=n(434236),tR=n(859905),tL=n(462132),tD=n(730215),tM=n(731173),tK=(e=>(e.START="start",e.SKIP_LOW_VOLUME_NODE="skip_low_volume_node",e.SKIP_NO_SUBSCRIBED_LIBRARIES="skip_no_subscribed_libraries",e.INITIATING_FRAGMENT_SEARCH="initiating_fragment_search",e.NO_RESULTS="no_results",e.RESULTS_SHOWN="results_shown",e.RESULT_INSERTED="result_inserted",e.RESULT_DISMISSED="result_dismissed",e.ABORTED="aborted",e.PANEL_OPENED="panel_opened",e.PANEL_CLOSED="panel_closed",e))(tK||{}),tF=(e=>(e.SOURCE_FRAGMENT="source_fragment",e.TL_NODE_RESULTS="tl_node_results",e.SELECTION_RESULTS="selection_results",e))(tF||{}),tV=(e=>(e.TOTAL="total",e.FRAGMENT_SEARCH="fragment_search",e.EXTRACT_CONTEXT="extract_context",e.SUMMARIZE_CONTEXT="summarize_context",e.FILTERING_RANKING="filtering_ranking",e.ASSET_LOOKUP="asset_lookup",e))(tV||{});let tU={fileKey:"",sessionId:"",selectionId:""};function tB(e,t){ez.az.trackDefinedEvent("auto_suggest.funnel",{...e,funnelEvent:t})}var tG=n(395096),tz=n(983991),tW=n(355952),tH=n(750199),tY=n(447657),t$=n(672797),tX=n(974880),tj=n(3794),tQ=n.n(tj),tJ=n(237798),tq=n(515017),tZ=n(620879);async function t0(e){let{node:t,file_key:n}=e,a={session_id:null,search_id:(0,tW.g)(),node_id:e.node.guid};try{let e=(0,tZ.T1)(t);if(!e)throw Error("Failed to export thumbnail");return{fragments:(await tq.Ay.post("/api/auto_suggest/asset_suggestions",{input:{type:"image",value:e},file_key:n,tracking_metadata:a})).data.meta.results.map(e=>({...e,type:"fig-file-fragment"}))}}catch(e){return}}var t1=n(945532);let t4=Error("Session is not available");class t2 extends E.qo{constructor(e){super(i.juq.AUTO_SUGGEST),this.sceneGUID=e}get scene(){let e=i.glU?.getAutoSuggestSceneByGUID(this.sceneGUID);if(!e)throw Error("Scene does not exist");return e}}class t8{constructor(){this.validateFullScreenAvailable();let e=i.glU?.startNewAutoSuggestSession();if(!e)throw Error("Failed to reset auto suggest scene");this.sessionID=e,this.sceneMap=new Map}destroy(){this.validation(),i.glU?.endAutoSuggestSession(this.sessionID)}async loadBuffertoScene(e,t){let n=new TaskController({priority:"background"}),a=new Promise((e,a)=>{scheduler.postTask(()=>{let n=i.glU?.loadBufferToAutoSuggestScene(this.sessionID,t);n||a(Error("Failed to load buffer to auto suggest scene")),e(n)},{signal:n.signal})}),r=new t2(await a);if(!r)throw Error("Failed to locate buffer scene");return this.sceneMap.set(e,r),r}getSceneByKey(e){return this.sceneMap.get(e)}async getFragmentScene(e){this.validation();let t=this.getSceneByKey(e);if(t)return t;let n=new Uint8Array(await (0,t1.g)(e,e.file_key));if(!n||0===n.length)throw Error("Failed to get copy buffer for fragment");return this.loadBuffertoScene(e,n)}unloadScene(e){let t=this.sceneMap.get(e);if(!t)throw Error("Scene does not exist");i.glU?.unloadAutoSuggestSceneByGUID(this.sessionID,t.sceneGUID),this.sceneMap.delete(e)}unloadFragment(e){this.validation(),this.unloadScene(e)}validation(){this.validateFullScreenAvailable(),this.validateSceneAvailable()}validateFullScreenAvailable(){if(!i.glU)throw Error("Fullscreen is not initialized")}validateSceneAvailable(){let e=i.glU?.getAutoSuggestSessionID();if(!e||e!==this.sessionID)throw t4}}var t5=n(144924);let t3=[t5.PW.COMPONENT,t5.PW.STATE_GROUP],t7={searchByNodeType:"all",selectedNodeConfig:{skipLowVolumeNodes:3,numFragments:15,rankingConfig:{count:1,fragmentCount:0,avgCountPerFragment:0,avgScorePerFragment:0,avgProximityScore:0},filteringConfig:{libraryKeyFilterType:"file",fragmentsBelowScore:.85,proximityScoreThreshold:0},minRequiredResults:2},topLevelNodeConfig:{skipLowVolumeNodes:3,numFragments:15,rankingConfig:{count:1,fragmentCount:0,avgCountPerFragment:0,avgScorePerFragment:0,avgProximityScore:1},filteringConfig:{libraryKeyFilterType:"file",fragmentsBelowScore:.85,proximityScoreThreshold:0},minRequiredResults:1},componentExtractionConfig:{nestedComponents:"all",detachedComponentChildren:!1},numResults:5,numConcurrentFragmentLoads:3},t6=["GROUP","FRAME","SECTION","RECTANGLE","ROUNDED_RECTANGLE"];var t9=n(83783),ne=n(774886),nt=n.n(ne),nn=n(684595),na=n(166628);function nr(e,t){let n=e.absoluteBoundingBox,a=t.absoluteBoundingBox;return{size:{width:n.w,height:n.h},fragmentSize:{width:a.w,height:a.h},relativePosition:{x:n.x-a.x,y:n.y-a.y}}}function no({scene:e,root:t,componentExtractionConfig:n,fragment:a,selectedNodePositionInfo:r,filteringConfig:o,subscribedLibraryKeys:l}){let i=[],s="all"===n.nestedComponents?"skip":void 0,c=!!r;return(o?.libraryKeyFilterType!=="file"||l)&&(0,t9.hV)(t,t=>{if(!t||t.isInternalOnlyNode||t.opacity<=0||!t.visible)return"skip";if("INSTANCE"===t.type){var d;let p,m={fragment:a};if(t.isPrimaryInstance?p=t.symbolId:n.nestedComponents?"notInstanceSwapped"===n.nestedComponents&&t.isSwappedNestedInstance&&(p=t.symbolId):p=t.symbolId,!p)return s;if(c){let n=nr(t,e.get(t.findContainingTopLevelFrameOrSelf())),a=r?function(e,t){let n={x:e.relativePosition.x+e.size.width/2,y:e.relativePosition.y+e.size.height/2},a={x:n.x/e.fragmentSize.width,y:n.y/e.fragmentSize.height},r={x:t.relativePosition.x+t.size.width/2,y:t.relativePosition.y+t.size.height/2},o={x:r.x/t.fragmentSize.width,y:r.y/t.fragmentSize.height},l={x:1-Math.abs(a.x-o.x),y:1-Math.abs(a.y-o.y)};return Math.sqrt(Math.pow(l.x,2)+Math.pow(l.y,2))}(n,r):0;if((o?.proximityScoreThreshold||0)>a)return s;m.positionInfo={...n,proximityScore:a}}let u=e.get(p);if(!u)return s;if(u.isState){let t=e.get(u.containingStateGroupId);if(!t)return s;m={...m,type:t5.PW.STATE_GROUP,key:t.stateGroupKey,stateComponentKey:u.componentKey,libraryKey:t.sourceLibraryKey,name:t.name,description:t.description}}else m={...m,type:t5.PW.COMPONENT,key:u.componentKey,libraryKey:u.sourceLibraryKey,name:u.name,description:u.description};return m.key&&m.libraryKey&&m.libraryKey.length&&u.publishID&&u.isSubscribedAsset&&(o?.libraryKeyFilterType!=="file"||m.libraryKey&&l?.has(m.libraryKey))&&(!m.name||(d=m.name).startsWith(".")||d.startsWith("_")||d.includes("/.")||d.includes("/_")||i.push(m)),s}if(t.detachedInfo&&n.detachedComponentChildren)return"skip"}),i}function nl(e){let t={};return e.forEach(e=>{let{key:n,type:a,name:r,description:o,libraryKey:l,fragment:i,positionInfo:s}=e;t[n]||(t[n]={type:a,key:n,libraryKey:l,name:r,description:o,count:0,fragmentCount:0,countPerFragment:{},scorePerFragment:{},stateCounts:{},proximityScores:[],avgCountPerFragment:0,avgScorePerFragment:0,avgProximityScore:0});let c=t[n];c.count++,s&&c.proximityScores.push(s.proximityScore);let d=i?`${i.file_key}.${i.node_id}`:null;if(i&&d&&(!c.countPerFragment[d]&&(c.countPerFragment[d]=0,c.scorePerFragment[d]=i.score,c.fragmentCount++),c.countPerFragment[d]++),a===t5.PW.STATE_GROUP){let{stateComponentKey:t}=e;c.stateCounts[t]||(c.stateCounts[t]=0),c.stateCounts[t]++}}),Object.values(t).forEach(e=>{let t=Object.values(e.countPerFragment);e.avgCountPerFragment=t.length>0?nt()(t):0;let n=Object.values(e.scorePerFragment);e.avgScorePerFragment=n.length>0?nt()(n):0,e.avgProximityScore=e.proximityScores.length>0?nt()(e.proximityScores):0}),t}async function ni(e,t){switch(e){case t5.PW.COMPONENT:{let e=(await (0,nn.Ek)(ei.aAC,{key:t})).component,n=e?.file,a=e?.userFacingVersion;if(!e||!n||!a)return null;return(0,na.Qp)(e,{type:"team",file:n})}case t5.PW.STATE_GROUP:{let e=(await (0,nn.Ek)(ei.jY8,{key:t})).stateGroup,n=e?.file,a=e?.minNodeWidth,r=e?.minNodeHeight,o=e?.defaultStateKey;if(!e||!n||!a||!r||!o)return null;return(0,na.SS)(e,{type:"team",file:n})}default:return null}}async function ns({selectedNode:e,openFileKey:t,analyticsData:n,subscribedLibraryKeys:a}){(0,s.Ay)().anticipation_config||((0,s.Ay)().anticipation_config=t7);let r=(0,s.Ay)().anticipation_config;if(!i.glU)return Promise.resolve([]);let o=(0,E.UN)(),l=e.findContainingTopLevelFrameOrSelf(),c=o.get(l),d=c?.guid===e.guid,p=[],m=[Date.now()],u={},g=(e,t,a)=>{let r=Date.now();m.length>0&&function(e,t,n,a){let r=`${t}.${n}`;ez.az.trackDefinedEvent("auto_suggest.timer",{...e,stepName:r,duration:a})}(n,e,t,r-m[(0,tX.Et)(a)?a:m.length-1]),m.push(r)},y=(e,t)=>{u[e]=t};tB(n,tK.START);let _=nl(no({scene:o,root:c,componentExtractionConfig:{nestedComponents:null,detachedComponentChildren:!1}})),h=nr(e,c);g(tF.SOURCE_FRAGMENT,tV.EXTRACT_CONTEXT),y("contextComponentUsage",_);try{["selected","all"].includes(r.searchByNodeType)&&p.push(...await nc({node:e,openFileKey:t,config:r,configForNodeType:r.selectedNodeConfig,contextComponentUsage:_,selectedNodePositionInfo:h,analyticsData:n,subscribedLibraryKeys:a,updateTimersAndLog:e=>{g(tF.SELECTION_RESULTS,e)},addDebugInfo:(e,t)=>{y(`${tF.SELECTION_RESULTS}.${e}`,t)}})),("topLevel"===r.searchByNodeType||"all"===r.searchByNodeType&&!d)&&c&&p.length<r.numResults&&p.push(...await nc({node:c,openFileKey:t,config:r,configForNodeType:r.topLevelNodeConfig,contextComponentUsage:_,selectedNodePositionInfo:h,analyticsData:n,subscribedLibraryKeys:a,updateTimersAndLog:e=>{g(tF.TL_NODE_RESULTS,e)},addDebugInfo:(e,t)=>{y(`${tF.TL_NODE_RESULTS}.${e}`,t)}}))}catch(e){e!==t4&&(0,tJ.x1)("auto_suggest","Error getting suggestions",{error:e})}return g(tF.SOURCE_FRAGMENT,tV.TOTAL,0),(0,tJ.Lo)("auto_suggest","Auto Suggest Results",{suggestions:p||"no_results",debugInfo:u}),p}async function nc({node:e,openFileKey:t,config:n,configForNodeType:a,contextComponentUsage:r,selectedNodePositionInfo:o,analyticsData:l,subscribedLibraryKeys:i,updateTimersAndLog:s,addDebugInfo:c}){let d;if(d=0,(0,t9.hV)(e,e=>!e||e.isInternalOnlyNode||e.opacity<=0||!e.visible?"skip":(d+=1,"INSTANCE"===e.type)?"skip":void 0),d<a.skipLowVolumeNodes)return tB(l,tK.SKIP_LOW_VOLUME_NODE),Promise.resolve([]);if("file"===a.filteringConfig.libraryKeyFilterType&&0===i.size)return tB(l,tK.SKIP_NO_SUBSCRIBED_LIBRARIES),Promise.resolve([]);let p=a.filteringConfig,m=e.findContainingTopLevelFrameOrSelf();tB(l,tK.INITIATING_FRAGMENT_SEARCH);let u=await t0({type:"input-selection",node:e,file_key:t,name:e.name});if(s(tV.FRAGMENT_SEARCH),!u||0===u.fragments.length)return tB(l,tK.NO_RESULTS),Promise.resolve([]);let E=Array.from(new Map(u.fragments.map(e=>[`${e.file_key}_${e.node_id}`,e])).values()).filter(n=>!(n.score<p.fragmentsBelowScore)&&(n.file_key!==t||n.node_id!==e.guid&&(!m||n.node_id!==m))).slice(0,10);if(0===E.length)return tB(l,tK.NO_RESULTS),Promise.resolve([]);c("fragments",E);let g=new t8,y=tQ()(await (0,t$.Ed)(E.map(e=>async()=>{try{let t=await g.getFragmentScene(e),a=no({scene:t,root:t.getRoot(),componentExtractionConfig:n.componentExtractionConfig,fragment:e,selectedNodePositionInfo:o,filteringConfig:p,subscribedLibraryKeys:i});return g.unloadFragment(e),a}catch(t){if(t===t4)throw t4;return(0,tJ.x1)("auto_suggest","Error loading fragment",{error:t,fragment:e}),null}}),n.numConcurrentFragmentLoads)).map(e=>"resolve"===e.type?e.resolve:null).filter(e=>null!=e).flat();g.destroy(),s(tV.EXTRACT_CONTEXT),c("fragmentComponentInfo",y);let _=nl(y);s(tV.SUMMARIZE_CONTEXT),c("componentUsage",_),function({componentUsage:e,contextComponentUsage:t}){Object.values(e).forEach(({key:n,countPerFragment:a})=>{let r=t[n];if(!r)return;let o=function(e){if(0===e.length)return 0;if(1===e.length)return e[0];let t=[...e].sort((e,t)=>e-t),n=Math.floor(t.length/2);return t.length%2!=0?t[n]:(t[n-1]+t[n])/2}(Object.values(a));r.count<o||delete e[n]})}({componentUsage:_,contextComponentUsage:r});let h=function({componentUsage:e,rankingConfig:t}){let n=Object.values(e),a={count:Math.max(...n.map(e=>e.count)),fragmentCount:Math.max(...n.map(e=>e.fragmentCount)),avgCountPerFragment:Math.max(...n.map(e=>e.avgCountPerFragment)),avgScorePerFragment:Math.max(...n.map(e=>e.avgScorePerFragment)),avgProximityScore:Math.max(...n.map(e=>e.avgProximityScore))},r={count:Math.min(...n.map(e=>e.count)),fragmentCount:Math.min(...n.map(e=>e.fragmentCount)),avgCountPerFragment:Math.min(...n.map(e=>e.avgCountPerFragment)),avgScorePerFragment:Math.min(...n.map(e=>e.avgScorePerFragment)),avgProximityScore:Math.min(...n.map(e=>e.avgProximityScore))};return n.map(e=>{let n=(e,t,n)=>n===t?0:(e-t)/(n-t),o=n(e.count,r.count,a.count)*t.count,l=n(e.fragmentCount,r.fragmentCount,a.fragmentCount)*t.fragmentCount,i=n(e.avgCountPerFragment,r.avgCountPerFragment,a.avgCountPerFragment)*t.avgCountPerFragment,s=n(e.avgScorePerFragment,r.avgScorePerFragment,a.avgScorePerFragment)*t.avgScorePerFragment,c=n(e.avgProximityScore,r.avgProximityScore,a.avgProximityScore)*t.avgProximityScore;return{...e,key:e.key,score:o+l+i+s+c}}).sort((e,t)=>t.score-e.score)}({componentUsage:_,rankingConfig:a.rankingConfig});s(tV.FILTERING_RANKING);let f=[],v=0;for(;v<h.length&&f.length<n.numResults;){let e=h[v];if(!e){v++;continue}let{key:t}=e,n=_[t];if(!n){v++;continue}let a=await ni(n.type,t);a&&f.push(a),v++}return s(tV.ASSET_LOOKUP),c("results",f),0===f.length&&tB(l,tK.NO_RESULTS),f}var nd=n(145219),np=n(658567),nm=(e=>(e.BLACK_BLANK="40002168:784",e.BLACK_WHERE_TO="40000039:913",e.BROWN_REVISE_PROMPT="40000039:918",e.BROWN_TAB_TOGGLER="40000039:921",e))(nm||{}),nu=(e=>(e.MOBILE_DAY_PICKER="474:4773",e.MOBILE_PILL_TIME="474:4831",e.MOBILE_FLIGHT_CARD="469:2787",e.MOBILE_NOTIFICATION="475:6605",e.MOBILE_NOTIFICATION_BOOKS="2440:5914",e.MOBILE_TAB_TOGGLER="380:4294",e.MOBILE_ROME="213:2453",e.MOBILE_HILO="527:7273",e.MOBILE_DAY_VIEW="474:5088",e.MOBILE_SEARCH_INPUT_BLACK="449:9470",e.MOBILE_SEARCH_INPUT_GREEN="281:604",e.MOBILE_MEMORY_TILE_PURPLE="475:6981",e.MOBILE_LABEL_BLACK="475:6504",e.MOBILE_LABEL_GRAY="475:6503",e.MOBILE_BOTTOM_NAV_WHITE="452:10133",e))(nu||{});let nE=["449:9470","474:4773","474:4831","469:2787","475:6605","2440:5914"],ng={"40002168:784":["449:9470","380:4294","527:7273","469:2787"],"40000039:913":["380:4294","527:7273","469:2787","474:5088","475:6504"],"40000039:918":["281:604","213:2453","475:6981","475:6503"],"40000039:921":["452:10133","213:2453","469:2787"]};async function ny(e){let t=nd.D.getState(),n=(0,np.MH)(t);if(!n)return[];let a=ng[e]||nE,r=[];return(a.forEach(e=>{let t=n[e];t&&t3.includes(t.type)&&r.push(t)}),r.length>0)?(await new Promise(e=>setTimeout(e,1e3)),r):[]}async function n_(e){return(0,s.kc)().anticipation_uxr?await ny(e.selectedNode.guid):await ns(e)}var nh=n(694208),nf=n(534599),nv=n(623919),nb=n(591032),nS=n(740788),nT=n(510237),nN=n(902225),nI=n(128731),nP=n(540706);function nC({asset:e,defaultDropPosition:t,onDismiss:n,onInsert:a}){let[o,l]=r.useState(!1);return o?null:r.createElement("div",{className:"asset_shelf_suggestion--container--18Rt5"},r.createElement("div",{className:"asset_shelf_suggestion--suggestionContainer--rY1cW"},r.createElement(nk,{asset:e,defaultDropPosition:t,onInsert:a},r.createElement("div",{className:"asset_shelf_suggestion--suggestion--WCutP"},r.createElement(nP.M,{className:"asset_shelf_suggestion--image--R4c1I",item:e,shouldGenerateLocalThumbnail:!0,draggable:!1})))),r.createElement(nb.E,{className:"asset_shelf_suggestion--closeIcon--1S4i2",onClick:()=>{l(!0),n()}},r.createElement(nS.p,null)))}function nk(e){let{asset:t,defaultDropPosition:n,onInsert:a}=e,{onInsertableResourcePointerDown:o,dragState:l,insertAction:i}=(0,nI.j)({resource:t,isList:!0,sourceForTracking:"SuggestionsShelf",clickToInsert_DEPRECATED:!1,draggingThumbMaxDimensions:void 0,insertionCallback:a}),s=new tL.Mi(.5,.5);return r.createElement(r.Fragment,null,r.createElement(nT.GG,{onPointerDown:e=>{o(e)},onClick:e=>{i({e:new PointerEvent(e.type,{...e,view:window}),isClick:!0,pointerPercentageOffset:s,dropPosition:n})}},e.children),r.createElement(nN.q,{dragState:l,isList:!0}))}let nA="suggestions_shelf--emptyStateText--T0I8P";function nw({setIsOpen:e}){let{suggestions:t,isLoading:n,selectedNode:a,analyticsData:o}=function(){let[e,t]=r.useState(!1),n=(0,tY.VW)();r.useEffect(()=>{let e=()=>t(!0),n=()=>t(!1);return window.addEventListener("mousedown",e),window.addEventListener("mouseup",n),()=>{window.removeEventListener("mousedown",e),window.removeEventListener("mouseup",n)}},[]);let a=(0,E.UN)(),o=function({selectedNode:e,disabled:t=!1,debounce:n=!0}){let a=t||!(0,s.kc)().anticipation&&!(0,s.kc)().anticipation_uxr,[o,l]=r.useState([]),[i]=(0,tG.A)(e,500,{equalityFn:(e,t)=>e?.guid===t?.guid}),c=n&&!(0,tz.PN)()?i:e,[d,p]=r.useState(tU),[m,u]=r.useState(!1),[E,g]=r.useState(void 0),y=(0,eo.tS)(),_=(0,tH.He)();return r.useEffect(()=>{if(a)return;let e=new AbortController;if(c&&y){if(c&&t6.includes(c.type)){u(!0),l([]),g(c.guid);let t={fileKey:y,sessionId:(0,tW.g)(),selectionId:c?.guid};p(t);let{signal:n}=e;n_({selectedNode:c,openFileKey:y,signal:n,analyticsData:t,subscribedLibraryKeys:_}).then(e=>{n.aborted||l(e)}).catch(e=>{if("AbortError"===e.name)return}).finally(()=>{n.aborted||u(!1)})}else c&&(u(!1),l([]),g(c.guid))}else l([]),u(!1),g(void 0),p(tU);return()=>{e&&e.abort()}},[c,a,y,_]),{suggestions:o,isLoading:m,analyticsData:d,suggestionsNodeGuid:E}}({selectedNode:n,disabled:e}),l=o.suggestionsNodeGuid?a.get(o.suggestionsNodeGuid):void 0;return{...o,selectedNode:l}}(),l=r.useMemo(()=>{let e=a?a.absoluteBoundingBox.x+a.absoluteBoundingBox.w/2:0,t=a?a.absoluteBoundingBox.y+a.absoluteBoundingBox.h/2:0;return new tL.Mi(e,t)},[a]),i=r.createElement(tR.k,{className:"suggestions_shelf--upChevron--oUF5v suggestions_shelf--downChevron--ZbvaY"}),c=r.useMemo(()=>t.slice(0,5).map((e,t)=>r.createElement(nC,{key:`suggestion:${t}`,asset:e,fileName:"mock",thumbLayout:nh.rp.SMALL,thumbHeight:35,thumbWidth:40,sectionPosition:t,displayType:"list",sourceForTracking:"suggestionsShelf",viewMode:nf.Bk.Grid,defaultDropPosition:l,onDismiss:()=>{tB(o,tK.RESULT_DISMISSED)},onInsert:()=>{tB(o,tK.RESULT_INSERTED)}})),[t,l,o]);return r.createElement("div",{className:"suggestions_shelf--shelf--401Ia"},n&&r.createElement(tx.k,null),!n&&!a&&r.createElement("div",{className:nA},(0,d.t)("asset_suggestions.suggestion_shelf_empty_state")),!n&&a&&(t.length>0?r.createElement("div",{className:"suggestions_shelf--suggestions--aZ-e9"},c):r.createElement("div",{className:nA},(0,d.t)("asset_suggestions.suggestion_shelf_no_suggestions"))),r.createElement("button",{className:"suggestions_shelf--upChevronContainer---RjEh",onClick:()=>{tB(o,tK.PANEL_CLOSED),e(!1)}},i))}function nO(){let e=(0,eS.ut)(i.Ez5?.editorPreferences().showAssetAutoSuggest,!0),t=r.useCallback(e=>{i.Ez5?.editorPreferences().showAssetAutoSuggest.set(e)},[]),[n,a]=(0,nv.d)(),o=r.createElement(tR.k,{className:"suggestions_shelf--downChevron--ZbvaY"}),l=r.createElement("button",{className:"suggestions_shelf--downChevronContainer--9AOKn",onClick:()=>{tB(tU,tK.PANEL_OPENED),t(!e)}},o);return r.createElement(tD.dP,null,r.createElement("div",{className:eG()("suggestions_shelf--wrapper--seged",tM.Dm)},r.createElement("div",{className:e?"suggestions_shelf--shelfContainerOpen--qh1UB suggestions_shelf--shelfContainer--EXG5K":"suggestions_shelf--shelfContainerClosed--jUxyH suggestions_shelf--shelfContainer--EXG5K",style:{marginLeft:n,marginRight:a}},!e&&l,e&&r.createElement(nw,{setIsOpen:t}))))}function nx(){return(0,s.kc)().anticipation_uxr||(0,s.kc)().anticipation?r.createElement(nO,null):null}var nR=n(843117),nL=n(821910),nD=n(383277),nM=n(134309),nK=n(689570),nF=n(432408),nV=n(187134),nU=n(263159);let nB=(0,r.memo)(function(e){return(0,nU.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,nU.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M10.003 7.375A5.5 5.5 0 0 1 16.61 9.5H14a.5.5 0 0 0 0 1h3.5a.5.5 0 0 0 .5-.5V6.5a.5.5 0 0 0-1 0v1.847a6.5 6.5 0 1 0-.128 8.456.5.5 0 1 0-.75-.662 5.5 5.5 0 1 1-6.119-8.766",clipRule:"evenodd"})})});var nG=n(755020),nz=n(631437),nW=n(754612),nH=n(171946),nY=n(212521),n$=n(539321),nX=n(424940),nj=n(527747),nQ=n(529e3),nJ=n(47438),nq=n(649174);function nZ(e,t,n){nd.D.dispatch(p.F.enqueue({message:e,type:n,icon:t,timeoutOverride:3e3}))}var n0=n(591680);function n1(){let e=(0,y.md)(nq.m7);return(0,r.useMemo)(()=>(function(e){let t=(0,nW.r8)();if(!t)return{};let n={};for(let r of e.values())for(let e of r.values()){var a;let r=t.getRuleById(e.ruleId);if(!r)continue;let o=(a=e.detectionContext)?(r.id===nX.C.REQUIRE_FILL_COLOR_TOKENS||r.id===nX.C.REQUIRE_STROKE_COLOR_TOKENS)&&"color"in a?`${r.id}-${(0,n$.colorToHex)(a.color)}-${a.opacity}`:JSON.stringify(a,Object.keys(a).sort()):r.id,l=n[o];l?l.push(e):n[o]=[e]}return n})(e),[e])}function n4(){let e=(0,y.md)(nq.m7);return(0,r.useMemo)(()=>Array.from(e.values()).reduce((e,t)=>e+t.size,0),[e])}function n2(){let e=(0,g.Xr)(nq.Bc);return{selectGroup:(0,r.useCallback)(t=>{e({view:n0.N.VIOLATIONS,selectedViolationGroup:t})},[e]),returnToGroupList:(0,r.useCallback)(()=>{e({view:n0.N.GROUPS,selectedViolationGroup:null})},[e])}}function n8(){let e=n1(),{selectedViolationGroup:t}=(0,y.md)(nq.Bc);return t?e[t]??[]:[]}let n5="design_linter_view--chit--bjexe paint_panels--chit--twQEy",n3="design_linter_view--rotateNegative90--oRXtL";var n7=n(370903),n6=n(995382);function n9({shouldDisplay:e}){return e?r.createElement("div",{className:W.cx.p12.flex.justifyCenter.$},(0,d.tx)("design_linter.penalty_box.no_violations")):null}function ae(){let[e,t]=r.useState(!1),n=(0,r.useCallback)(async()=>{if(e)return;t(!0);let n=(0,nW.r8)();try{await n?.requestDetection()}finally{t(!1)}},[e]);return r.createElement(nV.o,{eventListeners:["onClick"]},r.createElement(eV.K,{onClick:n,"aria-label":(0,d.t)("design_linter.penalty_box.refresh_button_aria"),recordingKey:"designLinter.refresh"},e?r.createElement(tx.k,null):r.createElement(nB,null)))}function at(){let e=n4();return r.createElement("div",{className:W.cx.p8.pl16.cursorDefault.selectNone.pr0.wFull.pl8.$},r.createElement("div",{className:W.cx.flex.flexRow.justifyBetween.itemsCenter.$},r.createElement("div",{className:W.cx.flex.textBodyMediumStrong.$},r.createElement("span",{className:W.cx.mr2.$},(0,d.tx)("design_linter.penalty_box.title")),r.createElement("span",null,e?`(${e})`:"")),r.createElement("div",{className:W.cx.flex.gap4.$},r.createElement(ae,null))))}function an(){let e=(0,y.md)(nq.fY),t=(0,E.UN)(),n=e[0]??"",a=1===e.length?t.get(n)?.name??"":(0,d.tx)("design_linter.penalty_box.multiple_targets");return r.createElement("div",{className:W.cx.flex.mt8.gap4.itemsCenter.bb1.colorBorder.bSolid.p8.pl16.pt4.$},r.createElement(nY.Bf,{guid:n}),r.createElement("div",{className:W.cx.textBodyMedium.colorTextSecondary.truncate.$,"data-tooltip":a,"data-tooltip-type":"text"},a))}function aa({onNavigateBack:e,title:t}){return r.createElement(nb.E,{className:W.cx.bb1.colorBorder.bSolid.wFull.$,onClick:e},r.createElement("div",{className:W.cx.p8.pl0.flex.itemsCenter.justifyBetween.$},r.createElement("div",{className:W.cx.flex.itemsCenter.gap6.$},r.createElement(nG.C,null),r.createElement("span",{className:W.cx.textBodyMediumStrong.$},t))))}function ar({onNext:e,onPrev:t,title:n,disabled:a,currentIndex:o}){return r.createElement("div",{className:W.cx.flex.flexRow.itemsCenter.p8.justifyEnd.gap8.$},r.createElement("div",{className:W.cx.flex.gap8.itemsCenter.$},r.createElement(ao,{currentIndex:o}),r.createElement("div",{className:"design_linter_view--tabularNumbers--Xn7aT"},n)),r.createElement("div",{className:W.cx.flex.flexRow.gap2.$},r.createElement(eV.K,{onClick:e=>{e.currentTarget.blur(),t()},disabled:a,"aria-label":(0,d.t)("general.previous"),recordingKey:"designLinter.previousViolation"},r.createElement(nH.B,{svg:n6.A,className:n3})),r.createElement(eV.K,{onClick:t=>{t.currentTarget.blur(),e()},disabled:a,"aria-label":(0,d.t)("general.next"),recordingKey:"designLinter.nextViolation"},r.createElement(nH.B,{svg:n7.A,className:n3}))))}function ao({currentIndex:e}){let t=n8(),n=(0,r.useCallback)(()=>{if(!i.Egt)return;let n=t[e]?.guid;n&&i.Egt.replaceSelection([n],!0)},[t,e]);return r.createElement(eV.K,{onClick:n,"aria-label":(0,d.t)("design_linter.penalty_box.select_current_violation_button_aria"),recordingKey:"designLinter.selectCurrentViolation"},r.createElement(nz.A,null))}var al=n(342691),ai=n(172736),as=n(744952),ac=n(899356),ad=n(984988);function ap(){let e=(0,eo.q5)(),t=n4(),n=Object.entries(function(){let e=(0,y.md)(nq.m7);return(0,r.useMemo)(()=>{let t={};for(let n of e.values())for(let e of n.values()){let n=t[e.ruleId];n?n.push(e):t[e.ruleId]=[e]}return t},[e])}()).map(([e,t])=>({rule:e,count:t.length})),[a,o]=(0,r.useState)(0),l=(0,y.md)(nW.vo),i=(0,E.UN)().getCurrentPage();if((0,eW.h)(()=>{if(!i)return;let e=0;(0,t9.hV)(i,()=>{e++}),o(e)}),!i||!e)return null;let s=e._name??"File",c=i.name;return r.createElement("div",{className:W.cx.px16.mt4.$},r.createElement("span",{className:W.cx.textHeadingMedium.block.$},"Debug view"," "),r.createElement("span",{className:W.cx.textBodyMedium.block.$},`Linter status: ${l}`," "),r.createElement("span",{className:W.cx.textBodyMedium.block.$},`${s} - ${c}`," "),r.createElement("span",{className:W.cx.textBodyMedium.block.$},`Total layers: ${a}`," "),r.createElement("span",{className:W.cx.textBodyMedium.block.$},`Total violations: ${t}`," "),r.createElement("span",{className:W.cx.textHeadingSmall.block.pt8.$},"Violations per rule"),r.createElement("ol",null,n.map(({rule:e,count:t})=>r.createElement("span",{key:e,className:W.cx.textBodyMedium.block.$},`${e}: ${t}`))))}var am=n(463033),au=n(73150),aE=n(45623),ag=n(533294),ay=n(119087);function a_({violation:e,selectAllNodes:t,multipleViolationsSelected:n,onFixSuccess:a,showSelectAllButton:o}){let{fix:l,fixCallback:i}=function({violation:e,onFixSuccess:t,multipleViolationsSelected:n}){let[a,o]=(0,r.useState)(void 0),l=function(e){let t=(0,nW.r8)();return(0,r.useCallback)(async n=>{if(t)try{await t.fixSingleViolation(n)?e?.():nZ((0,d.t)("design_linter.penalty_box.fix_failed_bell"),nj.zX.EXCLAMATION,"error")}catch(e){nZ((0,d.t)("design_linter.penalty_box.fix_failed_bell"),nj.zX.EXCLAMATION,"error")}},[t,e])}(t),i=function(e){let t=(0,nW.r8)(),n=(0,er.KH)(),a=n8();return(0,r.useCallback)(async r=>{if(!r?.fixContext||!t)return;let o=Object.keys(n),l=a.filter(e=>o.includes(e.guid));try{await t.applyFixContextToViolations(l,r.fixContext),e?.()}catch(e){nZ((0,d.t)("design_linter.penalty_box.fix_failed_bell"),nj.zX.EXCLAMATION,"error")}},[t,e,n,a])}(t),s=(0,r.useRef)("");(0,r.useEffect)(()=>{s.current!==e.guid&&(s.current=e.guid,o(void 0),(async t=>{try{let n=(0,nW.r8)();if(!n)throw Error("Design linter not available");let a=await n.getFix(e);t===s.current&&o(a)}catch(e){console.error("Error fetching fix:",e)}})(e.guid))},[e]);let c=(0,r.useCallback)(()=>{if(a){if(n){i(a);return}l(e)}},[a,n,i,l,e]);return{fix:a,fixCallback:c}}({violation:e,onFixSuccess:a,multipleViolationsSelected:n});return r.createElement("div",{className:W.cx.bb1.colorBorder.bSolid.$},r.createElement("div",{className:W.cx.py16.relative.mx16.flex.flexColumn.$},l&&r.createElement(r.Fragment,null,r.createElement("div",{className:eG()(W.cx.absolute.w14.colorBg.h4.$,"design_linter_view--fixArrowBackgroundPosition---Zemo")}),r.createElement("div",{className:eG()(W.cx.absolute.$,"design_linter_view--fixArrowDownPosition--hFL3f")},r.createElement(au.Q,{className:"design_linter_view--iconTertiary--f-k-n"}))),r.createElement(ab,{violation:e}),r.createElement(ah,{fix:l}),r.createElement("div",{className:W.cx.flex.justifyEnd.gap8.maxW300.$},o?r.createElement(am.$n,{variant:"secondary",onClick:t,recordingKey:"designLinter.selectAll"},(0,d.tx)("design_linter.penalty_box.select_all")):null,r.createElement(am.$n,{variant:"primary",disabled:!l?.valid,onClick:i,recordingKey:"designLinter.fix"},n?(0,d.tx)("design_linter.penalty_box.apply_all"):(0,d.tx)("design_linter.penalty_box.fix")))))}function ah({fix:e}){return r.createElement("div",{className:W.cx.flex.itemsCenter.h24.radiusMedium.colorBorder.b1.mt8.mb16.maxW300.$},r.createElement(af,{fix:e}))}function af({fix:e}){if(!e)return r.createElement(aN,null);if(!e.valid||!e.fixContext)return r.createElement(aT,null);let{ruleId:t,guid:n,fixContext:a}=e;return E.UN()?.get(n)&&(t===nX.C.REQUIRE_FILL_COLOR_TOKENS||t===nX.C.REQUIRE_STROKE_COLOR_TOKENS)?r.createElement(av,{context:a}):null}function av({context:e}){if(!("fixes"in e)||!("selection"in e))return null;let{fixes:t,selection:n}=e;if(!t||0===t.length)return null;let a=t[n??0];if(!a)return null;let{variableId:o,resolvedValue:l}=a,i=y.zl.get(nq.nE),s=i[o]?.name,c=l.value;return c&&s?r.createElement(r.Fragment,null,r.createElement("div",{className:n5},r.createElement(ad.J,{color:c,opacity:c.a})),r.createElement("span",{className:W.cx.textBodyMedium.colorText.truncate.$},s)):null}function ab({violation:e}){let{ruleId:t,detectionContext:n}=e;return t===nX.C.REQUIRE_FILL_COLOR_TOKENS||t===nX.C.REQUIRE_STROKE_COLOR_TOKENS?r.createElement(aS,{context:n}):null}function aS({context:e}){if(!e||!("color"in e))return null;let t=e.color,n=e.opacity;return r.createElement("div",{className:W.cx.flex.maxW300.$},r.createElement("div",{className:eG()(W.cx.flex.itemsCenter.h24.radiusMedium.colorBgSecondary.justifyBetween.w250.if(void 0===n,W.cx.w300).$,"design_linter_view--currentColorHexBorderRadius--JEZ3p")},r.createElement("div",{className:W.cx.flex.itemsCenter.$},r.createElement("div",{className:eG()(n5,W.cx.m4.$)},r.createElement(ad.J,{color:t,opacity:n})),r.createElement("div",{className:W.cx.textBodyMedium.colorText.selectNone.$},ag.TI.format(t)))),void 0!==n&&r.createElement("div",{className:eG()(W.cx.pl8.bl1.bSolid.colorBorderBg.colorText.flex.itemsCenter.h24.radiusMedium.colorBgSecondary.$,"design_linter_view--currentColorOpacity--C40Tb")},new ay.t6({min:0,max:100}).format(100*n),r.createElement("span",{className:W.cx.colorTextSecondary.pl12.pr6.selectNone.$},"%")))}function aT(){return r.createElement("div",{className:W.cx.flex.itemsCenter.$},r.createElement(aE.Z,null),r.createElement("div",null,(0,d.t)("design_linter.penalty_box.no_fix_available")))}function aN(){return r.createElement("div",{className:W.cx.flex.itemsCenter.$},r.createElement("span",{className:W.cx.flex.ml2.mr4.$},r.createElement(tx.k,{size:"sm"})),(0,d.t)("design_linter.penalty_box.loading_fix"))}function aI(){let e=(0,g.Xr)(nq.Bc);return(0,eW.h)(()=>()=>{e({view:n0.N.GROUPS,selectedViolationGroup:null}),i.Ez5?.uiState().showDesignLinter.set(!1)}),r.createElement("div",{className:"design_linter_view--displayContents--2Xg5Q","data-testid":"design-linter-container"},r.createElement("div",{className:W.cx.flex.flexColumn.wFull.hFull.overflowHidden.overflowYScroll.cursorDefault.$},r.createElement(aP,null),(0,s.kc)().aip_flower_garden_debug&&r.createElement(ap,null)))}function aP(){let e=function(){let e=(0,y.md)(nW.vo);return[nW.td.DETECTING,nW.td.DETECTION_REQUESTED].includes(e)}(),t=n8(),n=n1(),{view:a,selectedViolationGroup:o}=(0,y.md)(nq.Bc),{status:l}=(0,y.md)(nq.v4),i=["uninitialized","loading"].includes(l);return e||i?r.createElement("div",{className:W.cx.flex.mt12.justifyCenter.$},r.createElement(tx.k,null)):a!==n0.N.GROUPS&&o&&t.length?a===n0.N.VIOLATIONS?r.createElement(aw,{violations:t}):null:r.createElement(aC,{groupedViolations:n})}function aC({groupedViolations:e}){let t=(0,nW.r8)();if(!t)return null;let n=Object.entries(e).sort(([e],[t])=>e.localeCompare(t));return r.createElement("div",{"data-testid":"design-linter-groups-list"},r.createElement(an,null),n.map(([e,n])=>{if(!n.length)return null;let a=n[0],o=a?.ruleId,l=o?t.getRuleById(o):null;return l?r.createElement(ak,{key:e,groupId:e,violationList:n,rule:l}):null}),r.createElement(n9,{shouldDisplay:!n.length}))}function ak({groupId:e,violationList:t,rule:n}){let{selectGroup:a}=n2(),[o,l]=(0,r.useState)(!1),i=t[0];return i?r.createElement(nb.E,{className:W.cx.p16.pr8.flex.justifyBetween.itemsCenter.bb1.colorBorder.bSolid.wFull.if(o,W.cx.colorBgHover).$,onClick:()=>a(e),htmlAttributes:{onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1)},recordingKey:(0,as.Pt)("designLinter",e)},r.createElement("div",{className:W.cx.flex.flexColumn.$},r.createElement("div",{className:W.cx.textBodyMediumStrong.pb2.$},n.name,r.createElement("span",{className:W.cx.pl4.textBodyMedium.colorTextSecondary.$},`(${t.length})`)),r.createElement(aA,{rule:n,context:i.detectionContext})),r.createElement(al.a,{style:{"--color-icon":"var(--color-icon-tertiary)"}})):null}function aA({rule:e,context:t}){if(e.id===nX.C.REQUIRE_FILL_COLOR_TOKENS||e.id===nX.C.REQUIRE_STROKE_COLOR_TOKENS){if(!("color"in t))return null;let e=t.color,n=(0,ai.F_)(e);return r.createElement("div",{className:W.cx.flex.itemsCenter.$},e?r.createElement("div",{className:n5},r.createElement(ad.J,{color:e,opacity:t.opacity})):null,r.createElement("div",{className:W.cx.textBodyMedium.colorTextSecondary.ml4.$},n.toUpperCase().replace("#","")))}return null}function aw({violations:e}){let{returnToGroupList:t}=n2(),[n,a]=(0,r.useState)(0),[o,l]=(0,r.useState)(!1),s=(0,r.useRef)(e.length);!function(e,t){let n=(0,er.KH)();(0,r.useEffect)(()=>{let a=Object.keys(n),r=new Set(e.map(e=>e.guid));t(a.length>1&&a.every(e=>r.has(e)))},[n,t,e])}(e,l);let c=(0,r.useCallback)(()=>{e.length>1||t()},[e,t]),p=(0,r.useCallback)((e,t)=>{ac.Y5.triggerAction("goto-layer",{args:{nodeId:e}}),a(t)},[]),m=(0,r.useCallback)(()=>{let t=(n+1)%e.length;p(e[t].guid,t)},[n,e,p]),u=(0,r.useCallback)(()=>{let t=(n-1+e.length)%e.length;p(e[t].guid,t)},[n,p,e]);(0,eW.h)(()=>{e.length&&p(e[0].guid,0)}),(0,r.useEffect)(()=>{if(s.current===e.length)return;let t=(n+e.length)%e.length;p(e[t].guid,t),s.current=e.length},[e,p,n]);let E=(0,r.useCallback)(()=>{i.Egt?.replaceSelection(e.map(e=>e.guid),!0)},[e]),g=e[n];return r.createElement("div",{"data-testid":"design-linter-violations-list"},g?r.createElement(a_,{violation:g,selectAllNodes:E,onFixSuccess:c,multipleViolationsSelected:o,showSelectAllButton:e.length>1}):r.createElement(n9,{shouldDisplay:!0}),r.createElement(ar,{onNext:m,onPrev:u,title:(0,d.tx)("design_linter.penalty_box.layer_of_layers",{current:n+1,total:e.length}),disabled:e.length<=1,currentIndex:n}))}let aO="16px",ax=(0,nK.jz)(aO);function aR(){return(0,nq.qZ)()?r.createElement(aL,null):null}let aL=r.memo(()=>{let e=(0,eS.J2)(i.Ez5.uiState().showDesignLinter);return(!function(){let e=(0,g.Xr)(nq.v4),t=(0,nJ.pN)(),n=t.data?.libraryVariables,a=t.data?.libraryVariableSets;(0,r.useEffect)(()=>{if("errors"===t.status){e(e=>({...e,status:"error"}));return}if("loaded"!==t.status)return;let r=new AbortController,o=r.signal;return async function(){if(a&&n){for(let e=0;e<a.length;e+=2){if(o.aborted)return;let t=a.slice(e,e+2).map(e=>(0,nQ.RI)(e));await Promise.allSettled(t)}e({libraryVariables:n,libraryVariableSetIdToSet:a.reduce((e,t)=>(t.node_id&&(e[t.node_id]=t),e),{}),status:"loaded"})}}(),()=>{r.abort()}},[t.status,a,n,e])}(),e)?r.createElement(aD,null):null});function aD(){let e=nD.ox(),t=function(){let e=(0,eZ.GQ)(),t=(0,r.useMemo)(()=>new tL.Mi(e+(0,nK.jz)(aO),(0,nK.jz)(aO)),[e]),[{windowInnerHeight:n}]=(0,tG.A)((0,nF.l)(),300,{equalityFn:nL.c2});return{initialPosition:t,maxHeight:n-2*ax,minHeight:304,minWidth:284,initialHeight:378,initialWidth:284}}();return!function(e){let t=aK(),n=(0,r.useRef)();(0,r.useEffect)(()=>{t===n0.N.GROUPS?n.current&&e.setSize(n.current):t===n0.N.VIOLATIONS&&(n.current=new tL.Mi(e.size.x,e.size.y),e.setSize(new tL.Mi(284,212)))},[t,e])}(e),r.createElement(nM._L,{defaultWidth:t.initialWidth,defaultHeight:t.initialHeight,defaultPosition:{left:t.initialPosition.x,top:t.initialPosition.y},maxHeight:t.maxHeight,manager:e,onClose:({source:e})=>{"outside"!==e&&i.Ez5?.uiState().showDesignLinter.set(!1)}},r.createElement(V.vo,null,r.createElement(V.Y9,null,r.createElement(aM,null)),r.createElement(V.nB,{padding:0,scrolling:"none"},r.createElement(aI,null))))}function aM(){let{selectedViolationGroup:e}=(0,y.md)(nq.Bc),{returnToGroupList:t}=n2(),n=n1(),a=e?n[e]??[]:[];return aK()===n0.N.GROUPS?r.createElement(at,null):r.createElement(aa,{title:function(e){let t=(0,nW.r8)();if(!t||!e)return"";let n=t.getRuleById(e);return n?.name??""}(a[0]?.ruleId),onNavigateBack:t})}function aK(){let e=(0,y.md)(nq.Bc),t=n1(),{selectedViolationGroup:n,view:a}=e,r=n?t[n]??[]:[];return a!==n0.N.GROUPS&&n&&r.length?n0.N.VIOLATIONS:n0.N.GROUPS}var aF=n(852938),aV=n(762288),aU=n(296724),aB=n(900204),aG=n(18865),az=n(68060),aW=n(785657);function aH({children:e}){return r.createElement(aW.G.Provider,{value:{loggerEventName:"design_navigate"}},r.createElement(az.s.Provider,{value:{allowLibraryPublish:!0}},e))}var aY=n(532214),a$=n(567972),aX=n(445713),aj=n(675808),aQ=n(592656),aJ=n(334367),aq=n(736796),aZ=n(52833),a0=n(267469),a1=n(883296),a4=n(133597),a2=n(113645),a8=n(997156),a5=n(243742),a3=n(556713),a7=n(341197),a6=n(222631),a9=n(946482),re=n(472346),rt=n(3360),rn=n(69814),ra=n(835403),rr=n(90509),ro=n(730791),rl=n(118931),ri=n(613102),rs=n(818843),rc=n(145789),rd=n(140593),rp=n(838516),rm=n(543509),ru=n(177131),rE=n(340818),rg=n(596523),ry=n(404911),r_=n(167502),rh=n(89402),rf=n(641860),rv=n(819635),rb=n(469991),rS=n(431305),rT=n(769617),rN=n(691537),rI=n(925163),rP=n(646738),rC=n(878206),rk=n(871972),rA=n(191387),rw=n(83661),rO=n(463420),rx=n(96796),rR=n(397863),rL=n(617691),rD=n(603275),rM=n(876560),rK=n(415684),rF=n(132540);let rV="styles--contextMenu--C-hVT",rU="styles--caret--DZmzh",rB="styles--rowSelectedExpanded--MGvUV",rG="styles--rowSelectedSecondaryLightBlue--S-zy- draggable_list--rowSelectedSecondary--yOI1g raw_components--rowSelectedSecondary---U7Us raw_components--rowSelected--M2Eip";function rz({childLeft:e,childRight:t,deleteSelectedItems:n,forceShowHoverBorder:a,hideStylePreview:o,index:l,inspectStyleSelected:i,isDragging:s,isEditable:c,isRenaming:d,isCollapsed:p=!0,isLastChildOfSelection:m=!1,isFirstChildOfSelection:u=!1,isFolder:E,level:g,name:y,nameRef:_,onContextMenu:h,onCreateFolder:f,onDoubleClick:v,onHoverChange:b,onMouseDown:S,onMouseMove:T,recordingKey:N,rowRef:I,secondaryName:P,selected:C,selectedSecondary:k,stopRenamingItem:A,tooltipData:w}){let[O,x]=r.useState(y),[R,L]=r.useState(!1),D=(0,ew.GS)(),M=r.useCallback(e=>{e?.select()},[]);r.useEffect(()=>{x(y)},[y]);let K=r.useCallback(e=>{""===e.trim()?(A(l,y),x(y)):A(l,e)},[l,y,A]),F=(0,as.AF)((0,as.Pt)(N,"text-input"),"change",r.useCallback(e=>{x(e.currentTarget.value)},[x])),V=(0,as.v_)((0,as.Pt)(N,"text-input"),"keydown",e=>{e.keyCode===rK.Uz.ESCAPE?(A(l,y),x(y)):e.keyCode===rK.Uz.ENTER&&K(e.currentTarget.value)},{recordMetadata:e=>({inputValue:e.currentTarget.value}),playbackMetadata:e=>({currentTarget:{value:e.inputValue}})}),U=(0,as.v_)(N,"keydown",e=>{c&&!d&&(e.keyCode===rK.Uz.BACKSPACE||e.keyCode===rK.Uz.DELETE)?n():c&&!d&&e.keyCode===rK.Uz.G&&(0,rK.Fo)(e)?(f(),e.preventDefault()):!d&&e.nativeEvent&&ac.Y5.forwardKeyboardEvent(e.nativeEvent)}),B=r.useCallback(()=>{K(O)},[K,O]),G=(0,as.rf)(N,"contextmenu",e=>{h(e)}),z=(0,as.rf)(N,"mousemove",e=>{T(e)},{recordMetadata:e=>({bounds:e.currentTarget.getBoundingClientRect(),pageX:e.pageX,pageY:e.pageY}),playbackMetadata:e=>({currentTarget:{getBoundingClientRect:()=>e.bounds},pageX:e.pageX,pageY:e.pageY})}),W=(0,as.rf)(N,"mousedown",e=>{S(e),o()}),H=(0,as.rf)(N,"mouseenter",r.useCallback(()=>{L(!0),b?.(!0)},[L,b])),Y=r.useCallback(()=>{L(!1),b?.(!1)},[L,b]),$=(0,as.rf)(N,"dblclick",r.useCallback(e=>{v(e)},[v])),X=Math.min((g-1)*3,18),j=rF.jNX-4-X,Q=j-(D?7:5),J=R&&!d||i?Q:j,q=C||k,Z=eG()({[rB]:!p&&q,"styles--folderSecondarySelected--SL0JY":k||C&&!u,[rG]:k&&!D}),ee=eG()({[rG]:q,[rB]:!m&&q}),et=eG()("styles--rowWithBorder--bphZ-",{[Z]:E,[ee]:!E,"styles--rowWithHover--RWNMH":!q&&(a||R&&!s)}),en=r.createElement("div",{className:d?"styles--rowContentsRenaming--oDTtO styles--rowContents--37JBy":"styles--rowContents--37JBy",key:y,style:D?{width:"100%"}:{gridColumnEnd:`span ${J}`}},d?r.createElement(rw.ks,{autoCapitalize:"off",autoCorrect:"off",autoFocus:!0,className:"styles--input--LbjR0",onBlur:B,onChange:F,onKeyDown:V,innerRef:M,spellCheck:!1,value:O}):r.createElement(r.Fragment,null,r.createElement("div",{className:"styles--name--KWZ8d ellipsis--ellipsis--Tjyfa",ref:_,...w},y),P&&r.createElement("div",{className:"styles--textStyle--DiUv4"},P)));return r.createElement(rA.e,{className:et,dragging:s,hideGrabber:!0,onContextMenu:G,onKeyDown:U,onMouseDown:W,onMouseEnter:H,onMouseLeave:Y,onMouseMove:z,onDoubleClick:$,ref:I,selected:C,selectedSecondary:!1,tabIndex:0},X>0&&r.createElement("span",{style:{gridColumnEnd:`span ${X}`}}),r.createElement("div",{className:"styles--childLeftContainer--Hu61K",style:D?{gridColumnEnd:`span ${J}`}:void 0},e,D&&en),!D&&en,t)}var rW=n(949207),rH=n(432023),rY=n(501191),r$=n(660164);function rX({deleteSelectedItems:e,folder:t,folderNameToNestUnder:n,hideStylePreview:a,index:l,isCollapsed:i,isDragging:s,isEditable:c,isRenaming:p,isTemporarilyExpanded:m,isFirstChildOfSelection:u,level:E,onContextMenu:g,onCreateFolder:y,onMouseDown:_,onMouseMove:h,onRenameItem:f,recordingKey:v,selected:b,selectedSecondary:S,stopRenamingItem:T,temporarilyExpandFolder:N,toggleFolder:I}){let P=(0,o.wA)(),[C,k]=r.useState(!1),A=r.useRef(null),w=r.useRef(null),O=C&&!p&&c,x=r.useCallback(()=>{I(!i)},[i,I]),R=r.useCallback(e=>{e.target!==w.current&&t.styleTypeSection&&f(t.name,!1,t.styleTypeSection)},[t.name,t.styleTypeSection,f]);r.useEffect(()=>{if(C&&s&&i){let e=setTimeout(()=>{N(t.name)},1e3);return()=>clearTimeout(e)}},[C,s,i,N,t]);let L=r.useCallback(()=>{let e=(0,rL.Zk)(t.styleTypeSection),n=A.current?.getBoundingClientRect();e&&n&&P(rS.Zs({rowLeft:n.left,rowTop:n.top,styleType:t.styleTypeSection,styleNameInputPrefix:`${t.name}/`,inheritStyleKeyField:e}))},[A,t.name,t.styleTypeSection,P]);return r.createElement(rz,{deleteSelectedItems:e,forceShowHoverBorder:n===t.name,hideStylePreview:a,index:l,isDragging:s,isEditable:c,isRenaming:p,isCollapsed:i,isFolder:!0,isFirstChildOfSelection:u,level:E,name:(0,rI.kH)(t.name),onContextMenu:g,onCreateFolder:y,onDoubleClick:R,onHoverChange:k,onMouseDown:_,onMouseMove:h,onRenameItem:f,recordingKey:v,selected:b,selectedSecondary:S,stopRenamingItem:T,rowRef:A,childLeft:r.createElement(nb.E,{onClick:x,className:"styles--caretContainer--4-dqw",ref:w},r.createElement(rD.U,{svg:i&&!m?rH.A:rW.A,className:rU},i&&!m?r.createElement(rO.k,{className:rU}):r.createElement(rx.O,{className:rU}))),childRight:O&&r.createElement(rw.$4,null,r.createElement(eV.K,{recordingKey:as.Pt(v,"addButton"),"aria-label":(0,d.t)("design_systems.styles.tooltips.create"),onClick:L,htmlAttributes:{"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("design_systems.styles.tooltips.create")}},r.createElement(rD.U,{svg:rY.A,fallbackSvg:r$.A,children:r.createElement(rR.x,null)})))})}var rj=n(309782),rQ=n(221768),rJ=n(853935),rq=n(669858),rZ=n(870161),r0=n(483630),r1=n(162502);function r4({deleteSelectedItems:e,hideStylePreview:t,index:n,isDragging:a,isEditable:l,isRenaming:i,isLastChildOfSelection:s,level:c,onContextMenu:p,onCreateFolder:m,onInspectStyle:u,onMouseDown:E,onMouseMove:g,onRenameItem:y,recordingKey:_,selected:h,selectedSecondary:f,stopRenamingItem:v,dsStyle:b,stylePreviewShown:S,updateContextMenuStyleRef:T,updateSelection:N,updateFocusRowRef:I}){let[P,C]=r.useState(!1),k=(0,o.wA)(),A=r.useRef(null),w=r.useRef(null),O=(0,ew.GS)(),x=r.useCallback(()=>{l&&y(b.node_id,!0,b.style_type)},[y,b.node_id,b.style_type,l]),R=S.isShown&&!S.isCreating&&S.style.node_id===b.node_id&&(0,rJ.EF)(S.style,b),L=P&&!i||R,D=r.useCallback(function(){let e=w.current;if(e){let t=e.getBoundingClientRect();R?k(rS.sw()):(k(rS.rk({style:b,rowTop:t.top,rowLeft:t.left})),u(b),N({type:b.style_type,folderNames:new Set,styleIds:new Set(b.node_id)}))}k(to.XE())},[k,u,N,b,R]),M=r.useCallback(e=>{(2===e.button||e.ctrlKey)&&T(w.current),E(e),R&&D()},[D,E,R,T]),K=A.current,F=!!K&&K.offsetWidth<K.scrollWidth,V=r.useMemo(()=>!a&&b.description&&F?{"data-tooltip-type":rM.Ib.SPECIAL,"data-tooltip":r0.Z,"data-tooltip-style-name":(0,rI.kH)(b.name),"data-tooltip-style-description":b.description,"data-tooltip-max-width":rF.jNX*(0,nK.hG)(rF.dGl)}:null,[F,a,b.name,b.description]),U="TEXT"===b.style_type&&b.meta?.style_thumbnail?b.meta.style_thumbnail:null;return r.createElement(rz,{deleteSelectedItems:e,hideStylePreview:t,index:n,inspectStyleSelected:R,isDragging:a,isEditable:l,isRenaming:i,isFolder:!1,isLastChildOfSelection:s,level:c,name:(0,rI.kH)(b.name),nameRef:A,onContextMenu:p,onCreateFolder:m,onDoubleClick:x,onHoverChange:C,onMouseDown:M,onMouseMove:g,onRenameItem:y,recordingKey:_,rowRef:e=>{e&&(I?.(e),w.current=e)},secondaryName:U&&(0,rq.P$)(U),selected:h,selectedSecondary:f,stopRenamingItem:v,tooltipData:V,childLeft:r.createElement(r.Fragment,null,r.createElement(rZ.zi,{dsStyle:b,disableTooltip:!0}),h&&"FILL"===b.style_type&&r.createElement("div",{className:"styles--selectedRing--UniEc"})),childRight:L&&r.createElement(rw.$4,null,r.createElement("div",{style:{gridColumnEnd:"span 1"}}),O?r.createElement(rj.d,{recordingKey:as.Pt(_,"customButton"),toggled:R,onClick:D,htmlAttributes:{"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":l?(0,d.t)("design_systems.styles.edit_style"):(0,d.t)("design_systems.styles.view_style"),onMouseDown:rT.dG},children:r.createElement(rD.U,{svg:r1.A},r.createElement(rQ.A,null)),"aria-label":l?(0,d.t)("design_systems.styles.edit_style"):(0,d.t)("design_systems.styles.view_style")}):r.createElement(rw.YW,{className:h?"styles--showOnSelectedRowHover--Lcf7e styles--showOnRowHover--OUqRT":"styles--showOnRowHover--OUqRT",recordingKey:as.Pt(_,"customButton"),"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":l?(0,d.t)("design_systems.styles.edit_style"):(0,d.t)("design_systems.styles.view_style"),selected:R,onMouseDown:rT.dG,onClick:D},r.createElement(rD.U,{svg:r1.A},r.createElement(rQ.A,null))))})}function r2({styleType:e,children:t}){let n=!(0,er.p8)("isReadOnly");return r.createElement("div",{className:"styles--styleTypeSection--jPjTq component_tiles--section--qMua7"},n?r.createElement(r8,{styleType:e,recordingKey:`style-section-header-${e}`}):r.createElement("div",{className:"styles--styleTypeSectionHeader--224lA component_tiles--sectionHeader--eEC6d raw_components--panelTitle--VAQQA"},(0,rN.QT)(e)),t)}function r8({styleType:e,recordingKey:t}){let[n,a]=r.useState(!1),l=(0,o.wA)(),i=r.useRef(null),s=r.useCallback(()=>{let t=(0,rL.Zk)(e),n=i.current?.getBoundingClientRect();t&&n&&l(rS.Zs({rowLeft:n.left,rowTop:n.top,styleType:e,inheritStyleKeyField:t}))},[i,e,l]);return r.createElement("div",{className:"styles--styleTypeSectionRow--wVTIO",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),ref:i},r.createElement(rw.JU,{className:"styles--styleTypeSectionRowLabel--PrKm-"},(0,rN.QT)(e)),r.createElement("div",{style:{visibility:n?"visible":"hidden"}},r.createElement(eV.K,{recordingKey:as.Pt(t,"addButton"),"aria-label":(0,d.t)("design_systems.styles.tooltips.create_style_from_section",{kind:(0,rN.XV)(e).toLowerCase()}),onClick:s,htmlAttributes:{"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("design_systems.styles.tooltips.create_style_from_section",{kind:(0,rN.XV)(e).toLowerCase()})}},r.createElement(rD.U,{svg:rY.A,fallbackSvg:r$.A,children:r.createElement(rR.x,null)}))))}r2.displayName="StyleTypeSection";var r5=n(454475),r3=n(345202),r7=n(109392);let r6=r5.ms,r9=r5.c$,oe=r5.wv,ot="styles-by-type-context-menu",on=.75*(0,nK.hG)(rF.uj0);function oa({styleRowRef:e,onEditStyle:t,onRenameItem:n,onCreateFolder:a,onDeleteItems:l,onCutItems:i,onPasteItems:s,styleType:c}){let d=(0,r3.Um)(),p=(0,o.d4)(e=>e.library.localStyleSelection),m=r.useMemo(()=>p&&p.type===c&&d?.type===ot?(0,r7.QA)(p,d.data.uiList):[],[p,d,c]),u=r.useMemo(()=>(0,r7.Ug)(m).map(e=>e.node_id),[m]),E=u.length;return d&&u.length?r.createElement(or,{styleRowRef:e,selectedItems:m,numStyles:E,dropdownShown:d,onEditStyle:t,onRenameItem:n,onCreateFolder:a,onDeleteItems:l,onCutItems:i,onPasteItems:s}):r.createElement("div",null)}function or({styleRowRef:e,selectedItems:t,numStyles:n,dropdownShown:a,onEditStyle:l,onRenameItem:s,onCreateFolder:c,onDeleteItems:p,onCutItems:m,onPasteItems:u}){let E=(0,o.wA)();r.useEffect(()=>(i.glU.computePastableStyleCount(),()=>{i.glU.clearPastableStyleCount()}),[]);let g=(0,o.d4)(e=>e.mirror.appModel.pastableStyleCount),y=!!eo.q5()?.canEdit,_=r.useCallback(()=>{if(!t.length||t[0].type!==t5.PW.STYLE)return;let n=t[0];if(e){let t=e.getBoundingClientRect();E(rS.rk({style:n,rowTop:t.top,rowLeft:t.left})),E(to.XE())}l(n)},[E,t,l,e]),h=r.useCallback(()=>{if(!t.length||t[0].type===t5.PW.STYLE)return;let e=t[0];s(e.name,!1,e.styleTypeSection)},[s,t]);if(-1===g)return r.createElement("div",null);if(!y)return n>1?r.createElement("div",null):r.createElement(r6,{style:a.data.position,className:rV},r.createElement(r9,{recordingKey:"edit-style-option",onClick:_},(0,d.tx)("design_systems.styles.view_style")));let f=1===n&&(t[0].type===t5.PW.STYLE?r.createElement(r9,{recordingKey:"edit-style-option",onClick:_},(0,d.tx)("design_systems.styles.edit_style")):r.createElement(r9,{recordingKey:"rename-folder-option",onClick:h},(0,d.tx)("design_systems.styles.rename_folder")));return r.createElement(r6,{style:a.data.position,className:rV},r.createElement(r9,{recordingKey:"create-folder-option",onClick:c},(0,d.tx)("design_systems.styles.add_new_folder")),f,r.createElement(r9,{recordingKey:"delete-style-option",onClick:p},(0,d.tx)("design_systems.styles.delete_styles",{numStyles:n})),r.createElement(oe,null),r.createElement(r9,{recordingKey:"cut-style-option",onClick:m},(0,d.tx)("design_systems.styles.cut_styles",{numStyles:n})),!!g&&r.createElement(r9,{recordingKey:"paste-style-option",onClick:u},(0,d.tx)("design_systems.styles.paste_styles",{numStyles:g})))}var oo=n(927457),ol=n(710752),oi=n(582288),os=n(884909),oc=n(304173),od=n(283956),op=n(248172),om=n(278865),ou=n(608974),oE=n(257812),og=n(319431),oy=n(914110);let o_="local-style-creation-dropdown";function oh(){let e=(0,o.wA)(),t=(0,r.useContext)(om.lk),n=!(0,er.p8)("isReadOnly"),a=r.useRef(null),l=r.useRef(null),i=a.current,s=(0,r3.Um)(),c=s?.type===o_,p=s?.data?.targetRect,m="localStyleHeader",u=0===(0,a9.Bs)().length,E=(0,o.d4)(e=>e.stylePreviewShown.isShown&&e.stylePreviewShown.isCreating),g=r.useMemo(()=>p||(c&&i?i.getBoundingClientRect():null),[p,i,c]),y=()=>{e(rv.oB())},_=()=>{e(rv.j7({type:o_}))},h=t=>{t.stopPropagation(),e(rS.YG());let n=a.current;c?y():n&&((0,ez.sx)("editor-local-styles-dropdown-show"),_())},f=e=>{y();let n=(0,rL.Zk)(e),a=l.current?.getBoundingClientRect();n&&a&&t({styleType:e,inheritStyleKeyField:n,rowLeft:a.left,rowTop:a.top})},v=u&&!c&&!E;return r.createElement(rw.fI,{className:v?"styles--panelHeaderRowFaded--pfgKz styles--panelHeaderRow--Kxqgo styles--styleTypeSectionRow--wVTIO draggable_list--panelHeaderRowFaded--kETRR":"styles--panelHeaderRow--Kxqgo styles--styleTypeSectionRow--wVTIO",ref:l},r.createElement(rw.xZ,{className:"styles--panelTitleText--v7gXm draggable_list--panelTitleText--SwKez",onMouseDown:e=>v&&h(e),onClick:e=>e.stopPropagation()},(0,d.tx)("design_systems.styles.local_styles")),n&&r.createElement(r.Fragment,null,r.createElement(rw.K0,{ref:a,onMouseDown:h,onClick:e=>e.stopPropagation(),className:c?"styles--stylesHeaderButtonHighlight--WTeWy raw_components--iconButtonSelected--bJibL raw_components--_iconButton---ybo6":"styles--stylesHeaderButton--jhpA5 draggable_list--addButton--D0q--","data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("design_systems.create_style.create_style"),recordingKey:as.Pt(m,"addButton")},r.createElement(rD.U,{svg:rY.A,fallbackSvg:r$.A},r.createElement(oo.e,null))),c&&g&&r.createElement(op.Cf,{targetRect:g,minWidth:128,disableDropdownScrollContainer:!0,propagateCloseClick:!0},rN.og.map(e=>{let{icon:t,label:n}=function(e){switch(e){case"TEXT":return{icon:r.createElement(rD.U,{svg:oy.A},r.createElement(ol.e,null)),label:(0,d.t)("design_systems.styles.dropdown.text")};case"FILL":return{icon:r.createElement(rD.U,{svg:oE.A},r.createElement(oi.G,null)),label:(0,d.t)("design_systems.styles.dropdown.fill")};case"GRID":return{icon:r.createElement(rD.U,{svg:og.A},r.createElement(os.E,null)),label:(0,d.t)("design_systems.styles.dropdown.grid")};case"EFFECT":return{icon:r.createElement(rD.U,{svg:ou.A},r.createElement(oc.n,null)),label:(0,d.t)("design_systems.styles.dropdown.effect")};default:throw(0,rd.j)(e),Error(`Invalid style type: ${e}`)}}(e),a=t=>{t.stopPropagation(),f(e)};return r.createElement(r5.c$,{key:e,className:"styles--createStyleDropdownRow--7iCXQ",onClick:a,onPointerUp:a,recordingKey:as.Pt(m,`dropdown-option-${e}`)},r.createElement(od.Nu,null,t),n)}))))}let of="collapsed-style-folders";function ov({scrollContainer:e,recordingKey:t}){let n=(0,a9.Bs)(),a=(0,er.p8)("isReadOnly");return 0===n.length&&a?null:r.createElement(rf.k,{name:"local_styles_panel"},r.createElement(rw.Zk,null,r.createElement(ob,{scrollContainer:e,recordingKey:t})))}function ob({scrollContainer:e,recordingKey:t}){let n=(0,o.wA)(),a=(0,o.d4)(e=>e.stylePreviewShown),l=(0,o.d4)(e=>e.mirror.appModel.activeCanvasEditModeType),s=(0,o.d4)(e=>e.mirror.appModel.currentTool),c=r.useRef(null),d=(0,a9.Bs)(),p=(0,o.d4)(e=>e.library.localStyleSelection),[m,u]=r.useState(null),[E,g]=r.useState(null),y=r.useRef(null),[_,h]=r.useState(!1),f=l===i.m1T.GRADIENT||l===i.m1T.RASTER||s===i.NLJ.DROPPER_COLOR;r.useEffect(()=>{let e=()=>{!f&&(n(rb.Bn(null)),a.isShown&&(n(rS.sw()),i.glU.selectStyle(ru.n3.INVALID,ru.IA.INVALID)))},t=(0,rT.ft)();return t?window.addEventListener("pointerdown",e):window.addEventListener("mousedown",e),()=>{t?window.removeEventListener("pointerdown",e):window.removeEventListener("mousedown",e)}},[n,a.isShown,f]);let{stylesByType:v,foldersAndStylesByType:b}=r.useMemo(()=>{let e=(0,rN.Kw)(d),t=new Map;return rN.og.map(n=>{let a=e.get(n);if(a){(0,rN.LX)(a);let e=(0,r7.lM)(a,n),r=(0,r7.l0)(e);t.set(n,r)}}),{stylesByType:e,foldersAndStylesByType:t}},[d]),S=r.useCallback(e=>{(0,rd.KF)(null!=e.content_hash,"style does not have a hash"),i.glU.selectStyleByGuid(e.node_id),n(rb.ay({isRenaming:!1})),(0,ez.sx)("Style Inspected",{styleType:e.style_type,from:"styleListClick"})},[n]),T=r.useCallback((e,t,n)=>{u(t?e:null),g(t?null:{name:e,styleTypeSection:n})},[]),N=r.useCallback(e=>{if(!e){n(rb.Bn(null));return}let t=new Set;e.styleIds.forEach(n=>{let a=d.find(e=>e.type===t5.PW.STYLE&&e.node_id===n);if(!a)return;let r=(0,rI.In)(a.name);e.folderNames.has(r)||t.add(n)});let a={type:e.type,folderNames:e.folderNames,styleIds:t};n(rb.Bn(a))},[n,d]),I=r.useCallback((e,t,n)=>{if(!p)return;let a=e[t],r=(e,t)=>{let a=(0,rI.ke)(e.name),r=null!=t?t:a.length-1;a[r]=n;let o=(0,r7.Pc)(a.join("/"));rE.l7.user("rename-style",()=>i.glU.renameNode(e.node_id,o))};if(a.name!==n){if(a.type===t5.PW.STYLE)r(a);else{(0,r7.mx)(t,e).forEach(t=>{let n=e[t];n.type===t5.PW.STYLE&&r(n,a.level-1)});let o=new Set(p.folderNames);o.delete(a.name);let l=(0,rI.In)(a.name)+"/"+n;o.add(l),N({type:p.type,folderNames:o,styleIds:p.styleIds})}}ac.Y5.triggerAction("commit"),u(null),g(null)},[p,N]),P=r.useCallback((e,t)=>{t.preventDefault(),t.stopPropagation(),n(rv.j7({type:ot,data:{uiList:e,position:{top:t.clientY,left:Math.min(t.clientX,window.innerWidth-on)}}}))},[n]),C=r.useCallback(e=>{y.current=e},[]),k=r.useCallback(()=>{h(!0)},[]),A=r.useCallback(()=>{h(!1)},[]);return r.createElement("div",{className:"styles--localStylesPanel--T4Gqs",ref:c},r.createElement(oh,null),rN.og.map(n=>{let a=v.get(n);if(!a)return;let o=b.get(n);if(o)return r.createElement(oS,{key:n,recordingKey:as.Pt(t,`style-section-${n}`),styleType:n,storedStyleList:a,styleList:o,updateSelection:N,isDragging:_,onDragStart:k,onDragEnd:A,onInspectStyle:S,onContextMenu:P,updateContextMenuStyleRef:C,renamingStyleID:m,renamingFolder:E,onRenameItem:T,stopRenamingItem:I,styleRowRef:y.current,onEditStyle:S,scrollContainer:e})}))}function oS({styleType:e,storedStyleList:t,styleList:n,renamingStyleID:a,renamingFolder:l,onRenameItem:s,stopRenamingItem:c,onDragStart:p,onDragEnd:m,onInspectStyle:u,onContextMenu:E,updateContextMenuStyleRef:g,updateSelection:y,styleRowRef:_,scrollContainer:h,recordingKey:f}){let v=(0,eo.q5)(),b=!(0,er.p8)("isReadOnly"),S=(0,o.wA)(),T=(0,o.d4)(e=>e.stylePreviewShown),N=(0,ew.GS)(),I=(0,o.d4)(t=>(0,rP.i4)(t,e)),P=(0,o.d4)(t=>(0,rP.A7)(t,e,n)),[C,k]=r.useState(()=>{if(rh.x4&&v){let t=JSON.parse(rh.x4.getItem(of)||"{}");if(v.key in t){let n=t[v.key];if(e in n)return new Set(n[e])}else t[v.key]={},rh.x4.setItem(of,JSON.stringify(t))}return new Set(n.filter(e=>"STYLE_FOLDER"===e.type).map(e=>e.name))}),[A,w]=r.useState([]),[O,x]=r.useState(null),[R,L]=r.useState(null),D=r.useMemo(()=>(0,rp.s)(()=>{S(nQ.GT({styleType:e}))},200),[S,e]);r.useEffect(()=>{D()},[D,n]);let M=(0,rg.ZC)(C);r.useEffect(()=>{if(!M||!rh.x4||!v||(0,r_._f)(M,C))return;let t=JSON.parse(rh.x4.getItem(of)||"{}"),n=t[v.key];n&&(n[e]=[...C],rh.x4.setItem(of,JSON.stringify(t)))},[C,v,M,e]);let K=r.useCallback(e=>!!e&&"STYLE_FOLDER"===e.type,[]),F=r.useCallback((e,t)=>{let a=new Set(e),r=[];n.forEach((e,t)=>{if(a.has(e)&&(r.push(t),"STYLE_FOLDER"===e.type)){let e=(0,r7.mx)(t,n);r.push(...e)}});let o=new Set(r),l=t?n.indexOf(t):n.length,i=[...(0,rm.y1)(l).filter(e=>!o.has(e)),...r,...(0,rm.y1)(l,n.length).filter(e=>!o.has(e))],s=new Map;return i.forEach((e,t)=>{e!==t&&s.set(e,t)}),s},[n]),V=r.useCallback(()=>{T.isShown&&(S(rS.sw()),S(to.XE()),i.glU.selectStyle(ru.n3.INVALID,ru.IA.INVALID))},[S,T.isShown]),U=r.useMemo(()=>{if(!O)return null;if("in"===O.type){let e=n[O.index];return e?{folderNameToNestUnder:e.name,dividerStyles:{display:"none"}}:null}if(null==O.index||null==R||!I)return null;let e=(0,r7.QA)(I,n),t=e[0],a=null,r=null;if(0===O.index?r=n[O.index]:O.index===n.length?a=n[O.index-1]:(a=n[O.index-1],r=n[O.index]),a?.type==="STYLE_FOLDER"&&C.has(a.name)&&-1===A.indexOf(a.name))return{folderNameToNestUnder:a.name,dividerStyles:{display:"none"}};if(a?.type===t5.PW.STYLE){let e=(0,rI.In)(a.name).split("/");for(let n=0;n<e.length;n++){let a=e.slice(0,n+1).join("/");if(C.has(a)&&-1===A.indexOf(a)){if("STYLE_FOLDER"!==t.type)return{folderNameToNestUnder:a,dividerStyles:{display:"none"}};return{folderNameToNestUnder:(0,rI.In)(a),dividerStyles:{marginLeft:24*Math.min((0,rI.ke)(a).length,8)-8}}}}}let o=0,l=null,i=a?(0,r7.rM)(a):0,s=r?(0,r7.rM)(r):0;if(i<=s)o=s,l=a?a.type===t5.PW.STYLE?(0,rI.In)(a.name):a.name:"";else if((0,rd.KF)(null!=a,"Dragging after an item that doesn't exist"),t.type===t5.PW.STYLE||R>=.5)o=i,l=(0,rI.In)(a.name);else{let e=Math.floor(R/.5*(0,r7.rM)(a));e=Math.max(s-1,e),l=(0,rI.ke)((0,rI.In)(a.name)).slice(0,e).join("/"),o=e+1}let c={marginLeft:24*Math.min(o,8)-8};return a&&e.includes(a)||!(0,r7.Md)(a,t,r)?{folderNameToNestUnder:null,dividerStyles:c}:{folderNameToNestUnder:l,dividerStyles:c}},[C,R,I,O,n,A]),B=r.useCallback((a,r,o,l)=>{if(!t||!r&&!o||!U)return;let i=U.folderNameToNestUnder;if(null===i)return;let s=[],c=[];a.forEach(e=>{(0,r7.Md)(r,e,o,i)&&("STYLE_FOLDER"===e.type?c.push(e):s.push(e))});let d=s.concat(c);if(!d.length)return;let p=rE.l7.user("reorder-styles",()=>(0,r7.VB)(d,r,o,i,n,t,l||!1)),m=new Set,u=new Set;d.forEach(e=>{let t=(0,r7.t_)(e),n=p?.get(t);n&&("STYLE_FOLDER"===e.type?m.add(n):u.add(t))}),y({type:e,folderNames:m,styleIds:u});let E=new Set;return C.forEach(e=>{if(i.startsWith(e))return;let t=p?.get(e);t?E.add(t):E.add(e)}),k(E),V(),l||ac.Y5.triggerAction("commit"),F(d,o)},[y,C,U,F,V,t,n,e]),G=r.useCallback((e,t)=>{if("STYLE_FOLDER"!==t.type)return;let a=n.indexOf(t),r=(0,r7.dm)(t).filter(e=>(0,rI.In)(e.name)===t.name);if(!r.length)return B(e,t,n[a+1]);{let t=r[r.length-1],a=n.indexOf(t);return B(e,t,n[a+1])}},[B,n]),z=(0,ry.xx)((e,t)=>{let a=new Map,r=t.map(e=>e.type===t5.PW.STYLE?e.node_id:e.name);return e.forEach(e=>{let o=r.indexOf(e);-1!==o&&(0,r7.mx)(o,n).forEach(e=>{let n=t[e],r="STYLE_FOLDER"===n.type?n.name:n.node_id,o=a.get(r);o||(o=0),a.set(r,o+1)})}),a}),W=r.useCallback(()=>{if(!I)return;let t=(0,r7.QA)(I,n);if(0===t.length)return;let a=t[0],r=n.indexOf(a),o=r,l=r+1;if(a.type===t5.PW.STYLE&&n[l]&&n[l].type===t5.PW.STYLE){let e=(0,r7.rM)(a);for(let t=r+1;t<n.length;t++){let a=n[t];if("STYLE_FOLDER"===a.type&&a.level===e||(0,r7.rM)(a)<e){o=t-1,l=t;break}t===n.length-1&&(o=t,l=t+1)}}B(t,n[o],n[l],!0);let c=(0,rI.In)(a.name),p=N?(0,d.t)("design_systems.create_style.new_folder"):(0,d.t)("design_systems.create_style.untitled_folder");c&&(p=`${c}/${p}`);let m=(e,t)=>{if(e.type===t5.PW.STYLE){let n=p+"/"+t+(0,rI.kH)(e.name);rE.l7.user("rename-style",()=>{i.glU.renameNode(e.node_id,n)})}else{let n=t+(0,rI.kH)(e.name)+"/";e.styles.forEach(e=>{m(e,n)}),e.subfolders.forEach(e=>{m(e,n)})}};t.forEach(e=>{m(e,"")}),y({type:e,folderNames:new Set([p]),styleIds:new Set}),s(p,!1,e)},[y,B,N,I,s,n,e]),H=r.useCallback((e,t)=>{let a=n[e];"STYLE_FOLDER"===a.type&&k(e=>{let n=new Set(e);return t?n.add(a.name):n.delete(a.name),n})},[n]),Y=r.useCallback((e,t)=>{k(a=>{let r=new Set(a),o=n[e];if("STYLE_FOLDER"===o.type){let e=(0,rI.In)(o.name),n=""===e?t:e+"/"+t;C.has(o.name)&&(C.delete(o.name),C.add(n)),(0,r7.KU)(o).forEach(e=>{if(C.has(e.name)){let t=e.name.replace(o.name,"");C.add(n+t),C.delete(e.name)}})}return r}),c(n,e,t)},[c,C,n]),$=r.useCallback(e=>{E(n,e)},[E,n]),X=r.useCallback((e,t,n)=>{let a=t>.5?1:Math.round(1e3*t)/1e3;x({index:e,type:n?"in":"before"}),L(a)},[]),j=r.useCallback(()=>{k(e=>rE.l7.user("delete-styles",()=>{let t=new Set(e);return(I?(0,r7.QA)(I,n):[]).forEach(e=>{"STYLE_FOLDER"===e.type?((0,r7.a2)(e,v?.key||null),C.delete(e.name),(0,r7.KU)(e).forEach(e=>C.delete(e.name))):(0,r7.Nr)(e,v?.key||null)}),t})),ac.Y5.triggerAction("commit"),T.isShown&&(S(rS.sw()),S(to.XE()),i.glU.selectStyle(ru.n3.INVALID,ru.IA.INVALID)),y(null)},[T.isShown,y,I,n,v?.key,C,S]),Q=r.useMemo(()=>{let e=I?(0,r7.QA)(I,n):[];return(0,r7.Ug)(e).map(e=>e.node_id)},[I,n]),J=r.useCallback(()=>{rE.l7.user("cut-styles",()=>i.glU.cutStyles(Q))},[Q]),q=r.useCallback((e,t)=>{t===rC.zy.PASTE?rE.l7.user("paste-styles",()=>i.glU.pasteStyles()):e.shouldPropagate=!0},[]);r.useEffect(()=>{if(!I)return;let e=e=>{e.target&&("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)||J()};return document.addEventListener("cut",e),()=>{document.removeEventListener("cut",e)}},[J,I]);let Z=r.useCallback(()=>{i.glU.pasteStyles()},[]),ee=r.useCallback(e=>{w(t=>[...t,e])},[]),et=r.useCallback(()=>{p()},[p]),en=as.rf(f,"ondragend",r.useCallback(()=>{x(null),L(null),w([]),m()},[m])),ea=(0,rg.ZC)(I);r.useEffect(()=>{ea!==I&&I&&k(e=>{let n=new Set(e);for(let e of I.styleIds.values()){let a=t.find(t=>t.node_id===e);if(!a)continue;let r=(0,rI.ke)(a.name);for(let e=0;e<r.length;e++){let t=r.slice(0,e).join("/");n.delete(t)}}return n})},[I,ea,t]);let el=r.useRef(null),ei=r.useCallback(e=>{el.current=e},[el]),es=r.useMemo(()=>I?(0,r7.h$)(I,n):[],[I,n]),ec=r.useMemo(()=>P?(0,r7.h$)(P,n):[],[P,n]),ed=r.useMemo(()=>[...es,...ec].sort((e,t)=>e-t),[es,ec]),ep=r.useCallback((e,t,o,i,c,d)=>{let p="STYLE_FOLDER"===e.type?e.name:e.node_id,m=!1,E=!1;for(let t of A)if("STYLE_FOLDER"===e.type){if(e.name===t){E=!0;break}e.name.startsWith(t)&&(m=!0)}else if((0,rI.In)(e.name)===t){m=!0;break}if(!E&&!m&&z(C,n).has(p))return null;let _=ed&&ed[ed.length-1]===t,h=ed&&ed[0]===t;if(e.type===t5.PW.STYLE){let n=(0,r7.rM)(e),l=null!=a&&a===e.node_id;return r.createElement(r4,{hideStylePreview:V,recordingKey:`style-row-${t}`,index:t,key:e.node_id,isDragging:i,dsStyle:e,selected:o,selectedSecondary:P?.styleIds.has(e.node_id)||!1,level:n,stylePreviewShown:T,onContextMenu:$,updateContextMenuStyleRef:g,updateFocusRowRef:o?ei:null,onMouseDown:c,onMouseMove:d,onInspectStyle:u,updateSelection:y,isEditable:b,deleteSelectedItems:j,isRenaming:l,onRenameItem:s,stopRenamingItem:Y,onCreateFolder:W,isLastChildOfSelection:_})}{let n=null!=l&&l.name===e.name&&l.styleTypeSection===e.styleTypeSection,a=U?.folderNameToNestUnder||null;return r.createElement(rX,{recordingKey:`folder-section-${e.styleTypeSection}-row-${t}`,key:t,index:t,isDragging:i,folder:e,selected:o,selectedSecondary:P?.folderNames.has(e.name)||!1,isCollapsed:C.has(e.name),temporarilyExpandFolder:ee,isTemporarilyExpanded:E,isRenaming:n,folderNameToNestUnder:a,onRenameItem:s,stopRenamingItem:Y,level:e.level,toggleFolder:e=>H(t,e),onContextMenu:$,onCreateFolder:W,onMouseDown:c,onMouseMove:d,isEditable:b,deleteSelectedItems:j,hideStylePreview:V,isFirstChildOfSelection:h})}},[y,ed,C,j,U?.folderNameToNestUnder,z,V,$,W,u,s,l,a,P?.folderNames,P?.styleIds,Y,n,T,ee,A,H,g,b,ei]),em=r.useCallback(t=>{let a=new Set,r=new Set;t.forEach(e=>{let t=n[e];"STYLE_FOLDER"===t.type?a.add(t.name):r.add(t.node_id)}),y({type:e,folderNames:a,styleIds:r})},[y,n,e]),eu=r.useRef(),eE=r.useRef();return r.useEffect(()=>{eu.current&&es.length?(eu.current(),el.current&&!el.current.contains(document.activeElement)&&el.current.focus()):eE.current&&!es.length&&(eE.current(),el.current=null)},[eu,es,el]),r.createElement(rk.vL,{name:"StyleDraggableList",handleClipboard:q,focusFunctionRef:eu,blurFunctionRef:eE},r.createElement(r2,{styleType:e},r.createElement(oT,{recordingKey:"style-draggable-list",listItems:n,onInsertItemsIn:G,canInsertItemsIn:K,onInsertItemsBetweenValues:B,onDrag:X,onDragStart:et,onDragEnd:en,insertDividerStyle:U?.dividerStyles,selectedIndices:es,updateSelection:em,renderListItem:ep,scrollContainer:h,isDragDisabled:!b}),r.createElement(oa,{styleRowRef:_,onDeleteItems:j,onCutItems:J,onPasteItems:Z,onRenameItem:s,onEditStyle:u,onCreateFolder:W,styleType:e})))}class oT extends rA.q{}var oN=n(416267),oI=n(810108),oP=n(491374),oC=n(91966),ok=n(819634),oA=n(571871);function ow(e){let t=(0,ok.t)();return e.readOnly?r.createElement(oA.lc,{...e}):t.nodesAreAllInsideStacks&&"AUTO"===t.stackPositioning?null:r.createElement(rw.Zk,null,r.createElement(rw.fI,null,r.createElement(rw.xw,{extended:!0},(0,d.tx)("fullscreen.properties_panel.constraints_panel.constraints"))),r.createElement(oA.lc,{...e}))}function oO(e){return r.createElement(rf.k,{name:"constraints_panel"},r.createElement(ow,{...e}))}var ox=n(608597),oR=n(229418),oL=n(782540),oD=n(373996),oM=n(693861),oK=n(950053),oF=n(72955),oV=n(99074),oU=n(993908),oB=n(275716),oG=n(415450),oz=n(459298),oW=n(492323),oH=n(666533),oY=n(963989);function o$({recordingKey:e,numSelected:t}){let n=(0,ew.GS)(),a=t??1,o=()=>{i.glU.upgradeToLatestVectorOperationVersion()},l=(0,d.tx)("fullscreen.properties_panel.vector_operation.update_text",{numNodes:a}),s=(0,d.tx)("fullscreen.properties_panel.vector_operation.update_button",{numNodes:a});return r.createElement(rw.Zk,null,r.createElement("p",{className:W.cx.pl16.pr16.mb12.font11.$},l),n?r.createElement(oY.Ad,{label:null,input:r.createElement(am.$n,{variant:"secondary",onClick:o,recordingKey:as.Pt(e,"updateBoolean")},s)}):r.createElement(oH.z,{onClick:o,recordingKey:as.Pt(e,"updateBooleanUI2")},s))}var oX=n(490311),oj=n(294410),oQ=n(902911);function oJ(e){return e.modalShown?.type===oQ.y.type||e.modalShown?.prevModal?.type===oQ.y.type}function oq(){let e=(0,oj.n)({type:oQ.y}),t=(0,r.useCallback)(()=>{e()},[e]),n=(0,o.d4)(oJ),a=0===(0,nJ.Rb)().length&&!n;return r.createElement(rf.k,{name:"local_variables_panel"},r.createElement(rw.Zk,null,r.createElement(rw.fI,{className:a?"local_variables_panel--localVariablesPanelRowFaded--atToe local_variables_panel--localVariablesPanelRow--zR8nJ draggable_list--panelHeaderRowFaded--kETRR":"local_variables_panel--localVariablesPanelRow--zR8nJ"},r.createElement(rw.xZ,{className:"local_variables_panel--titleText--7rdD7 draggable_list--panelTitleText--SwKez",onClick:t,"data-onboarding-key":"local-variables-panel-title"},(0,d.tx)("variables.local_variables_panel.local_variables_title")),r.createElement(oX.E,{name:"variables_modal_button"},r.createElement(rj.d,{onClick:t,recordingKey:(0,as.Pt)("localVariablesPanel","variablesModalButton"),toggled:n,"aria-label":(0,d.t)("variables.local_variables_panel.open_variables_button_tooltip"),htmlAttributes:{"data-tooltip":(0,d.t)("variables.local_variables_panel.open_variables_button_tooltip"),"data-tooltip-type":rM.Ib.TEXT}},r.createElement(rD.U,{svg:r1.A},r.createElement(rQ.A,null)))))))}var oZ=n(278581);function o0({allSavedPlugins:e,colorFormat:t,dropdownShown:n,getContextualSelectionProperties:a,library:l,localPlugins:c,modalShown:d,openFile:p,orgEntity:m,pickerInStyleCreationShown:u,pickerShown:E,publishedPlugins:g,saveAsState:_,sceneGraphSelection:h,scrollContainer:f,selectedStyleProperties:v,selectionPaints:b,selectionProperties:S,shownPanels:T,strokePanelMode:N,strokePanelTerminalPointCount:I,stylePickerListLayout:P,stylePickerShown:C}){let k=(0,o.wA)(),A=(0,y.md)(a6.b),w=(0,o.d4)(e=>e.mirror.appModel);return r.createElement(rn.i,null,0===Object.keys(h).length&&r.createElement(oI.Mw,{panelName:oI.ON.DESIGN}),(0,re.d6)(T)&&r.createElement(oN.AV,{recordingKey:"alignPanel"}),r.createElement(ra.VF,{isVisible:T[i.ibQ.TRANSFORM_ITEM]},()=>r.createElement(oW.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:A,pickerShown:E,openFileKey:p?.key||null,canEditConstraints:(0,re.GG)(T),onlyShowXYInputsRow:A===a9.GR.DEFAULT_SIMPLIFIED||(a().areOnlyResponsiveSetsSelected??!1)})),r.createElement(ra.VF,{isVisible:(0,re.jP)(S)},()=>r.createElement(o$,{key:"vectorOperation",recordingKey:"vectorOperationPanel",numSelected:S.numSelected})),r.createElement(a9.F$,{isVisible:T[i.ibQ.SCALE_ITEM]}),r.createElement(ox.Q,{selection:h,shownPanels:T,scaleShouldHideOtherPanels:(0,re.NR)(T)}),r.createElement(ra.VF,{isVisible:T[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oz.r,{key:"template"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oZ.$,{key:"templateProperties",recordingKey:"templatePropsPanel"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.COMPONENT_ITEM]},()=>r.createElement(oC.cu,{key:"component",recordingKey:"componentPanel"})),r.createElement(ra.VF,{isVisible:(0,re.tV)(T,S.stateGroupSelectionInfo)},()=>r.createElement(rc.BS,{key:"componentProperties",recordingKey:"propsPanel"})),r.createElement(ra.VF,{isVisible:(0,re.M0)(T)},()=>r.createElement(oL._,{key:"instance",recordingKey:"instancePanel"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.VECTOR_ITEM]},()=>r.createElement(oW.Ss,{key:"vector-transform",recordingKey:"vectorTransformPanel",isUI3:!1,x:a().x,y:a().y,cornerRadius:a().cornerRadius,handleMirroring:a().handleMirroring,dispatch:k,dropdownShown:n})),r.createElement(ra.VF,{isVisible:(0,re.zp)(T,S,v,!1)},()=>r.createElement(oG.Vy,{key:"stack",onlyShowResizingRow:!1,onlyStacksSelected:!!T[i.ibQ.STACK_ITEM],recordingKey:"stackPanel"})),r.createElement(ra.VF,{isVisible:(0,re.GG)(T)},()=>r.createElement(oO,{key:"constraints",openFileKey:p?.key||null,dropdownShown:n,recordingKey:"constraintsPanel"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.MASK_ITEM]},()=>r.createElement(oK.B,{key:"mask",maskType:S.maskType,dispatch:k,dropdownShown:n,recordingKey:"maskPanel"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.GRIDS_ITEM]},()=>r.createElement(a9.tC,{key:"grids",selectionProperties:S})),r.createElement(ra.VF,{isVisible:T[i.ibQ.LAYER_ITEM]},()=>r.createElement(oM.s,{key:"layer",blendMode:S.blendMode,opacity:S.opacity,visible:S.visible,variableConsumptionInfo:S.variableConsumptionInfo,recordingKey:"layerPanel"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.TYPE_ITEM]},()=>r.createElement(a9.gc,{key:"type",selectionProperties:S})),r.createElement(ra.VF,{isVisible:T[i.ibQ.CANVAS_ITEM]},()=>r.createElement(oP.v,{key:"canvas-background",backgroundColor:S.backgroundColor,backgroundEnabled:S.backgroundEnabled,backgroundOpacity:S.backgroundOpacity,exportBackgroundDisabled:S.exportBackgroundDisabled,dispatch:k,dropdownShown:n,modalShown:d,pickerShown:E,colorFormat:t,library:l,openFile:p,recordingKey:"canvasBackgroundPanel",defaultColor:ri.rC,sceneGraphSelection:h,selectedStyleProperties:v,hasExports:!!S.exportSettings&&(0,rl._W)(S.exportSettings,[]).length>0})),r.createElement(ra.VF,{isVisible:T[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>r.createElement(oV.C,{key:"remove-group-fill-stroke"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.FILL_ITEM]},()=>r.createElement(a9.B8,{key:"fill",selectionProperties:S,variableScopes:(0,oB.og)(S)})),r.createElement(ra.VF,{isVisible:T[i.ibQ.STROKE_ITEM]},()=>r.createElement(oF.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:C,strokePanelMode:N,strokePanelTerminalPointCount:I,strokePaints:S.strokePaints,borderSharedWeight:S.borderSharedWeight,strokeWeight:S.strokeWeight,strokeAlign:S.strokeAlign,strokeCap:S.strokeCap,strokeJoin:S.strokeJoin,miterLimitAngle:S.miterLimitAngle,connectorLineStyle:S.connectorLineStyle,leftEndCap:S.leftEndCap,rightEndCap:S.rightEndCap,maxStrokeWeight:S.maxStrokeWeight,dashPattern:S.dashPattern,dashCap:S.dashCap,terminalCap:S.terminalCap,arcRadius:S.arcRadius,arcSweep:S.arcSweep,numSelectedByType:S.numSelectedByType,dispatch:k,dropdownShown:n,modalShown:d,pickerShown:E,pickerInStyleCreationShown:u,stylePickerListLayout:P,colorFormat:t,defaultColor:ri.Em,inheritStyleKey:S.inheritFillStyleKeyForStroke||null,inheritStyleID:S.styleIdForStrokeFill||null,library:l,sceneGraphSelection:h,selectedStyleProperties:v,openFile:p,isPanelBodyCollapsedAtom:null})),r.createElement(ra.VF,{isVisible:(0,re.fI)(T,(0,re.NR)(T),b)},()=>r.createElement(oF.UA,{key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:b,dispatch:k,dropdownShown:n,sceneGraphSelection:h,pickerShown:E,stylePickerListLayout:P,colorFormat:t,defaultColor:ri.rC,library:l,openFile:p,isUI3:!1})),r.createElement(ra.VF,{isVisible:T[i.ibQ.EFFECTS_ITEM]},()=>r.createElement(a9.w5,{key:"effects",selectionProperties:S})),r.createElement(ra.VF,{isVisible:(0,re.ji)(T,w,h)},()=>r.createElement(oq,{key:"local-variables"})),r.createElement(ra.VF,{isVisible:(0,re.ww)(T,h)},()=>r.createElement(ov,{key:"local-styles",recordingKey:"local-styles",scrollContainer:f})),r.createElement(ra.VF,{isVisible:(0,re.P1)(T,p)},()=>r.createElement(oR.LI,{key:"export",recordingKey:"exportsPanel",openFile:p,singleNodeName:oR.LI.singleNodeNameFrom(S),numSelected:S.numSelected,exportSettings:S.exportSettings,sceneGraphSelection:h,isSelectionRenamable:oR.LI.isSelectionRenamable(Object.keys(h)),currentPage:(0,rs.Nf)(w),dispatch:k,dropdownShown:n,currentSelectedProperty:w.currentSelectedProperty,pickerShown:E,saveAsState:_,panelWidth:re.iP})),r.createElement(ra.VF,{isVisible:!(0,re.NR)(T)},()=>r.createElement(oU.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:a().pluginRelaunchData,localPlugins:c,publishedPlugins:g,allSavedPlugins:e.plugins,orgEntity:m,dispatch:k,openFileKey:p?.key||null,editorType:p?.editorType?(0,a4.wN)(p.editorType):null,numSelected:a().numSelected??0})),(0,s.kc)().jsx_debugging&&r.createElement(oD.A,null))}var o1=n(639800),o4=n(267136);function o2({allSavedPlugins:e,colorFormat:t,dropdownShown:n,getContextualSelectionProperties:a,library:l,localPlugins:c,modalShown:d,openFile:p,orgEntity:m,pickerInStyleCreationShown:u,pickerShown:E,publishedPlugins:g,saveAsState:_,sceneGraphSelection:h,scrollContainer:f,selectedStyleProperties:v,selectionPaints:b,selectionProperties:S,shownPanels:T,strokePanelMode:N,strokePanelTerminalPointCount:I,stylePickerListLayout:P,stylePickerShown:C}){let k=(0,o.wA)(),A=(0,y.md)(a6.b),w=(0,oB.qh)(S),O=(0,er.p8)("currentPage"),x=(0,er.p8)("currentSelectedProperty"),R=(0,re.Ws)(T,h);return r.createElement(rn.i,null,0===Object.keys(h).length&&r.createElement(oI.Mw,{panelName:oI.ON.DESIGN}),r.createElement(o4._i,{recordingKey:"toolbarView",shouldShowComponentPropertiesPanel:(0,re.tV)(T,S.stateGroupSelectionInfo),shouldShowInstancePanel:(0,re.M0)(T),shouldShowVectorOperationPanel:(0,re.jP)(S)}),r.createElement(ra.VF,{isVisible:(0,re.jP)(S)},()=>r.createElement(o$,{key:"vectorOperation",recordingKey:"vectorOperationPanel",numSelected:S.numSelected})),r.createElement(ra.VF,{isVisible:(0,re.tV)(T,S.stateGroupSelectionInfo)},()=>r.createElement(rc.BS,{key:"componentProperties",recordingKey:"propsPanel"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.COMPONENT_ITEM]},()=>r.createElement(oC.cu,{key:"component",recordingKey:"componentPanel"})),r.createElement(ra.VF,{isVisible:(0,re.M0)(T)},()=>r.createElement(oL._,{key:"instance",recordingKey:"instancePanel"})),r.createElement(ra.VF,{isVisible:(0,re.d6)(T)||T[i.ibQ.TRANSFORM_ITEM]},()=>r.createElement(oW.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:A,pickerShown:E,openFileKey:p?.key||null,canEditConstraints:(0,re.GG)(T),onlyShowXYInputsRow:A===a9.GR.DEFAULT_SIMPLIFIED||(a().areOnlyResponsiveSetsSelected??!1)})),r.createElement(ra.VF,{isVisible:(0,re.zp)(T,S,v,!0)},()=>r.createElement(oG.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:A===a9.GR.DEFAULT_SIMPLIFIED,onlyStacksSelected:!!T[i.ibQ.STACK_ITEM]})),r.createElement(a9.F$,{isVisible:T[i.ibQ.SCALE_ITEM]}),r.createElement(ox.Q,{selection:h,shownPanels:T,scaleShouldHideOtherPanels:(0,re.NR)(T)}),r.createElement(ra.VF,{isVisible:T[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oz.r,{key:"template"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oZ.$,{key:"templateProperties",recordingKey:"templatePropsPanel"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.VECTOR_ITEM]},()=>r.createElement(oW.Ss,{isUI3:!0,key:"vector-transform",recordingKey:"vectorTransformPanel",x:S.x,y:S.y,cornerRadius:S.cornerRadius,handleMirroring:S.handleMirroring,dispatch:k,dropdownShown:n})),r.createElement(ra.VF,{isVisible:T[i.ibQ.MASK_ITEM]},()=>r.createElement(oK.B,{key:"mask",recordingKey:"maskPanel",maskType:a().maskType,dispatch:k,dropdownShown:n})),r.createElement(ra.VF,{isVisible:T[i.ibQ.LAYER_ITEM]},()=>r.createElement(o1.X,{recordingKey:"appearancePanel"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.TYPE_ITEM]},()=>r.createElement(a9.gc,{key:"type",selectionProperties:S})),r.createElement(ra.VF,{isVisible:T[i.ibQ.CANVAS_ITEM]},()=>r.createElement(oP.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:S.backgroundColor,backgroundEnabled:S.backgroundEnabled,backgroundOpacity:S.backgroundOpacity,exportBackgroundDisabled:S.exportBackgroundDisabled,dispatch:k,dropdownShown:n,modalShown:d,pickerShown:E,colorFormat:t,library:l,openFile:p,defaultColor:ri.rC,sceneGraphSelection:h,selectedStyleProperties:v,hasExports:!!S.exportSettings&&(0,rl._W)(S.exportSettings,[]).length>0})),r.createElement(ra.VF,{isVisible:T[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>r.createElement(oV.C,{key:"remove-group-fill-stroke"})),r.createElement(ra.VF,{isVisible:T[i.ibQ.FILL_ITEM]},()=>r.createElement(a9.B8,{key:"fill",selectionProperties:S,variableScopes:w})),r.createElement(ra.VF,{isVisible:T[i.ibQ.STROKE_ITEM]},()=>r.createElement(oF.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:C,strokePanelMode:N,strokePanelTerminalPointCount:I,strokePaints:S.strokePaints,borderSharedWeight:S.borderSharedWeight,strokeWeight:S.strokeWeight,strokeAlign:S.strokeAlign,strokeCap:S.strokeCap,strokeJoin:S.strokeJoin,miterLimitAngle:S.miterLimitAngle,connectorLineStyle:S.connectorLineStyle,leftEndCap:S.leftEndCap,rightEndCap:S.rightEndCap,maxStrokeWeight:S.maxStrokeWeight,dashPattern:S.dashPattern,dashCap:S.dashCap,terminalCap:S.terminalCap,arcRadius:S.arcRadius,arcSweep:S.arcSweep,numSelectedByType:S.numSelectedByType,dispatch:k,dropdownShown:n,modalShown:d,pickerShown:E,pickerInStyleCreationShown:u,stylePickerListLayout:P,colorFormat:t,defaultColor:ri.Em,inheritStyleKey:S.inheritFillStyleKeyForStroke||null,inheritStyleID:S.styleIdForStrokeFill||null,library:l,sceneGraphSelection:h,selectedStyleProperties:v,openFile:p,isPanelBodyCollapsedAtom:null})),r.createElement(ra.VF,{isVisible:T[i.ibQ.EFFECTS_ITEM]},()=>r.createElement(a9.w5,{key:"effects",selectionProperties:S})),r.createElement(ra.VF,{isVisible:(0,re.fI)(T,(0,re.NR)(T),b)},()=>r.createElement(oF.UA,{isUI3:!0,key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:b,dispatch:k,dropdownShown:n,sceneGraphSelection:h,pickerShown:E,stylePickerListLayout:P,colorFormat:t,defaultColor:ri.rC,library:l,openFile:p})),r.createElement(ra.VF,{isVisible:R},()=>r.createElement(oq,{key:"local-variables"})),r.createElement(ra.VF,{isVisible:(0,re.ww)(T,h)},()=>r.createElement(ov,{key:"local-styles",recordingKey:"local-styles",scrollContainer:f})),r.createElement(ra.VF,{isVisible:T[i.ibQ.GRIDS_ITEM]},()=>r.createElement(a9.tC,{key:"grids",selectionProperties:S})),r.createElement(ra.VF,{isVisible:(0,re.P1)(T,p)},()=>r.createElement(oR.LI,{key:"export",recordingKey:"exportsPanel",openFile:p,singleNodeName:oR.LI.singleNodeNameFrom(S),numSelected:S.numSelected,exportSettings:S.exportSettings,isSelectionRenamable:oR.LI.isSelectionRenamable(Object.keys(h)),sceneGraphSelection:h,currentPage:O,dispatch:k,dropdownShown:n,currentSelectedProperty:x,pickerShown:E,saveAsState:_,panelWidth:re.iP})),r.createElement(ra.VF,{isVisible:!(0,re.NR)(T)},()=>r.createElement(oU.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:a().pluginRelaunchData,localPlugins:c,publishedPlugins:g,allSavedPlugins:e.plugins,orgEntity:m,dispatch:k,openFileKey:p?.key||null,editorType:p?.editorType?(0,a4.wN)(p.editorType):null,numSelected:a().numSelected??0})),(0,s.kc)().jsx_debugging&&r.createElement(oD.A,null))}function o8(e){let t=(0,o.wA)(),n=(0,ew.GS)(),a=(0,eL.iZ)(),l=(0,re.Dj)(a),s=(0,eS.J2)((0,aJ.UK)().expandedFramePresetType);return(((0,rt.Im)(e.shownPanels)||Object.keys(e.shownPanels).every(t=>!e.shownPanels[parseInt(t)]))&&!window.figmaPerfTesting&&!(0,tz.Lg)()&&!(0,tz.nl)()&&(0,tJ.x1)("PropertiesPanel","Rendering design tab with no shownPropertiesPanels",{isEmpty:(0,rt.Im)(e.shownPanels),shouldRenderInspectTab:l}),e.shownPanels[i.ibQ.FRAME_PRESETS])?r.createElement(rn.i,null,r.createElement(ra.VF,{isVisible:!0},()=>r.createElement(rr.nl,{key:"frame-presets",recordingKey:"framePresetPanel",dispatch:t,expandedFramePresetType:s}))):e.shownPanels[i.ibQ.PENCIL_TOOL]?r.createElement(rn.i,null,r.createElement(ra.VF,{isVisible:!0},()=>r.createElement(ro.q,{key:"pencilToolPanel",recordingKey:"pencilToolPanel",id:"pencilToolPanel",openFile:e.openFile}))):n?r.createElement(o2,{...e}):r.createElement(o0,{...e})}var o5=n(268853),o3=n(248591),o7=n(463815);function o6({allSavedPlugins:e,colorFormat:t,dropdownShown:n,getContextualSelectionProperties:a,library:l,localPlugins:s,modalShown:c,openFile:d,orgEntity:p,pickerInStyleCreationShown:m,pickerShown:u,publishedPlugins:E,saveAsState:g,sceneGraphSelection:_,selectedStyleProperties:h,selectionPaints:f,selectionProperties:v,shownPanels:b,strokePanelMode:S,strokePanelTerminalPointCount:T,stylePickerListLayout:N,stylePickerShown:I}){let P=(0,o.wA)(),[C,k]=(0,y.fp)(a6.b),A=(0,er.s6)("currentPage","currentSelectedProperty");return r.createElement(rn.i,null,(0,re.d6)(b)&&r.createElement(oN.AV,{recordingKey:"alignPanel"}),r.createElement(ra.VF,{isVisible:!0},()=>r.createElement(oW.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:C,pickerShown:u,openFileKey:d?.key||null,canEditConstraints:!1,onlyShowXYInputsRow:!1})),r.createElement(a9.F$,{isVisible:b[i.ibQ.SCALE_ITEM]}),r.createElement(ra.VF,{isVisible:!(0,re.NR)(b)},()=>r.createElement(oL._,{key:"instance",recordingKey:"instancePanel"})),r.createElement(ra.VF,{isVisible:(0,re.GG)(b)},()=>r.createElement(oO,{key:"constraints",recordingKey:"constraintsPanel",openFileKey:d?.key||null,dropdownShown:n})),r.createElement(ra.VF,{isVisible:b[i.ibQ.LAYER_ITEM]},()=>r.createElement(oM.s,{key:"layer",recordingKey:"layerPanel",blendMode:v.blendMode,opacity:v.opacity,visible:v.visible,variableConsumptionInfo:v.variableConsumptionInfo})),C===a9.GR.DEFAULT_SIMPLIFIED&&r.createElement(o7.Y,{onExpand:()=>k(a9.GR.OVERRIDDEN_EXPANDED)}),C===a9.GR.OVERRIDDEN_EXPANDED&&r.createElement(r.Fragment,null,r.createElement(ox.Q,{selection:_,shownPanels:b,scaleShouldHideOtherPanels:(0,re.NR)(b)}),r.createElement(ra.VF,{isVisible:b[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oz.r,{key:"template"})),r.createElement(ra.VF,{isVisible:b[i.ibQ.COMPONENT_ITEM]},()=>r.createElement(oC.cu,{key:"component",recordingKey:"componentPanel"})),r.createElement(ra.VF,{isVisible:b[i.ibQ.VECTOR_ITEM]},()=>r.createElement(oW.Ss,{key:"vector-transform",recordingKey:"vectorTransformPanel",x:v.x,y:v.y,cornerRadius:v.cornerRadius,handleMirroring:v.handleMirroring,dispatch:P,dropdownShown:n,isUI3:!1})),r.createElement(ra.VF,{isVisible:(0,re.zp)(b,v,h,!1)},()=>r.createElement(oG.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:!1,onlyStacksSelected:!!b[i.ibQ.STACK_ITEM]})),r.createElement(ra.VF,{isVisible:b[i.ibQ.MASK_ITEM]},()=>r.createElement(oK.B,{key:"mask",recordingKey:"maskPanel",maskType:a().maskType,dispatch:P,dropdownShown:n})),r.createElement(ra.VF,{isVisible:b[i.ibQ.GRIDS_ITEM]},()=>r.createElement(a9.tC,{key:"grids",selectionProperties:v})),r.createElement(ra.VF,{isVisible:b[i.ibQ.TYPE_ITEM]},()=>r.createElement(a9.gc,{key:"type",selectionProperties:v})),r.createElement(ra.VF,{isVisible:b[i.ibQ.CANVAS_ITEM]},()=>r.createElement(oP.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:v.backgroundColor,backgroundEnabled:v.backgroundEnabled,backgroundOpacity:v.backgroundOpacity,exportBackgroundDisabled:v.exportBackgroundDisabled,dispatch:P,dropdownShown:n,modalShown:c,pickerShown:u,colorFormat:t,library:l,openFile:d,defaultColor:ri.rC,sceneGraphSelection:_,selectedStyleProperties:h,hasExports:!!v.exportSettings&&(0,rl._W)(v.exportSettings,[]).length>0})),r.createElement(ra.VF,{isVisible:b[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>r.createElement(oV.C,{key:"remove-group-fill-stroke"})),r.createElement(ra.VF,{isVisible:b[i.ibQ.FILL_ITEM]},()=>r.createElement(a9.B8,{key:"fill",selectionProperties:v,variableScopes:(0,oB.og)(v)})),r.createElement(ra.VF,{isVisible:b[i.ibQ.STROKE_ITEM]},()=>r.createElement(oF.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:I,strokePanelMode:S,strokePanelTerminalPointCount:T,strokePaints:v.strokePaints,borderSharedWeight:v.borderSharedWeight,strokeWeight:v.strokeWeight,strokeAlign:v.strokeAlign,strokeCap:v.strokeCap,strokeJoin:v.strokeJoin,miterLimitAngle:v.miterLimitAngle,connectorLineStyle:v.connectorLineStyle,leftEndCap:v.leftEndCap,rightEndCap:v.rightEndCap,maxStrokeWeight:v.maxStrokeWeight,dashPattern:v.dashPattern,dashCap:v.dashCap,terminalCap:v.terminalCap,arcRadius:v.arcRadius,arcSweep:v.arcSweep,numSelectedByType:v.numSelectedByType,dispatch:P,dropdownShown:n,modalShown:c,pickerShown:u,pickerInStyleCreationShown:m,stylePickerListLayout:N,colorFormat:t,defaultColor:ri.Em,inheritStyleKey:v.inheritFillStyleKeyForStroke||null,inheritStyleID:v.styleIdForStrokeFill||null,library:l,sceneGraphSelection:_,selectedStyleProperties:h,openFile:d,isPanelBodyCollapsedAtom:null})),r.createElement(ra.VF,{isVisible:!0},()=>r.createElement(oF.UA,{key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:f,dispatch:P,dropdownShown:n,sceneGraphSelection:_,pickerShown:u,stylePickerListLayout:N,colorFormat:t,defaultColor:ri.rC,library:l,openFile:d,isUI3:!1})),r.createElement(ra.VF,{isVisible:b[i.ibQ.EFFECTS_ITEM]},()=>r.createElement(a9.w5,{key:"effects",selectionProperties:v})),r.createElement(ra.VF,{isVisible:!(0,re.NR)(b)},()=>r.createElement(oU.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:a().pluginRelaunchData,localPlugins:s,publishedPlugins:E,allSavedPlugins:e.plugins,orgEntity:p,dispatch:P,openFileKey:d?.key||null,editorType:d?.editorType?(0,a4.wN)(d.editorType):null,numSelected:a().numSelected??0}))),r.createElement(ra.VF,{isVisible:(0,re.P1)(b,d)},()=>r.createElement(oR.LI,{key:"export",recordingKey:"exportsPanel",openFile:d,singleNodeName:oR.LI.singleNodeNameFrom(v),numSelected:v.numSelected,exportSettings:v.exportSettings,sceneGraphSelection:_,currentPage:A.currentPage,isSelectionRenamable:oR.LI.isSelectionRenamable(Object.keys(_)),dispatch:P,dropdownShown:n,currentSelectedProperty:A.currentSelectedProperty,pickerShown:u,saveAsState:g,panelWidth:re.iP})),r.createElement(ra.VF,{isVisible:!(0,re.NR)(b)},()=>r.createElement(oU.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:a().pluginRelaunchData,localPlugins:s,publishedPlugins:E,allSavedPlugins:e.plugins,orgEntity:p,dispatch:P,openFileKey:d?.key||null,editorType:d?.editorType?(0,a4.wN)(d.editorType):null,numSelected:a().numSelected??0})))}function o9({allSavedPlugins:e,colorFormat:t,dropdownShown:n,getContextualSelectionProperties:a,library:l,localPlugins:s,modalShown:c,openFile:d,orgEntity:p,pickerInStyleCreationShown:m,pickerShown:u,publishedPlugins:E,saveAsState:g,sceneGraphSelection:_,selectedStyleProperties:h,selectionPaints:f,selectionProperties:v,shownPanels:b,strokePanelMode:S,strokePanelTerminalPointCount:T,stylePickerListLayout:N,stylePickerShown:I}){let P=(0,o.wA)(),[C,k]=(0,y.fp)(a6.b),A=(0,er.s6)("currentPage","currentSelectedProperty");return r.createElement(rn.i,null,0===Object.keys(_).length&&r.createElement(oI.Mw,{panelName:oI.ON.DESIGN}),r.createElement(o4._i,{recordingKey:"toolbarView",shouldShowComponentPropertiesPanel:(0,re.tV)(b,v.stateGroupSelectionInfo),shouldShowInstancePanel:(0,re.M0)(b)}),r.createElement(ra.VF,{isVisible:!(0,re.NR)(b)},()=>r.createElement(oL._,{key:"instance",recordingKey:"instancePanel"})),r.createElement(ra.VF,{isVisible:!0},()=>r.createElement(oW.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:C,pickerShown:u,openFileKey:d?.key||null,canEditConstraints:(0,re.GG)(b),onlyShowXYInputsRow:C===a9.GR.DEFAULT_SIMPLIFIED||(a().areOnlyResponsiveSetsSelected??!1)})),r.createElement(ra.VF,{isVisible:(0,re.zp)(b,v,h,!0)},()=>r.createElement(oG.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:C===a9.GR.DEFAULT_SIMPLIFIED,onlyStacksSelected:!!b[i.ibQ.STACK_ITEM]})),r.createElement(a9.F$,{isVisible:b[i.ibQ.SCALE_ITEM]}),C===a9.GR.DEFAULT_SIMPLIFIED&&r.createElement(o7.Y,{onExpand:()=>k(a9.GR.OVERRIDDEN_EXPANDED)}),C===a9.GR.OVERRIDDEN_EXPANDED&&r.createElement(r.Fragment,null,r.createElement(ra.VF,{isVisible:b[i.ibQ.LAYER_ITEM]},()=>r.createElement(o1.X,{recordingKey:"appearancePanel"})),r.createElement(ox.Q,{selection:_,shownPanels:b,scaleShouldHideOtherPanels:(0,re.NR)(b)}),r.createElement(ra.VF,{isVisible:b[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oz.r,{key:"template"})),r.createElement(ra.VF,{isVisible:b[i.ibQ.COMPONENT_ITEM]},()=>r.createElement(oC.cu,{key:"component",recordingKey:"componentPanel"})),r.createElement(ra.VF,{isVisible:b[i.ibQ.VECTOR_ITEM]},()=>r.createElement(oW.Ss,{isUI3:!0,key:"vector-transform",recordingKey:"vectorTransformPanel",x:v.x,y:v.y,cornerRadius:v.cornerRadius,handleMirroring:v.handleMirroring,dispatch:P,dropdownShown:n})),r.createElement(ra.VF,{isVisible:b[i.ibQ.MASK_ITEM]},()=>r.createElement(oK.B,{key:"mask",recordingKey:"maskPanel",maskType:a().maskType,dispatch:P,dropdownShown:n})),r.createElement(ra.VF,{isVisible:b[i.ibQ.TYPE_ITEM]},()=>r.createElement(a9.gc,{key:"type",selectionProperties:v})),r.createElement(ra.VF,{isVisible:b[i.ibQ.CANVAS_ITEM]},()=>r.createElement(oP.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:v.backgroundColor,backgroundEnabled:v.backgroundEnabled,backgroundOpacity:v.backgroundOpacity,exportBackgroundDisabled:v.exportBackgroundDisabled,dispatch:P,dropdownShown:n,modalShown:c,pickerShown:u,colorFormat:t,library:l,openFile:d,defaultColor:ri.rC,sceneGraphSelection:_,selectedStyleProperties:h,hasExports:!!v.exportSettings&&(0,rl._W)(v.exportSettings,[]).length>0})),r.createElement(ra.VF,{isVisible:b[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>r.createElement(oV.C,{key:"remove-group-fill-stroke"})),r.createElement(ra.VF,{isVisible:b[i.ibQ.FILL_ITEM]},()=>r.createElement(a9.B8,{key:"fill",selectionProperties:v,variableScopes:(0,oB.og)(v)})),r.createElement(ra.VF,{isVisible:b[i.ibQ.STROKE_ITEM]},()=>r.createElement(oF.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:I,strokePanelMode:S,strokePanelTerminalPointCount:T,strokePaints:v.strokePaints,borderSharedWeight:v.borderSharedWeight,strokeWeight:v.strokeWeight,strokeAlign:v.strokeAlign,strokeCap:v.strokeCap,strokeJoin:v.strokeJoin,miterLimitAngle:v.miterLimitAngle,connectorLineStyle:v.connectorLineStyle,leftEndCap:v.leftEndCap,rightEndCap:v.rightEndCap,maxStrokeWeight:v.maxStrokeWeight,dashPattern:v.dashPattern,dashCap:v.dashCap,terminalCap:v.terminalCap,arcRadius:v.arcRadius,arcSweep:v.arcSweep,numSelectedByType:v.numSelectedByType,dispatch:P,dropdownShown:n,modalShown:c,pickerShown:u,pickerInStyleCreationShown:m,stylePickerListLayout:N,colorFormat:t,defaultColor:ri.Em,inheritStyleKey:v.inheritFillStyleKeyForStroke||null,inheritStyleID:v.styleIdForStrokeFill||null,library:l,sceneGraphSelection:_,selectedStyleProperties:h,openFile:d,isPanelBodyCollapsedAtom:null})),r.createElement(ra.VF,{isVisible:b[i.ibQ.EFFECTS_ITEM]},()=>r.createElement(a9.w5,{key:"effects",selectionProperties:v})),r.createElement(ra.VF,{isVisible:(0,re.fI)(b,(0,re.NR)(b),f)},()=>r.createElement(oF.UA,{isUI3:!0,key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:f,dispatch:P,dropdownShown:n,sceneGraphSelection:_,pickerShown:u,stylePickerListLayout:N,colorFormat:t,defaultColor:ri.rC,library:l,openFile:d})),r.createElement(ra.VF,{isVisible:b[i.ibQ.GRIDS_ITEM]},()=>r.createElement(a9.tC,{key:"grids",selectionProperties:v})),r.createElement(ra.VF,{isVisible:(0,re.P1)(b,d)},()=>r.createElement(oR.LI,{key:"export",recordingKey:"exportsPanel",openFile:d,singleNodeName:oR.LI.singleNodeNameFrom(v),isSelectionRenamable:oR.LI.isSelectionRenamable(Object.keys(_)),numSelected:v.numSelected,exportSettings:v.exportSettings,sceneGraphSelection:_,currentPage:A.currentPage,dispatch:P,dropdownShown:n,currentSelectedProperty:A.currentSelectedProperty,pickerShown:u,saveAsState:g,panelWidth:re.iP})),r.createElement(ra.VF,{isVisible:!(0,re.NR)(b)},()=>r.createElement(oU.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:a().pluginRelaunchData,localPlugins:s,publishedPlugins:E,allSavedPlugins:e.plugins,orgEntity:p,dispatch:P,openFileKey:d?.key||null,editorType:d?.editorType?(0,a4.wN)(d.editorType):null,numSelected:a().numSelected??0}))),r.createElement(ra.VF,{isVisible:!(0,re.NR)(b)},()=>r.createElement(oU.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:a().pluginRelaunchData,localPlugins:s,publishedPlugins:E,allSavedPlugins:e.plugins,orgEntity:p,dispatch:P,openFileKey:d?.key||null,editorType:d?.editorType?(0,a4.wN)(d.editorType):null,numSelected:a().numSelected??0})))}function le(e){let t=(0,ew.GS)();if((0,rt.Im)(e.shownPanels)||Object.keys(e.shownPanels).every(t=>!e.shownPanels[parseInt(t)])){let e=Error("Rendering simplified design tab with no shownPropertiesPanels");(0,o3.$D)(o5.e.EDITOR_USABILITY,e)}return t?r.createElement(o9,{...e}):r.createElement(o6,{...e})}function lt({scrollContainer:e,...t}){let n=(0,y.md)(a6.b),a=(0,a7.Yo)(),o=()=>(0,re.RB)(t.selectedStyleProperties)?t.selectedStyleProperties:t.selectionProperties;return n===a9.GR.DEFAULT_EXPANDED?r.createElement(o8,{...t,getContextualSelectionProperties:o,orgEntity:a,scrollContainer:e}):r.createElement(le,{...t,getContextualSelectionProperties:o,orgEntity:a})}var ln=n(550114);function la({dropdownShown:e,pickerShown:t,saveAsState:n,sceneGraphSelection:a,selectedStyleProperties:l,selectionProperties:i}){let s=(0,o.wA)(),c=(0,eo.q5)(),p=(0,er.p8)("currentPage"),m=(0,er.p8)("isReadOnly"),u=(0,er.p8)("currentSelectedProperty"),E=(0,ln.ks)(),g=m&&!E,y=(0,re.RB)(l)?l:i;return r.createElement(ra.VF,{isVisible:!0},()=>r.createElement(oR.LI,{key:"export",title:g?(0,d.t)("fullscreen.properties_panel.export"):(0,d.t)("fullscreen.properties_panel.presets"),standalone:!0,openFile:c,singleNodeName:oR.LI.singleNodeNameFrom(y),isSelectionRenamable:oR.LI.isSelectionRenamable(Object.keys(a)),numSelected:y.numSelected,exportSettings:y.exportSettings,sceneGraphSelection:a,currentPage:p,dispatch:s,dropdownShown:e,currentSelectedProperty:u,pickerShown:t,recordingKey:"exportsPanel",saveAsState:n,panelWidth:re.iP}))}var lr=n(910764),lo=n(739664),ll=n(340335),li=n(911605);function ls({selectionProperties:e,scrollContainer:t}){let n=(0,eo.q5)(),a=(0,er.KH)(),o=!e.prototypeStartingPointsInfo||e.prototypeStartingPointsInfo?.length>0,l=0===Object.keys(a).length,i=n?.canEdit,s=r.createElement(ra.VF,{isVisible:l&&!i&&o},()=>r.createElement(li.A,{viewOnly:!0})),c=r.createElement(ra.VF,{isVisible:l},()=>r.createElement(ov,{key:"code-local-styles",recordingKey:"code-local-styles",scrollContainer:t}));return r.createElement(et.fu,{name:lo.e0.CODE_PANEL},r.createElement(rn.i,null,r.createElement(oI.Mw,{panelName:oI.ON.INSPECT}),r.createElement(ll.U,{key:"inspection-properties-panel",recordingKey:"inspectionPanel",flowPanel:s,localStylesPanel:c})))}var lc=n(326331),ld=n(977750),lp=n(189904),lm=n(523047),lu=n(477535),lE=n(786763),lg=n(492841),ly=n(888943),l_=n(467950),lh=n(527738),lf=n(266489),lv=n(951039),lb=n(716034),lS=n(974265),lT=n(299918);let lN=(0,lb.eU)({}),lI=(0,y.Iz)(e=>(0,lb.eU)(t=>t(lN)[e]??{status:"idle"},(t,n,a)=>{n(lN,t=>({...t,[e]:a}))})),lP=(0,lb.eU)(null),lC=(0,y.E3)("living_designs_settings",{evaluationRuns:1,evalBackoffDelay:1e4});function lk(e){let t=[],{messages:n}=(0,lv.u6)(e);for(let a of(n?.forEach(n=>{t.push({...n,nodeId:e.guid})}),e.childrenNodes))t=[...t,...lk(a)];return t}let lA={};async function lw(e,t,n){let a=()=>lS.Ay.shared.generateLivingDesigns({chat:e,...t?{model:t}:{}},{...(0,lT.Ay)()}),r=void 0!==n?await (0,lv.ZB)(a,3,n):await a(),o={message:"",code:""},l=r.getReader();for(;;){let{done:e,value:t}=await l.read();if(t)for(let e of Object.keys(t))o[e]+=t[e];if(e)break}return o}async function lO(e,t={}){let n={...lA,...t},a=(0,lv.Wq)(e);if("loading"===y.zl.get(lI(a.guid)).status||!a)return{status:"idle"};n.openPreview&&n.openPreview();let r=(0,lv.u6)(a),o=lk(a);y.zl.set(lI(a.guid),{status:"loading"});try{let{html:e,styles:t}=await (0,lv.li)(a,o.map(e=>e.nodeId)),l=await (0,lv.vd)(a),i=function(e,t,n,a,r){let o=[],l=[e];return t&&l.push(`<style>${t}</style>`),o.push({type:"text",text:l.join("\n")}),n&&o.push({type:"image",image:n,mimeType:"image/jpeg"}),o.push({type:"text",text:`Annotations:
${a.map(e=>{var t;return t=e.nodeId,`<annotation nodeId="${t}">${e.content}</annotation>`}).join("\n")}`}),[...r??[],{role:"user",content:o}]}(e,t,l,o,r?.generation?.chatHistory),s=y.zl.get(lP),{code:c}=await lw(i,s,n.initialBackoffDelay);return(0,lv.Ww)(a,n=>({...n,generation:{id:(0,tW.g)(),html:e,code:c??"",styles:t,nodesWithProps:[],chatHistory:[...i,{role:"assistant",content:c??""}]}})),ac.Y5.triggerAction("commit"),y.zl.set(lI(a.guid),{status:"idle"}),{status:"idle",nodesWithProps:[],code:c,html:e,styles:t}}catch(e){return console.error(e),y.zl.set(lI(a.guid),{status:"idle",errorMessage:e.message}),{status:"idle",errorMessage:e.message}}}var lx=n(163638),lR=n(678648),lL=n(907662),lD=n(288777);async function lM(e,t){let n=await (0,lv.vd)(e),a=await (0,lv.vd)(t),r=(await lS.Ay.design.getTextImageEmbeds({model:"clip-huge-shared",input:{images:[n,a]}})).encoded_images;if(!r||2!==r.length)throw Error("Expected two embedding vectors in the response");let o=r[0],l=r[1];if(!o||!l)throw Error("Embedding vectors must not be undefined");return(0,lD.Lb)(o,l)}async function lK(e,t){e(p.F.clearAll());let n=E.UN().getCurrentPage()?.childrenNodes.filter(e=>"SECTION"===e.type&&1===e.childCount);if(!n||0===n.length){e(p.F.enqueue({message:(0,d.t)("living_designs.eval.error"),error:!0}));return}let a=rE.l7.ai(lv.p1,()=>{let e=(0,E.UN)().createNode("CANVAS");return e.name=`Eval - ${new Date().toLocaleString()}`,e});await (0,E.UN)().setCurrentPageAsync(a.guid);let r=t.evaluationRuns,o=r*n.length;e(p.F.enqueue({type:"living-designs-evals",message:(0,d.t)("living_designs.eval.progress",{completed:0,total:o}),timeoutOverride:1/0}));try{let a=0,l=n.flatMap((e,t)=>Array.from({length:r}).map((n,a)=>{var o;let l=t*r+a;return o=(e.absoluteRenderBounds.w+(l>0?40:0))*l,rE.l7.ai(lv.p1,()=>{let t=e.clone(),n=(0,E.UN)().get(t);n.relativeTransform={...n.relativeTransform,m02:o};let a=e.clone(),r=(0,E.UN)().get(a);r.relativeTransform={...r.relativeTransform,m02:o},r.name="Output: "+e.name,r.y=e.y+e.size.y+40,r.size={x:r.size.x,y:3*r.size.y},r.childrenNodes[0].removeSelfAndChildren();let l=n.childrenNodes[0];if(!l)throw Error("Failed to clone node");return{nodeToEval:l,inputSection:n,outputSection:r}})})),i=(0,lx.D)();i.viewport.scrollAndZoomIntoView(l.flatMap(({inputSection:e,outputSection:t})=>[e,t].map(e=>i.getNodeById(e.guid)).filter(e=>null!==e)));let s=l.map(async({nodeToEval:n,outputSection:r})=>{let l=await lF(n,r,t);return a++,e(p.F.enqueue({type:"living-designs-evals",message:(0,d.t)("living_designs.eval.progress",{completed:a,total:o}),timeoutOverride:1/0})),l}),c=(await Promise.all(s)).map(({metrics:e})=>e),m=function(e){let t=e.reduce((e,t)=>e+t.imageToImageSimilarity,0)/e.length,n=e.length,a=e.filter(e=>e.error).length;return{avgImageToImageSimilarity:t,numTestCases:n,numFailures:a,failureRate:a/n}}(c),u=l[0]?.inputSection;if(!u)throw Error("No sections were prepared for evaluation.");rE.l7.ai(lv.p1,()=>(function(e,t){let n=e.clone(),a=(0,E.UN)().get(n);a.childrenNodes[0].removeSelfAndChildren(),a.relativeTransform={...a.relativeTransform,m02:e.absoluteRenderBounds.w},a.name="Aggregate Metrics",a.x=e.x-e.size.x-40,a.y=e.y;let r=(0,E.UN)().createNode("TEXT");r.characters=`Aggregate Metrics: ${JSON.stringify(t,(e,t)=>"number"!=typeof t||Number.isInteger(t)?t:t.toFixed(3),2)}`,r.x=0,r.size.x=a.size.x,r.y=10,a.appendChild(r),r.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],r.fontSize=40})(u,m)),e(p.F.enqueue({type:"living-designs-evals",message:(0,d.t)("living_designs.eval.finished")}))}catch(t){a.removeSelfAndChildren(),e(p.F.enqueue({type:"living-designs-evals",message:(0,d.t)("living_designs.eval.error"),error:!0}))}}async function lF(e,t,n){!function e(t){for(let n of t.childrenNodes)e(n);t.annotations.length>0&&((0,lv.Ww)(t,{...(0,lv.u6)(t),messages:t.annotations.map(e=>({id:(0,tW.g)(),createdAt:Date.now(),content:e.label}))}),t.annotations.splice(0,t.annotations.length))}(e);let a=e.size,r={x:t.size.x/2-a.x/2,y:40},{html:o,styles:l}=await (0,lv.li)(e,lk(e).map(e=>e.nodeId)),i=await (0,lR.Is)(o),s=await (0,lR.zG)(i),c=await (0,lR._5)(o);lV({name:"HTML",imageSet:(await (0,lL.l)({code:s,width:e.size.x??0,height:e.size.y??0,props:{},styles:`${l}
${c}`})).imageSet,sources:[{code:o,language:"TYPESCRIPT"},{code:l,language:"CSS"}],position:r,size:a,outputSection:t});let{code:p,nodesWithProps:m,errorMessage:u}=await lO(e,{initialBackoffDelay:n.evalBackoffDelay});if(!p||!m)return rE.l7.ai(lv.p1,()=>{let e=(0,E.UN)().createNode("FRAME");e.size=a,e.x=r.x,e.y=r.y,t.appendChild(e);let n=(0,E.UN)().createNode("TEXT");n.characters=u??(0,d.t)("living_designs.eval.error"),n.size=e.size,n.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],e.fills=[{type:"SOLID",color:{r:1,g:0,b:0,a:1}}],e.appendChild(n)}),{outputSection:t,metrics:{imageToImageSimilarity:0,error:!0}};let g=await (0,lR.Is)(p),y=await (0,lR.zG)(g),_=await (0,lR._5)(p),h=await (0,lL.l)({code:y,width:e.size.x??0,height:e.size.y??0,props:{},styles:`${l}
${_}`}),f=await lV({name:"Generated",imageSet:h.imageSet,sources:[{code:p,language:"TYPESCRIPT"},{code:l,language:"CSS"}],position:r,size:a,outputSection:t}),v=await lM(e,f);return rE.l7.ai(lv.p1,()=>{let e=(0,E.UN)().createNode("TEXT");e.characters=`Image-Image Similarity: ${v.toFixed(2)}`,e.x=0,e.size.x=f.size.x,e.y=10,t.appendChild(e),e.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],e.fontSize=40}),{outputSection:t,metrics:{imageToImageSimilarity:v,error:!1}}}async function lV({name:e,imageSet:t,sources:n,position:a,size:r,outputSection:o}){let l=[],i=20,s=rE.l7.ai(lv.p1,()=>{let s=(0,E.UN)().createNode("FRAME");s.size=r,s.x=i,s.y=a.y,s.insertImageInFillPaint(t),s.name=e,i+=r.x+40;let c=(o.size.x-i)/n.length-40;for(let t of n){let n=(0,E.UN)().createNode("FRAME");n.name=e+" Code",n.size={x:c,y:r.y},n.x=i,n.y=a.y,n.frameMaskDisabled=!1,o.appendChild(n);let d=(0,E.UN)().createNode("CODE_BLOCK");l.push([d.guid,t]),n.appendChild(d),o.appendChild(s),i+=c+40}return s}),c=(0,lx.D)();for(let[e,t]of l){await c.loadFontAsync({family:"Source Code Pro",style:"Medium"});let n=c.getNodeById(e);n.code=t.code,n.codeLanguage=t.language}return a.y+=r.y+40,s}var lU=n(424517),lB=(n(940319),n(120289)),lG=n(750380),lz=n(754225),lW=n(618120),lH=n(316852),lY=(n(165555),n(343006));let l$="LivingDesignsModal",lX=(0,lG.Ju)(function({initialSize:e}){(0,o.wA)();let[t,n]=(0,r.useState)(0),[a,l,i]=lU.t.useTabs({preview:!0,code:!0,debug:!0});return null},l$),lj={x:400,y:400},lQ={x:260,y:80},lJ=r.createContext(void 0),lq=()=>{let e=r.useContext(lJ);if(!e)throw Error("usePreviewContext must be used within a PreviewContext.Provider");return e};var lZ=(e=>(e.None="none",e.Generating="generating",e.Bundling="bundling",e.Ready="ready",e.Error="error",e))(lZ||{});function l0({disablePointerEvents:e,size:t}){let n=(0,tY.VW)(),a=(0,lv.L4)(),o=(0,lv.Jp)(),l=(0,rg.PD)(o),i=n?.guid?o:l,[s,c]=(0,y.fp)(lI(a?.guid||"")),[p,m]=(0,r.useState)(null),[u,E]=(0,r.useState)(""),{tabPanelPropsMap:g}=lq();(0,r.useEffect)(()=>{let e=i?.generation;if(!e||"idle"!==s.status){m(null),E("");return}!async function(){let t=Promise.all([(0,lB.b)(e.code),(0,lB.b)(e.styles)]),[n,a]=await t,r=await (0,lR.Is)(n),o=await (0,lR.zG)(r),l=await (0,lR._5)(o);m(o),E(`${a}
${l}`)}()},[i?.generation,s]);let _="idle"===s.status&&i?.generation?.code?p?"ready":"bundling":"loading"===s.status?"generating":"none";return r.createElement("div",{className:W.cx.wFull.hFull.relative.$},r.createElement(lU.t.TabPanel,{...g.preview},r.createElement("div",{className:W.cx.absolute.top0.right0.bottom0.left0.$},"none"===_&&r.createElement("div",{className:W.cx.flex.hFull.wFull.itemsCenter.justifyCenter.$},(0,d.t)("living_designs.preview.no_design")),"generating"===_&&r.createElement("div",{className:W.cx.flex.hFull.wFull.itemsCenter.justifyCenter.flexColumn.$},r.createElement("div",null,(0,d.t)("living_designs.preview.generating")),r.createElement(tx.k,null)),"bundling"===_&&r.createElement("div",{className:W.cx.flex.hFull.wFull.itemsCenter.justifyCenter.flexColumn.$},r.createElement("div",null,(0,d.t)("living_designs.preview.bundling")),r.createElement(tx.k,null)),"ready"===_&&r.createElement(lY.eu,{disablePointerEvents:e,code:p,props:{},styles:u,size:{x:t.x,y:t.y},withReset:!0,onError:e=>c({status:"idle",errorMessage:e.message}),scaleLinearly:!0}),"idle"===s.status&&s.errorMessage&&r.createElement("div",{className:W.cx.absolute.left0.right0.bottom0.h24.flex.justifyBetween.itemsCenter.bt1.bSolid.colorBorder.p12.colorBgDanger.colorTextOndanger.$},(0,d.t)("living_designs.preview.error",{error:s.errorMessage||"Unknown"})))),r.createElement(lU.t.TabPanel,{...g.code},r.createElement("textarea",{readOnly:!0,className:W.cx.absolute.top0.right0.bottom0.left0.$,value:i?.generation?.code||"No code available"})),r.createElement(lU.t.TabPanel,{...g.debug},r.createElement("div",{className:W.cx.absolute.top0.right0.bottom0.left0.overflowYScroll.$},r.createElement(lz.p,{data:i?.generation}))))}var l1=n(464132),l4=n(289298);function l2(e,t){return t.map(t=>({displayText:t,callback(){y.zl.set(lP,{provider:e,modelId:t})}}))}let l8=[{displayText:"Anthropic",children:l2("anthropic",["claude-3-5-sonnet-20240620","claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-5-sonnet-20241022","claude-3-haiku-20240307"])},{displayText:"OpenAI",children:l2("openai",["ft:gpt-4o-2024-08-06:figma-development::A95wrEFE:ckpt-step-732","gpt-3.5-turbo","gpt-3.5-turbo-0301","gpt-3.5-turbo-0613","gpt-3.5-turbo-1106","gpt-3.5-turbo-0125","gpt-3.5-turbo-16k","gpt-3.5-turbo-16k-0613","gpt-4","gpt-4-0314","gpt-4-0613","gpt-4-1106-preview","gpt-4-vision-preview","gpt-4-turbo-2024-04-09","gpt-4o-2024-05-13","gpt-4o-2024-08-06","gpt-4o-mini-2024-07-18","o1-preview-2024-09-12","o1-mini-2024-09-12"])}];function l5(){let{toggleDropdown:e,dropdownTargetRef:t,Dropdown:n,isDropdownShown:a}=(0,lh.B)(),o=(0,y.md)(lP);return r.createElement(r.Fragment,null,a&&r.createElement(n,{items:l8,showPoint:!0,lean:"left"}),r.createElement("div",{ref:t},r.createElement(nb.E,{className:W.cx.wFull.flex.alignCenter.justifyBetween.cursorPointer.b1.colorBorder.bRadius4.$,onClick:e},r.createElement("span",{className:W.cx.p4.$},null==o?"Pick a model":o.modelId),r.createElement(rD.U,{svg:l4.A},r.createElement(lc.r,null)))))}function l3(){let e=(0,lE.VW)(),t=(0,lv.L4)(),n=(0,lv.Vq)(),[a,l]=r.useState(""),i=(0,o.wA)(),s=(0,y.md)(lI(t?.guid||""));if(!e||!n)return r.createElement(l9,null);let c=()=>{a.length&&(l(""),(0,lv.Ww)(e,e=>{let t=Date.now();return{...e,messages:[...e.messages||[],{id:(0,tW.g)(),createdAt:t,content:a}]}}),ac.Y5.triggerAction("commit"),lO(e,{openPreview:p}))},p=()=>{let e={x:Math.max(t?.size.x||lj.x,lQ.x),y:Math.max(t?.size.y||lj.y,lQ.y)};i((0,lg.ES)({type:l$})),i((0,lg.to)({type:lX,data:{initialSize:e}}))};return r.createElement(r.Fragment,null,r.createElement(rw.Zk,null,r.createElement(lf.r,{titleTx:r.createElement("span",null,(0,d.t)("living_designs.properties_panel.title")),icon:r.createElement(ld.O,{onClick:p})}),r.createElement("div",{className:W.cx.flex.flexColumn.gap12.$},r.createElement("div",{className:W.cx.flex.flexColumn.gap8.$},!!n.messages?.length&&r.createElement("div",{className:W.cx.flex.flexColumn.$},n.messages.map((e,t)=>r.createElement(l7,{key:e.id,message:e,artwork:0===t?r.createElement(lp.N,null):r.createElement("div",{className:W.cx.w16.h16.flex.justifyCenter.$},r.createElement("span",{className:W.cx.textBodyMedium.colorTextSecondary.$},(0,d.t)("living_designs.properties_panel.interactions.version_number",{number:t}))),variant:0===t?"primary":"secondary"}))),r.createElement(oY.Ad,{label:void 0,input:r.createElement("div",{className:W.cx.flex.gap8.$},r.createElement(l6,{value:a,placeholder:(0,d.t)("living_designs.properties_panel.description_input.placeholder"),handleChange:l,handleSubmit:c}),r.createElement(am.$n,{onClick:c,disabled:!a.length||"loading"===s.status,"aria-label":(0,d.t)("living_designs.properties_panel.interactions.add_button.label")},"loading"===s.status?r.createElement(tx.k,null):r.createElement(lm.W,null))),appendedClassName:"living_designs_panel--textareaRow--V8RnZ"}),r.createElement(oY.Ad,{label:"Model ID",input:r.createElement(l5,null)})))),r.createElement(l9,null),e.guid===t?.guid&&r.createElement(rw.Zk,{className:l1.rq},r.createElement(oH.z,{onClick:()=>(0,lv.T9)(t),disabled:"loading"===s.status},(0,d.t)("living_designs.properties_panel.settings.reset_button"))))}function l7({message:e,artwork:t,variant:n="primary"}){return r.createElement("div",{className:W.cx.flex.px16.py4.gap8.$},t&&r.createElement("div",{style:{"--color-icon":"var(--color-icon-assistive)"}},t),r.createElement("div",null,r.createElement("span",{className:W.cx.textBodyMedium.case([["primary"===n,W.cx.colorText],["secondary"===n,W.cx.colorTextSecondary]]).$},e.content)))}function l6({value:e,placeholder:t,handleChange:n,minHeight:a,handleSubmit:o,disabled:l}){let{inputRef:i,inputProps:{onChange:s,onFocus:c,onMouseUp:d,onMouseLeave:p,onKeyUp:m}}=(0,lu.X)({onChange:function(e){n(e.target.value)}});return r.createElement(l_.v,{ref:e=>{e?.textarea&&(i.current=e.textarea)},value:e,placeholder:t,onChange:s,onFocus:c,onMouseUp:d,onMouseLeave:p,onKeyUp:m,minHeight:a,submit:o,bypassModifiers:!0,preventSubmitOnBlur:!0,disabled:l})}function l9(){let[e,t]=(0,y.fp)(lC),n=(0,o.wA)();return r.createElement(rw.Zk,null,r.createElement(lf.r,{titleTx:r.createElement("span",null,(0,d.t)("living_designs.properties_panel.settings.header"))}),r.createElement(oY.Ad,{label:(0,d.t)("living_designs.properties_panel.settings.eval_runs"),input:r.createElement(ly.Ht,{value:e.evaluationRuns,onValueChange:n=>{t({...e,evaluationRuns:n})},dispatch:n,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("living_designs.properties_panel.settings.eval_runs"),min:1,max:5}),alwaysShowLabel:!0}),r.createElement(oY.Ad,{label:(0,d.t)("living_designs.properties_panel.settings.backoff_delay"),input:r.createElement(ly.Ht,{value:e.evalBackoffDelay,onValueChange:n=>{t({...e,evalBackoffDelay:n})},dispatch:n,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("living_designs.properties_panel.settings.backoff_delay"),min:0,max:6e4}),alwaysShowLabel:!0}),r.createElement(oH.z,{onClick:()=>lK(n,e)},(0,d.t)("living_designs.properties_panel.settings.create_evals_button")))}function ie(){return r.createElement(rn.i,null,r.createElement(l3,null))}var it=n(34666),ia=n(75557),ir=n(572304),io=n(516090),il=n(51187),ii=n(41637),is=n(567428),ic=n(294614),id=n(543653),ip=n(270095);class im extends as.o6{render(){return r.createElement(rw.Zk,null,r.createElement(rw.fI,null,r.createElement(rw.xw,null,(0,d.tx)("proto.menu.background"))),r.createElement(iu,{...this.props}))}}function iu(e){let t=r.useRef(null),n=r.useRef(null),a=(0,ew.GS)(),{dispatch:o,pickerShown:l,prototypeBackgroundColor:i}=e,s=r.useCallback(()=>{let e=a?n.current:t.current;if(l&&l.id===tM.$T)o(to.XE());else if(e&&e instanceof HTMLElement){let t=(0,is.cn)(e);o(to.u1({id:tM.$T,initialX:t.x,initialY:t.y}))}},[o,l,a]),c=r.useCallback((e,t)=>{o((0,io._P)({name:"Prototype Background Modified"})),ac.Y5.updateSelectionProperties({prototypeBackgroundColor:e},{shouldCommit:t})},[o]),d=(0,rl._W)(i,{r:0,g:0,b:0,a:1}),p=r.createElement("div",{className:"prototype_background_panel--colorValueContainer--CEbzl paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t"},r.createElement(ad.J,{onClick:s,color:d,opacity:d.a,recordingKey:as.Pt(e,"chit"),className:"prototype_background_panel--chit--F--d0 paint_panels--chit--twQEy"}),r.createElement(id.AN,{className:"prototype_background_panel--color--e5Pc8 paint_panels--colorInput--nSz13",noLeftBorder:!0,formatter:ag.TI,property:d,onChange:c,recordingKey:as.Pt(e,"colorInput"),noBorderOnFocus:!0}));return r.createElement(r.Fragment,null,a?r.createElement(ip.TN,{ref:n},p):r.createElement(rw.fI,{ref:t,className:"prototype_background_panel--colorRow--MtNeY"},p),l&&l.id===tM.$T&&r.createElement(ic.h3,{disabledVariableIds:new Set,initialPosition:new tL.Mi(l.initialX??0,l.initialY??0),color:d,boundVariable:null,onChange:c,recordingKey:as.Pt(e,"colorPicker")}))}im.displayName="PrototypeBackgroundPanel";var iE=n(193199),ig=n(902237),iy=n(158970),i_=n(333780),ih=n(445381),iv=n(30231),ib=n(815413),iS=n(423617);let iT="prototype_device_panel--deviceSelect--wnOgI",iN="prototype_device_panel--deviceOption--rvW-q",iI="prototype_device_panel--inactiveLabel--UEKyk prototype_device_panel--activeLabel--l162n",iP="prototype_device_panel--labelInactive--pv4Sf",iC="prototype_device_panel--deviceDropdownChevron--kq9TV",ik="prototype_device_panel--deviceDropdownInput--AxG9E";var iA=n(537545),iw=n(64111);class iO extends r.PureComponent{constructor(){super(...arguments),this.deviceInfo=()=>ih.hY[this.props.prototypeDevice.presetIdentifier],this.shouldShowModelDropdown=()=>{let e=this.deviceInfo();return ih.yr[e?.deviceName||""].length>1},this.onModelChange=e=>{if(!this.deviceInfo())return;let t=ih.hY[e];if(!t)return;let n=this.props.prototypeDevice.rotation;ac.Y5.updateSelectionProperties({prototypeDevice:{type:"PRESET",size:t.framePresetSize,presetIdentifier:e,rotation:n}})},this.renderModelDropdown=(e,t,n)=>{if(!e)return;let a=r.createElement(iF,{dispatch:this.props.dispatch,presetIdentifier:this.deviceInfo().presetIdentifier,dropdownShown:this.props.dropdownShown,onChange:this.onModelChange,recordingKey:as.Pt(this.props,"modelDropdown")}),o=t?r.createElement(ip.dx,{left:a,right:n}):r.createElement(ip.TN,null,a);return r.createElement("div",null,!this.props.isUI3&&r.createElement(rw.hl,null,r.createElement(rw.UZ,{className:iP},(0,d.tx)("presets.device_panel.model"))),this.props.isUI3?o:r.createElement(rw.fI,null,a))},this.cssForCurrentDeviceRotation=()=>{if("NONE"===this.props.prototypeDevice.type)return;let e="";switch("MICROSOFT_SURFACE_PRO_4"===this.props.prototypeDevice.presetIdentifier&&(e="scale(0.65)"),this.props.prototypeDevice.rotation){case"NONE":default:return;case"CCW_90":return`rotate(-90deg) ${e}`}},this.renderDevicePreview=()=>{let e=this.deviceInfo();if(!e)return;let t=(0,rl._W)(this.props.prototypeBackgroundColor,{r:0,g:0,b:0,a:0}),n=ag.z5.format(t),a=t.r>.9&&t.g>.9&&t.b>.9,o=`1px solid ${a?"#EFEFEF":"transparent"}`,l=r.createElement("div",{className:"prototype_device_panel--devicePreview--T2Tzn",style:{backgroundColor:n,border:o}},r.createElement("img",{className:"prototype_device_panel--deviceImage--Wpr8Y",src:e.thumbnailUrl,style:{transform:this.cssForCurrentDeviceRotation()},alt:`${e.getI18nDeviceName()}`}));return r.createElement("div",null,!this.props.isUI3&&r.createElement(rw.hl,null,r.createElement(rw.UZ,{className:iP},(0,d.tx)("presets.device_panel.preview"))),this.props.isUI3?r.createElement(ip.TN,{appendedClassName:iS.Rk},l):r.createElement("div",{className:"prototype_device_panel--devicePreviewContainer--pC-H4"},l))},this.onChangeOrientation=e=>{let t=this.props.prototypeDevice;if("NONE"===t.type)return;let n=t.size.y>t.size.x,a=t.rotation;a=n?"PORTRAIT"===e?"NONE":"CCW_90":"PORTRAIT"===e?"CCW_90":"NONE",ac.Y5.updateSelectionProperties({prototypeDevice:{...t,rotation:a}})},this.currentDeviceOrientation=()=>{let e=this.props.prototypeDevice;return"NONE"===e.type?"PORTRAIT":e.size.y>e.size.x?"NONE"===e.rotation?"PORTRAIT":"LANDSCAPE":"NONE"===e.rotation?"LANDSCAPE":"PORTRAIT"}}render(){let e=this.props.prototypeDevice,t=r.createElement(iD,{dispatch:this.props.dispatch,prototypeDevice:this.props.prototypeDevice,isUI3:this.props.isUI3,dropdownShown:this.props.dropdownShown,recordingKey:as.Pt(this.props,"deviceDropdown")}),n=r.createElement(iE.bL,{onChange:this.onChangeOrientation,recordingKey:as.Pt(this.props,"orientationControl"),value:this.currentDeviceOrientation(),legend:r.createElement(ig.q,null,(0,d.t)("presets.device_panel.rotation"))},r.createElement(iE.c$,{"aria-label":(0,d.t)("presets.device_panel.rotation.portrait"),value:"PORTRAIT",icon:r.createElement(rD.U,{svg:iw.A},r.createElement(iy.l,null))}),r.createElement(iE.c$,{"aria-label":(0,d.t)("presets.device_panel.rotation.landscape"),value:"LANDSCAPE",icon:r.createElement(rD.U,{svg:iA.A},r.createElement(i_.J,null))})),a=(0,ih.$X)(e.type||"NONE",e.presetIdentifier),o=r.createElement(rw.fI,null,t,a&&n),l=this.deviceInfo()&&this.shouldShowModelDropdown(),i=a&&!l?r.createElement(ip.dx,{left:t,right:n}):r.createElement(ip.TN,null,t),s=r.createElement(ix,{prototypeDevice:this.props.prototypeDevice,dispatch:this.props.dispatch,smallNudgeAmount:this.props.smallNudgeAmount,bigNudgeAmount:this.props.bigNudgeAmount,recordingKey:as.Pt(this.props,"deviceSizeInputs")});return r.createElement(rw.Zk,null,r.createElement(rw.fI,{className:"prototype_device_panel--panelTitleRowOuter--wkKKy collapsible_property_panel--panelTitleRowOuter--i5K0R"},r.createElement(rw.xw,{extended:this.props.isUI3},this.props.isUI3?(0,d.tx)("presets.device_panel.prototype_settings"):(0,d.tx)("presets.device_panel.device"))),this.props.isUI3?i:o,this.renderModelDropdown(!!l,a,n),this.props.isUI3&&"CUSTOM"===this.props.prototypeDevice.type&&s,this.props.isUI3&&r.createElement(iu,{pickerShown:this.props.pickerShown,dispatch:this.props.dispatch,prototypeBackgroundColor:this.props.prototypeBackgroundColor,recordingKey:as.Pt(this.props,"backgroundPanel")}),this.renderDevicePreview(),!this.props.isUI3&&"CUSTOM"===this.props.prototypeDevice.type&&s)}}function ix(e){let t=r.useCallback(t=>{ac.Y5.updateSelectionProperties({prototypeDevice:{type:"CUSTOM",size:{x:t,y:e.prototypeDevice.size.y},rotation:e.prototypeDevice.rotation}})},[e.prototypeDevice.size.y,e.prototypeDevice.rotation]),n=r.useCallback(t=>{ac.Y5.updateSelectionProperties({prototypeDevice:{type:"CUSTOM",size:{x:e.prototypeDevice.size.x,y:t},rotation:e.prototypeDevice.rotation}})},[e.prototypeDevice.size.x,e.prototypeDevice.rotation]),a=r.createElement(ly.$j,{className:"prototype_device_panel--scrubbableInputLeftCol--P2T66 prototype_device_panel--scrubbableInput--0TFVb",inputClassName:"prototype_device_panel--leftColInput--pAJSy prototype_device_panel--input--vNirJ",dispatch:e.dispatch,value:e.prototypeDevice.size.x,onValueChange:t,smallNudgeAmount:e.smallNudgeAmount,bigNudgeAmount:e.bigNudgeAmount,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("presets.device_panel.device_width_tooltip"),tooltipForScreenReadersOnly:!0,recordingKey:as.Pt(e,"deviceWidth")},r.createElement("span",{className:iI},(0,d.tx)("proto.device_panel.width"))),o=r.createElement(ly.$j,{className:"prototype_device_panel--scrubbableInput--0TFVb",inputClassName:"prototype_device_panel--input--vNirJ",dispatch:e.dispatch,value:e.prototypeDevice.size.y,onValueChange:n,smallNudgeAmount:e.smallNudgeAmount,bigNudgeAmount:e.bigNudgeAmount,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("presets.device_panel.device_height_tooltip"),tooltipForScreenReadersOnly:!0,recordingKey:as.Pt(e,"deviceHeight")},r.createElement("span",{className:iI},(0,d.tx)("proto.device_panel.height")));return(0,ew.GS)()?r.createElement(ip.dx,{left:a,right:o}):r.createElement(rw.fI,null,a,o)}iO.displayName="PrototypeDevicePanel";let iR=iv.l6,iL=iv.c$;class iD extends as.o6{constructor(){super(...arguments),this.formatter={format:e=>"NONE"===e?this.props.isUI3?(0,d.t)("proto.frame_preset_panel.no_device"):(0,d.t)("proto.frame_preset_panel.none"):"CUSTOM"===e?(0,d.t)("proto.frame_preset_panel.custom_size"):"PRESENTATION"===e?(0,d.t)("proto.frame_preset_panel.presentation"):e.getI18nDeviceName(),isEqual:(e,t)=>"NONE"===e||"CUSTOM"===e||"PRESENTATION"===e||"NONE"===t||"CUSTOM"===t||"PRESENTATION"===t?e===t:e.presetIdentifier===t.presetIdentifier},this.onChange=e=>{(0,io.$J)(e,this.props.prototypeDevice);let t=this.props.prototypeDevice.type,n=t;n="NONE"===e?"NONE":"PRESENTATION"===e?"PRESENTATION":"CUSTOM"===e?"CUSTOM":"PRESET",this.props.dispatch((0,io._P)({name:"Prototype Device Type Changed",params:{oldType:this.props.prototypeDevice.presetIdentifier||t,newType:e.presetIdentifier||n,isInlinePreviewOpened:y.zl.get(ib.h).modalStatus===ib.b.OPEN}}))},this.renderPresetOption=(e,t)=>{let n=(0,ih.Fh)(e,this.props.prototypeDevice);if(null===n)return null;let a=n.framePresetSize;return r.createElement(iL,{value:n,key:t,recordingKey:as.Pt(this.props,n.deviceName)},r.createElement("div",{className:iN},r.createElement("span",null,n.getI18nDeviceName()),r.createElement("span",null,a.x,"\u200A\xd7\u200A",a.y)," "))}}render(){let e;return e="NONE"===this.props.prototypeDevice.type?"NONE":"PRESENTATION"===this.props.prototypeDevice.type?"PRESENTATION":"CUSTOM"===this.props.prototypeDevice.type?"CUSTOM":ih.hY[this.props.prototypeDevice.presetIdentifier]||"NONE",r.createElement(iR,{className:iT,chevronClassName:iC,inputClassName:ik,id:"prototype-device-select",property:e,formatter:this.formatter,onChange:this.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,dropdownClassName:"prototype_device_panel--deviceDropdown--ufbuZ",recordingKey:as.Pt(this.props,"select"),dropdownAlignment:"right"},r.createElement(iL,{value:"NONE",recordingKey:as.Pt(this.props,"NONE")}),r.createElement(iv.sK,null),ih.r6.map(this.renderPresetOption),r.createElement(iv.sK,null),ih.J_.map(this.renderPresetOption),r.createElement(iv.sK,null),ih.AG.map(this.renderPresetOption),r.createElement(iv.sK,null),ih.$w.map(this.renderPresetOption),r.createElement(iv.sK,null),r.createElement(iL,{value:"CUSTOM",recordingKey:as.Pt(this.props,"CUSTOM")},r.createElement("div",{className:iN},r.createElement("span",null,(0,d.tx)("proto.frame_preset_panel.custom_size")),r.createElement("span",null,(0,d.tx)("proto.frame_preset_panel.fit")))),r.createElement(iL,{value:"PRESENTATION",recordingKey:as.Pt(this.props,"PRESENTATION")},r.createElement("div",{className:iN},r.createElement("span",null,(0,d.tx)("proto.frame_preset_panel.presentation")),r.createElement("span",null,(0,d.tx)("proto.frame_preset_panel.fill")))),r.createElement(iv.sK,null),ih.dr.map(this.renderPresetOption))}}iD.displayName="DeviceDropdown";let iM=iv.l6,iK=iv.c$;class iF extends as.o6{constructor(){super(...arguments),this.formatter={format:e=>{let t=ih.hY[e];return t?t.getI18nStyleName():(0,d.t)("proto.frame_preset_panel.missing")},isEqual:(e,t)=>e===t},this.renderStyleOption=(e,t)=>{let n=e.presetIdentifier;return r.createElement(iK,{value:n,key:t,recordingKey:as.Pt(this.props,n)},ih.hY[n].getI18nStyleName())}}render(){let e=ih.hY[this.props.presetIdentifier];if(!e)return null;let t=ih.yr[e.deviceName],n=this.props.presetIdentifier;return r.createElement(iM,{className:iT,chevronClassName:iC,inputClassName:ik,id:"prototype-style-select",property:n,formatter:this.formatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,dropdownClassName:"prototype_device_panel--modelDropdown--WbHYJ",recordingKey:as.Pt(this.props,"select")},t.map(this.renderStyleOption))}}iF.displayName="ModelDropdown";var iV=n(256296),iU=n(536825),iB=n(25845),iG=n(616662),iz=n(145087),iW=n(678632),iH=n(78972),iY=n(650947),i$=n(320012),iX=n(360986),ij=n(399230),iQ=n(804175);function iJ(e){return e??"Default"}let iq=r.createContext({getNodeName:iJ}),iZ=r.memo(function({getNodeName:e=iJ,children:t}){let n=r.useMemo(()=>({getNodeName:e}),[e]);return r.createElement(iq.Provider,{value:n},t)});var i0=n(701e3),i1=n(229243),i4=n(108378),i2=n(908946),i8=n(712632),i5=n(792863),i3=n(448124),i7=n(893685),i6=n(90233),i9=n(580769),se=n(52535),st=n(867320);function sn(){let e=(0,o.wA)(),t=(0,o.d4)(e=>(0,rs.Yh)(e.mirror.appModel,i3.JT.MAGIC_LINK)),n=(0,i5.PE)(),{withinMeter:a}=(0,i8.X)(i3.JT.MAGIC_LINK);return n&&a?r.createElement("span",{className:"magic_link--magicLinkButton--CWefW","data-testid":"magic-link-entry"},r.createElement(eV.K,{recordingKey:as.Pt("prototypeInteractionList","magicLinkButton"),"aria-label":(0,s.kc)().prototype_ai_magic_link_name_change?(0,d.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip-v2"):(0,d.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip"),onClick:()=>{(0,i9.$I)({moduleToOpen:{type:"custom",module:r.createElement(se.p,null),name:i6.Sn.MAGIC_LINK,beforeModuleOpen:()=>{e((0,io.Zh)({name:"prototype.ai_magic_link_entry_clicked",params:{source:"properties_panel"}})),(0,i7.B3)(i3.JT.MAGIC_LINK),t&&(0,i7.Ag)(i3.JT.MAGIC_LINK,st.e,{})}},trackingData:{source:"prototype_magic_link_triggered"}})},htmlAttributes:{"data-tooltip":(0,s.kc)().prototype_ai_magic_link_name_change?(0,d.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip-v2"):(0,d.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip"),"data-tooltip-type":rM.Ib.TEXT,"data-tooltip-show-above":!0}},r.createElement(i2.B,null))):null}var sa=n(631511);let sr=(0,sa.ex)("prototype_info",function(e){let{tooltipText:t}=e;return r.createElement("div",{className:W.cx.flex.justifyCenter.itemsCenter.$},r.createElement("span",{className:W.cx.m6.flexGrow1.$,style:{maxWidth:144}},t))},e=>({tooltipText:e.getAttribute("data-tooltip-text")}));var so=n(331481),sl=n(207259),si=n(819785),ss=n(695038),sc=n(612325);let sd=new iz.JV,sp=new iz.Eq,sm=new iz.sX,su=r.memo(function({filterInteractionCategory:e}){let t=(0,o.wA)(),n=(0,o.d4)(i4.Cy),a=(0,o.d4)(i4.n9),l=(0,o.d4)(i4.DV),c=(0,o.d4)(s_),d=(0,o.d4)(iY.dK),p=(0,o.d4)(iY.Xt),m=(0,i4.a2)(),u=(0,i4.R)(),E=(0,o.d4)(sf),g=(0,o.d4)(sy),y=Object.keys(p).length>1,_=sv(),h=function(){let e=sv(),t=(0,o.d4)(sh);return!!e&&!!t&&t.selectionOverrides[i.YnC.PROTOTYPE_INTERACTIONS]}(),f=(0,eo.q5)(),v=(0,iB.U)(),b=(0,aX.cJ)(),S=r.useMemo(()=>new iz.cP(d),[d]),T=r.useCallback(e=>S.format(e),[S]),N=r.useRef(null),I=e=>{ac.Y5.updateSelectionProperties({prototypeInteractions:e},{shouldCommit:i$.zk.NO_BUT_TRACK_AS_EDIT}),ac.Y5.commit()},P=(0,ii.Zj)(Object.keys(p)),C=r.createElement(sE,{interactionGroups:m,inheritedInternalInteractionGroups:u,mixed:y,isOrInInstance:_,openFile:f,dispatch:t,currentSelectedProperty:c,onChange:(e,t)=>{let r=e.map(e=>e.interactions).reduce((e,t)=>e.concat(t),[]),o=new Set,l=[];for(let e of r){let t=ir.dI(e.id);if(t&&!o.has(t))l.push(e);else{if(!(t=i.glU.generateUniqueID()))continue;let n=ir.sH(t);if(!n)continue;l.push({...e,id:n})}t&&o.add(t)}t===iX.J.NORMAL?l=[...l,...a]:t===iX.J.INHERITED_INTERNAL&&(l=[...n,...l]),I(l)},onAddProperty:e=>{e.stopPropagation();let t=[],r=[];for(let e of Object.keys(p)){let n=i.glU.generateUniqueID();if(!n)return;let a=ir.sH(n);if(!a)return;let o={id:a,sourceNodeID:ir.sH(e)??ir.Hr,event:{interactionType:function(e,t=!1){let n=new Set;for(let{event:t}of e)n.add(t.interactionType);for(let e of sb)if((!(0,s.kc)().sts_interaction_interop||!t||"DRAG"!==e)&&!n.has(e))return e;return"ON_KEY_DOWN"}(m,b)}};o.stateManagementVersion=1,o.actions=[{connectionType:"NONE"}],t.push(o);let l=(0,t9.kh)(d,e);r.push(l?l.guid:"")}let o=t.map(e=>iG.d({nodeID:e.sourceNodeID,interactionID:e.id}));if(o.length>0){i.glU.setSelectedInteractions(o);let e=(0,is.cn)(N.current);sP(new tL.Mi(e.x,e.y+(0,nK.jz)(sl.rightNavGridRowHeight)))}let l=[...n,...t,...a];v("prototype_interaction_added",{interactionCount:l.length,sourceTlfIds:JSON.stringify(r)}),I(l)},onDeleteProperty:(e,t)=>{let n=(t===iX.J.NORMAL?m:u).filter((t,n)=>e.has(n)),a=[];for(let e of n)a.push(...e.interactions);let r=sI(a);rE.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(r)),ac.Y5.deselectProperty()},shouldIgnoreKeyboardEvents:l.length>0||c.type!==i.rrT.PROTOTYPE_INTERACTION&&c.type!==i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,isValidPrototypingSourceSelected:E,showResetInteractionsButton:h,toggleScrollBehaviorPicker:()=>{if(g?.id===tM.AO)t(to.XE());else{let e=(0,is.cn)(N.current);t(to.u1({id:tM.AO,initialX:e.x,initialY:e.y}))}},headerAccessory:P&&r.createElement(sn,null),inSites:b,filterInteractionCategory:e});return r.createElement(iZ,{getNodeName:T},b?C:r.createElement(rw.Zk,{"data-onboarding-key":"prototypePanel",ref:N,"data-testid":"prototype-interaction-list"},C))});function sE(e){let t=r.useRef(!1),n=(0,ew.GS)(),a=(0,s.kc)().sts_interaction_interop&&!!e.filterInteractionCategory,o=!a||e.filterInteractionCategory===iX.J.NORMAL,l=e.isOrInInstance&&e.inheritedInternalInteractionGroups.length>0,c=a?e.filterInteractionCategory===iX.J.INHERITED_INTERNAL&&l:l,p=n?r.createElement("div",{className:"prototype_interaction_list--categoryRow--Xxfm4"},r.createElement(iV.J,{className:"prototype_interaction_list--categoryLabel--0dGOM"},(0,d.tx)("proto.interaction_list.variant_interactions"))):r.createElement(rw.fI,null,r.createElement(rw.UZ,{className:"prototype_interaction_list--label--dGwgy"},(0,d.tx)("proto.interaction_list.variant_interactions")));return r.createElement(r.Fragment,null,o&&r.createElement(iQ.h6,{title:e.inSites?"":(0,d.t)("proto.title_interactions"),stylePickerShown:{isShown:!1},addProperty:e.onAddProperty,toggleScrollBehaviorPicker:e.toggleScrollBehaviorPicker,hideAddButton:!e.isValidPrototypingSourceSelected,renderProperty:(n,a,o,l,i,c,d,p,m)=>!(0,s.kc)().sts_interaction_interop&&e.inSites&&(0,so.p4)(n.interactions)?r.createElement(r.Fragment,{key:a}):r.createElement(sg,{interactionGroups:e.interactionGroups,interactionGroup:n,index:a,selected:o,hasFocus:i,isDragging:l,singletonRow:e.interactionGroups.length<=1,onMouseDown:d,onMouseMove:p,onMouseUp:m,dispatch:e.dispatch,category:iX.J.NORMAL,autoOpenVariablePicker:t,recordingKey:as.Pt("prototypeInteractionList",a),key:a,inSites:e.inSites}),openFile:e.openFile,onChange:t=>e.onChange(t,iX.J.NORMAL),currentSelectedProperty:e.currentSelectedProperty,selectedPropertyType:i.rrT.PROTOTYPE_INTERACTION,propertyList:e.interactionGroups,pickerShown:null,dispatch:e.dispatch,onDeleteProperty:t=>e.onDeleteProperty(t,iX.J.NORMAL),shouldIgnoreKeyboardEvents:e.shouldIgnoreKeyboardEvents,recordingKey:"prototypeInteractionList",boldHeaderRow:e.interactionGroups.length>=1||e.inheritedInternalInteractionGroups.length>=1,showResetInteractionsButton:e.showResetInteractionsButton,onResetInteractions:rE.nc.user("reset-instance-interactions",()=>i.glU.resetSymbolOverrides(i.YnC.PROTOTYPE_INTERACTIONS)),headerAccessory:e.headerAccessory}),c&&p,c&&r.createElement(iQ.h6,{title:"",stylePickerShown:{isShown:!1},addProperty:z.lQ,hideAddButton:!0,toggleScrollBehaviorPicker:e.toggleScrollBehaviorPicker,renderProperty:(n,a,o,l,i,s,c,d,p)=>r.createElement(sg,{interactionGroups:e.inheritedInternalInteractionGroups,interactionGroup:n,key:a,index:a,selected:o,hasFocus:i,isDragging:l,singletonRow:e.inheritedInternalInteractionGroups.length<=1,onMouseDown:c,onMouseMove:d,onMouseUp:p,dispatch:e.dispatch,category:iX.J.INHERITED_INTERNAL,autoOpenVariablePicker:t,recordingKey:as.Pt("prototypeInheritedInternalInteractionList",a),inSites:e.inSites}),openFile:e.openFile,onChange:t=>e.onChange(t,iX.J.INHERITED_INTERNAL),currentSelectedProperty:e.currentSelectedProperty,selectedPropertyType:i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,propertyList:e.inheritedInternalInteractionGroups,pickerShown:null,dispatch:e.dispatch,onDeleteProperty:t=>e.onDeleteProperty(t,iX.J.INHERITED_INTERNAL),shouldIgnoreKeyboardEvents:e.shouldIgnoreKeyboardEvents,recordingKey:as.Pt("prototypeInheritedInternalInteractionList")}))}function sg({interactionGroups:e,interactionGroup:t,index:n,hasFocus:a,isDragging:l,selected:c,singletonRow:p,onMouseDown:m,onMouseMove:u,onMouseUp:E,dispatch:g,category:_,recordingKey:h,inSites:f}){let v=(0,ew.GS)(),{getNodeName:b}=r.useContext(iq),S=(0,o.d4)(i4.DV),T=(0,i4.a2)(),N=(0,o.d4)(sy),I=N?.id===tM.o$?N:null,P=(0,o.d4)(iY.dK),[C,k]=r.useState(!1),A=(0,y.md)(iH.NE)?sp:sd,w=r.useContext(so.qd),O=function(e,t){let n=new Set(t.map(e=>{let t=iG.s(e);return t?ir.dI(t.interactionID):""}).filter(e=>""!==e));for(let t of e.interactions){let e=ir.dI(t.id);if(e&&n.has(e))return!0}return!1}(t,S),x=r.useRef(null),R=r.useRef(null),L=r.useCallback(()=>{let e=v&&f?R.current:x.current;sP((0,is.cn)(e))},[f,v]),D=r.useCallback(()=>{i.glU.setSelectedInteractions([]),g(to.XE()),ac.Y5.deselectProperty()},[g]),M=n=>{if(!x||!R)return;let a=sN(t);if(n.metaKey||n.ctrlKey)O?a=S.filter(e=>!a.includes(e)):a.push(...S);else if(n.shiftKey){var r;let n,o;let l=(r=t.key,e.findIndex(({key:e})=>e===r));if(-1===l)return;let i=function(e,t){let n=1/0,a=e;for(let r of t){let t=Math.abs(e-r);t<n&&(a=r,n=t)}return a}(l,function(e,t){let n=new Set,a=new Set(t);for(let t=0;t<e.length;t++)sN(e[t]).some(e=>a.has(e))&&n.add(t);return n}(e,S)),s=(n=l,o=i,l>i&&(n=i,o=l),e.slice(n,o+1));for(let e of(a=[...S],s))a.push(...sN(e))}i.glU.setSelectedInteractions(a),ac.Y5.updateAppModel({currentSelectedProperty:{type:_===iX.J.NORMAL?i.rrT.PROTOTYPE_INTERACTION:i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,indices:[]}}),a.length?I&&I.shouldPin?f&&(a.length>1||a.includes(S[0]))&&D():L():D()},K=(0,o.d4)(ij.ZM),F=!1,V=null,U=null;for(let e of t.interactions)if(!V&&e.actions&&e.actions.length>0)V=e.actions[0],U=e;else if(sT(V,b,v,K)!=sT((e.actions??[])[0],b,v,K)){F=!0;break}let B=()=>{let e=sI(t.interactions);i.glU.hoverInteractions(e),k(!0)},G=()=>{i.glU.hoverInteractions([]),k(!1)},W=e=>{e.stopPropagation()},H=e=>{e.stopPropagation();let n=sI(t.interactions);rE.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(n)),ac.Y5.deselectProperty(),ac.Y5.commit()},Y=!1,$=!1;if(_===iX.J.NORMAL){for(let e of t.interactions){if(!e.actions||0===e.actions.length)continue;let t=e.actions[0];if(!t||"SWAP_STATE"!==t.navigationType)continue;let n="";if(t.transitionNodeID){let e=P.get(ir.dI(t.transitionNodeID));if(e){if(e.isState)n=e.parentGuid||"";else{Y=!0;break}}}let a=i.glU.getContainingStateGroupOrSelf(ir.dI(e.sourceNodeID??ir.Hr))||"";if(""===a||""!==n&&a!==n){Y=!0;break}}let n=["ON_CLICK","MOUSE_DOWN","MOUSE_UP"].includes(t.event.interactionType??""),a=e.some(e=>"ON_HOVER"===e.event.interactionType);$=n&&a}Y=_!==iX.J.INHERITED_INTERNAL&&Y;let X=function(e,t,n){if(e!==iX.J.INHERITED_INTERNAL)return null;let a=n.find(e=>e.key===t.key&&e.interactions.length===t.interactions.length&&1===t.interactions.length&&function(e,t){let n=void 0!==e.actions&&e.actions.length>=1,a=void 0!==t.actions&&t.actions.length>=1;if(!n||!a)return!1;let r=e.actions.every(e=>"UPDATE_MEDIA_RUNTIME"===e.connectionType),o=e.actions.every(e=>ir.fn(e.transitionNodeID));var l=!1;for(let e of t.actions)if("INTERNAL_NODE"===e.connectionType&&"SWAP_STATE"===e.navigationType){l=!0;break}return r&&o&&l}(e.interactions[0],t.interactions[0]));return a?.interactions[0]??null}(_,t,e),j=(0,rg.ZC)(X),Q=(0,iB.U)();if(r.useEffect(()=>{null===j&&X&&Q("prototype_interaction_conflict_override_created",{interaction_type:t.interactions[0].event?.interactionType,action_type:X.event?.interactionType})}),(0,s.kc)().sts_interaction_interop&&t.event.interactionType&&w&&w!==(0,i0.hD)(t.event.interactionType)||(0,s.kc)().sts_interaction_interop&&"mouse"===w&&(0,so.zL)(t.interactions))return null;let J=_===iX.J.INHERITED_INTERNAL&&T.some(e=>e.key===t.key)&&!X,q=c&&a,Z=O&&!c,ee=new iz.js(v,K),et=(0,iz.mj)(V),en=U?.actions?.length??0,ea=(0,s.kc)().sts_interaction_interop&&en>1?(0,d.t)("sites.panel.interaction_summary",{numActions:en}):F||!V||"NONE"===et?void 0:ee.format(et),er=r.createElement(aE.Z,null),eo=Y||$||J,el=Y?(0,d.t)("proto.prototype_panel.this_interaction_must_swap_from_a_variant_to_another_variant_within_the_same_component_set_tooltip"):$?(0,d.t)("proto.prototype_panel.prototype_multiple_interactions_mouse_and_hover_tooltip"):J?(0,d.t)("proto.prototype_panel.this_interaction_will_not_be_triggered_as_interactions_on_instances_are_triggered_before_inherited_internal_interactions_tooltip"):"",ei=r.createElement(oY.Y9,{ref:R,"data-testid":`prototypeInteractionItem-${n}`,singletonRow:p,dragging:l,onMouseDown:m,onMouseMove:u,onMouseUp:E,onMouseEnter:B,onMouseLeave:G,recordingKey:as.Pt(h,"draggableRow"),onClick:(0,s.kc)().sts_interaction_interop?M:z.lQ},r.createElement(oY.s2,{label:null,leftIcon:r.createElement(rj.d,{toggled:Z&&!!I,recordingKey:as.Pt(h,"interactionIcon"),onClick:(0,s.kc)().sts_interaction_interop?z.lQ:M,htmlAttributes:{onMouseDown:W,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":eo?el:sS(t.event,A,!!f)},"aria-label":eo?el:sS(t.event,A,!!f),children:eo?er:(0,iW.e7)(t.event.interactionType)}),input:r.createElement(nT.D8,{onClick:(0,s.kc)().sts_interaction_interop?z.lQ:M,onMouseDown:W,recordingKey:as.Pt(h,"interactionText")},sS(t.event,A,!!f),ea&&r.createElement("span",{className:"prototype_interaction_list--summaryText--hGpp4"},"\xa0\xb7\xa0",ea)),rightIcon:r.createElement("div",{hidden:(0,s.kc)().sts_interaction_interop&&!C},r.createElement(eV.K,{onClick:H,"aria-label":(0,d.t)("proto.prototype_panel.remove_interaction_tooltip"),recordingKey:as.Pt(h,"removeButton"),htmlAttributes:{onMouseDown:W}},r.createElement(rD.U,{svg:si.A,fallbackSvg:ss.A},r.createElement(iU.O,null))))}));return f?ei:r.createElement("div",null,r.createElement(rA.e,{ref:x,className:v?"prototype_interaction_list--interactionListRow---i0Rg ui3_rows--ui3OneInputOneIconRow--SMoQ9 ui3_rows--_row--DnZFk ui3_rows--_grid--cP2Wu":void 0,"data-testid":`prototypeInteractionItem-${n}`,selected:q,selectedSecondary:Z,singletonRow:p,dragging:l,onMouseDown:m,onMouseMove:u,onMouseUp:E,onMouseEnter:B,onMouseLeave:G,recordingKey:as.Pt(h,"draggableRow")},r.createElement(nT.D8,{className:eG()({"prototype_interaction_list--interactionButton--q-58Q":!0,"prototype_interaction_list--interactionButtonSelected--8YX9A":q,"prototype_interaction_list--interactionButtonSelectedSecondary--Nx73L":Z}),onClick:M,onMouseDown:W,recordingKey:h},eo&&r.createElement(nH.B,{className:"prototype_interaction_list--warningIcon--Mgr5O",svg:sc.A,"data-tooltip-type":rM.Ib.SPECIAL,"data-tooltip":sr,"data-tooltip-text":el}),r.createElement("div",{className:eo?"prototype_interaction_list--interactionNameShort--5UMLL prototype_interaction_list--interactionName--zQsSL":"prototype_interaction_list--interactionName--zQsSL"},sS(t.event,A,!!f)),r.createElement(rD.U,{className:"prototype_interaction_list--actionIcon--x-haP",svg:F?(0,iW.Yb)("NONE"):(0,iW.Yb)((0,iz.mj)(V))},(0,iW.av)((0,iz.mj)(V))),r.createElement("div",{className:"prototype_interaction_list--targetText--UMXyE",dir:"auto"},F?(0,d.t)("proto.variant_actions.mixed"):_===iX.J.INHERITED_INTERNAL?(0,d.t)("proto.variant_actions.change_to"):sT(V,b,v,K))),r.createElement("span",{className:"prototype_interaction_list--removeButton--g6aiQ"},r.createElement(eV.K,{onClick:H,"aria-label":(0,d.t)("proto.prototype_panel.remove_interaction_tooltip"),recordingKey:as.Pt(h,"removeButton"),htmlAttributes:{onMouseDown:W}},r.createElement(rD.U,{svg:si.A,fallbackSvg:ss.A},r.createElement(iU.O,null))))))}function sy(e){return e.pickerShown}function s_(e){return e.mirror.appModel.currentSelectedProperty}function sh(e){return e.mirror.selectionProperties.resettableInstanceOverrides}function sf(e){return e.mirror.selectionProperties.isValidPrototypingSourceSelected??!0}function sv(){let e=(0,o.d4)(iY.Xt),t=(0,o.d4)(iY.dK);for(let n of Object.keys(e)){let e=t.get(n);if(e&&("INSTANCE"===e.type||e.isInstanceSublayer))return!0}return!1}let sb=["ON_CLICK","DRAG","ON_HOVER","ON_PRESS","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"];function sS(e,t,n){let a=t.format(e.interactionType??"NONE");if("ON_KEY_DOWN"===e.interactionType&&e.keyTrigger&&e.keyTrigger.keyCodes){let t=(0,i1._i)(e.keyTrigger.keyCodes),r=(0,i1.E8)(e.keyTrigger,!0);if("KEYBOARD"===e.keyTrigger.triggerDevice&&t)return(0,s.kc)().sts_interaction_interop&&n?(0,i1.U8)(t):a+" ("+(0,i1.U8)(t)+")";if(r)return(0,s.kc)().sts_interaction_interop&&n?r:a+" ("+r+")"}return a}function sT(e,t,n,a){let r=new iz.js(n,a);if(!e)return r.format("NONE");let o=(0,iz.mj)(e);switch(o){case"NONE":case"GO_BACK":case"CLOSE_OVERLAY":case"SET_VARIABLE":case"SET_VARIABLE_MODE":case"CONDITIONAL":return r.format(o);case"OPEN_URL":if(null!=e.connectionURL){if((0,rl.gl)(e.connectionURL))return(0,d.t)("fullscreen.mixed");return e.connectionURL.replace(/https?:\/\//,"")}return r.format("NONE");case"UPDATE_MEDIA_PLAY":case"UPDATE_MEDIA_PAUSE":case"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE":case"UPDATE_MEDIA_MUTE":case"UPDATE_MEDIA_UNMUTE":case"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE":case"UPDATE_MEDIA_SKIP_FORWARD":case"UPDATE_MEDIA_SKIP_BACKWARD":case"UPDATE_MEDIA_SKIP_TO":return sm.format(e)}return e.transitionNodeID?(0,rl.gl)(e.transitionNodeID)?(0,d.t)("fullscreen.mixed"):t(ir.dI(e.transitionNodeID)):r.format("NONE")}function sN(e){return e.interactions.filter(e=>e.id&&e.sourceNodeID).map(e=>iG.d({nodeID:e.sourceNodeID,interactionID:e.id}))}function sI(e){let t=[];for(let n of e){let{sourceNodeID:e,id:a}=n;e&&a&&t.push(iG.d({nodeID:e,interactionID:a}))}return t}function sP(e){ac.Y5.triggerAction("show-prototype-interaction-edit-modal",{args:{source:i.yxn.PROPERTIES_PANEL,x:e.x,y:e.y}})}var sC=n(584724),sk=n(447716),sA=n(328177),sw=n(974985),sO=n(256981),sx=n(43604);let sR=(0,r.memo)(function(e){return(0,nU.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,nU.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M14 6v1.879l-1 1V6l-1 1-2 2H7.5a.5.5 0 0 0-.5.5v5c0 .107.034.206.091.288l-.71.71A1.5 1.5 0 0 1 6 14.5v-5A1.5 1.5 0 0 1 7.5 8h2.086l2.707-2.707A1 1 0 0 1 14 6m-1 7.121 1-1V18a1 1 0 0 1-1.707.707l-2.44-2.44.708-.706L12 17l1 1zm3.779-3.778-.71.71a2.5 2.5 0 0 1-.676 4.283c-.223.085-.393.285-.393.522v.03c0 .304.272.54.562.448a3.501 3.501 0 0 0 1.217-5.993m-1.551 1.55-.172.173a.5.5 0 0 0-.056.226v1.415c0 .345.35.576.588.326a1.5 1.5 0 0 0 0-2.066c-.112-.117-.247-.13-.36-.073m2.626-4.04a.5.5 0 0 0-.708-.706l-11 11a.5.5 0 1 0 .708.707z",clipRule:"evenodd"})})});var sL=n(83687),sD=n(554187),sM=n(477633),sK=n(564734),sF=n(68710),sV=n(632319);function sU({videoPlayback:{mediaLoop:e,muted:t}}){let n=null;return(0,rl.gl)(e)&&(0,rl.gl)(t)?n=(0,d.tx)("proto.prototype_panel.replace_mixed_muted_and_loop_video_playback",{loopSvg:r.createElement(nH.B,{svg:sM.A,className:sD.eT}),speakerSvg:r.createElement(nH.B,{svg:sF.A,className:sD.To})}):(0,rl.gl)(e)?n=(0,d.tx)("proto.prototype_panel.replace_mixed_video_playback",{svg:r.createElement(nH.B,{svg:sM.A,className:sD.eT})}):(0,rl.gl)(t)&&(n=(0,d.tx)("proto.prototype_panel.replace_mixed_video_playback",{svg:r.createElement(nH.B,{svg:sF.A,className:sD.To})})),n?r.createElement(rw.fI,null,r.createElement(rw.UZ,{className:sD.pc},n)):null}let sB=e=>(0,rl.gl)(e)?"mixed":e,sG=e=>!0===e,sz=function(e){let t=()=>{let t=!sG(e.videoPlayback.mediaLoop);e.updateSelectionProperties({videoMediaLoop:t}),e.dispatch((0,io._P)({name:"Node video loop changed",params:{newLoop:t,oldLoop:sB(e.videoPlayback.mediaLoop),numVideosSelected:e.videoPlayback.numVideosSelected}}))},n=()=>{let t=!e.videoPlayback.muted;e.updateSelectionProperties({videoMuted:t}),e.dispatch((0,io._P)({name:"Node video muted changed",params:{newMuteValue:t,oldMuteValue:sB(e.videoPlayback.muted),numVideosSelected:e.videoPlayback.numVideosSelected}}))},a=r.createElement("span",{className:(0,ew.GS)()?void 0:sD.hW},r.createElement(sk.S,{label:r.createElement(iV.J,{htmlAttributes:{"data-tooltip":(0,d.t)("proto.prototype_panel.default_video_playback_state"),"data-tooltip-type":rM.Ib.TEXT}},(0,d.tx)("proto.prototype_panel.autoplay")),onChange:t=>{e.updateSelectionProperties({videoAutoplay:t}),e.dispatch((0,io._P)({name:"Node video autoplay Changed",params:{newAutoplay:t,oldAutoplay:sB(e.videoPlayback.autoplay),numVideosSelected:e.videoPlayback.numVideosSelected}}))},checked:sG(e.videoPlayback.autoplay),mixed:(0,rl.gl)(e.videoPlayback.autoplay),recordingKey:as.Pt(e,"autoPlayToggle")})),o=(0,ew.GS)()?r.createElement(sA.f,{checked:sG(e.videoPlayback.mediaLoop),mixed:(0,rl.gl)(e.videoPlayback.mediaLoop),onIcon:r.createElement(rD.U,{svg:sM.A},r.createElement(sw.p,null)),offIcon:r.createElement(rD.U,{svg:sK.A},r.createElement(sO.U,null)),onChange:t,recordingKey:as.Pt(e,"videoLoopToggle"),"aria-label":(0,d.t)("proto.prototype_panel.loop"),htmlAttributes:{"data-tooltip":(0,d.t)("proto.prototype_panel.loop"),"data-tooltip-type":rM.Ib.TEXT}}):r.createElement(sL.m,{toggled:sG(e.videoPlayback.mediaLoop),svg:e.videoPlayback.mediaLoop?sM.A:sK.A,fallbackSvg:e.videoPlayback.mediaLoop?sM.A:sK.A,onMouseDown:t,recordingKey:as.Pt(e,"videoLoopToggle"),"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("proto.prototype_panel.loop"),dataTestId:"videoLoopToggle",className:sD.BM}),l=(0,ew.GS)()?r.createElement(sA.f,{checked:sG(!e.videoPlayback.muted),mixed:(0,rl.gl)(e.videoPlayback.muted),onIcon:r.createElement(rD.U,{svg:sF.A},r.createElement(sx.L,null)),offIcon:r.createElement(rD.U,{svg:sV.A},r.createElement(sR,null)),onChange:n,recordingKey:as.Pt(e,"videoSoundToggle"),"aria-label":(0,d.t)("proto.prototype_panel.sound"),htmlAttributes:{"data-tooltip":(0,d.t)("proto.prototype_panel.sound"),"data-tooltip-type":rM.Ib.TEXT}}):r.createElement(sL.m,{toggled:!e.videoPlayback.muted,svg:sG(e.videoPlayback.muted)?sV.A:sF.A,fallbackSvg:sG(e.videoPlayback.muted)?sV.A:sF.A,onMouseDown:n,recordingKey:as.Pt(e,"videoSoundToggle"),"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("proto.prototype_panel.sound"),dataTestId:"videoSoundToggle",className:sD.BM}),i=(0,ew.GS)()?r.createElement(oY.pG,{input:a,leftIcon:o,rightIcon:l}):r.createElement(rw.fI,{className:sD.kh},a,r.createElement("div",{className:sD.zc},o,l));return r.createElement(rw.Zk,null,r.createElement(rw.fI,null,r.createElement(rw.xw,{extended:!0},(0,d.tx)("proto.prototype_panel.video"))),i,r.createElement(sU,{videoPlayback:e.videoPlayback}))};var sW=n(966664),sH=n(498481),sY=n(757700),s$=n(420450),sX=n(955136);function sj(e){let{type:t}=e;return r.createElement("div",{className:W.cx.flex.justifyCenter.itemsCenter.$},r.createElement(nH.B,{className:W.cx.flexGrow1.mx12.$,useOriginalSrcFills_DEPRECATED:!0,svg:"horizontal"===t?s$.A:sX.A}),r.createElement("span",{className:W.cx.flexGrow1.m6.$,style:{maxWidth:144}},(0,d.tx)("proto.prototype_panel.content_needs_to_be_bigger_than_the_frame_tooltip")))}let sQ=(0,sa.ex)("prototype_scroll_horizontal_info",sj,()=>({type:"horizontal",unconstrainWidth:!0})),sJ=(0,sa.ex)("prototype_scroll_vertical_info",sj,()=>({type:"vertical",unconstrainWidth:!0})),sq=(0,sa.ex)("prototype_scroll_marquee_info",function(){return r.createElement("div",{className:W.cx.flex.justifyCenter.itemsCenter.$},r.createElement("span",{className:W.cx.flexGrow1.m6.$,style:{maxWidth:144}},(0,d.tx)("proto.prototype_panel.overflow_scrolling_not_available_for_frames_with_marquee")))},()=>({})),sZ="scroll_behavior_panel--inactiveLabel--IexW8",s0="scroll_behavior_panel--inactiveLabelContainer--lQjAi";function s1(e){let{disableOverflowBehaviorItem:t,disableScrollBehaviorItem:n,dropdownShown:a,updateSelectionProperties:l}=e,s=(0,o.wA)(),[c,p]=function(){let e=(0,eS.J2)(i.Ez5.propertiesPanelState().shownPropertiesPanels)[i.ibQ.OVERFLOW_ITEM],t=(0,ia.cJ)(),n=(0,sY.kl)("isSection"),a=(0,sY.kl)("anyTopLevelFramesInSelection");return[e,!t&&!n&&!a]}(),[m]=(0,sY.lJ)("showWontScrollWarning"),[u]=(0,sY.lJ)("scrollDirection"),E=s9(),g=(0,ew.GS)()?r.createElement(lf.iE,{titleTx:(0,d.tx)("proto.scroll_panel.scroll_behavior_title")}):r.createElement(rw.fI,null,r.createElement(rw.xw,{className:"scroll_behavior_panel--panelTitle--kN-Nl"},(0,d.tx)("proto.scroll_panel.scroll_behavior_title")));return c||p?r.createElement(rf.k,{name:"scroll_behavior_panel"},r.createElement(rw.Zk,null,g,p&&r.createElement(rw.fI,null,r.createElement("div",{className:s0},r.createElement("span",{className:sZ},(0,d.tx)("proto.scroll_panel.position_dropdown.position"))),r.createElement(s6,{recordingKey:as.Pt(e,"scrollBehavior"),dropdownShown:a,disabled:n})),c&&r.createElement(rw.fI,null,r.createElement("div",{className:s0},r.createElement("span",{className:sZ},(0,d.tx)("proto.scroll_panel.overflow_dropdown.overflow"))),m&&r.createElement("div",{className:"scroll_behavior_panel--infoIcon--FeXbf","data-tooltip-type":rM.Ib.SPECIAL,"data-tooltip":E?sq:"HORIZONTAL"===u?sQ:sJ,"data-tooltip-show-immediately":!0},r.createElement(sH.r,null)),r.createElement(s5,{className:m?"scroll_behavior_panel--scrollDirectionShort--w6iSo":"scroll_behavior_panel--scrollDirection--XSmzK",property:u,dispatch:s,dropdownShown:a,onChange:e=>{s((0,io._P)({name:"Overflow Behavior changed",params:{newDirection:e,oldDirection:(0,rl._W)(u,"MIXED")}})),l({scrollDirection:e})},disabled:t||E,recordingKey:as.Pt(e,"scrollDirection")})))):null}let s4=iv.l6,s2=iv.c$,s8=["NONE","HORIZONTAL","VERTICAL","BOTH"];class s5 extends r.PureComponent{render(){return r.createElement(s4,{id:"scroll-direction-select",className:this.props.className,chevronClassName:"scroll_behavior_panel--scrollDirectionChevron--5keRt",inputClassName:"scroll_behavior_panel--scrollDirectionInput--vJSqu",property:this.props.property||"NONE",formatter:iz.Rk,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,disabled:this.props.disabled,recordingKey:this.props.recordingKey,dataTestId:"scroll-direction-dropdown"},s8.map(e=>r.createElement(s2,{key:e,value:e,recordingKey:as.Pt(this.props,e)})))}}s5.displayName="ScrollDirectionDropdown";let s3=iv.l6,s7=iv.c$;function s6(e){let t=(0,o.wA)(),n=(0,sY.kl)("scrollBehavior"),{fixedScrollingDisabled:a}=(0,aY.R)(e=>{let t=e.mirror.selectionProperties;return{fixedScrollingDisabled:!t.nodesAreAllNotInStacksOrAbsolutePositioned||!t.allHaveScrollableFrameAsParent}}),l="scroll-behavior-select",s=e.dropdownShown&&e.dropdownShown.type===l?iz.Ge:iz.wi;return r.createElement(s3,{id:l,className:"scroll_behavior_panel--scrollPosition--YAyUM",formatter:s,property:n||"SCROLLS",onChange:e=>{t((0,io._P)({name:"Node Scroll Behavior Changed",params:{newValue:e}}));let n="FIXED_WHEN_CHILD_OF_SCROLLING_FRAME"===e?i.KjJ.FIXED:"STICKY_SCROLLS"===e?i.KjJ.STICKY_SCROLLS:i.KjJ.SCROLLS;rE.l7.user("set-scroll-behavior",()=>i.X3B.aggressivelySetScrollBehaviorOfSelection(n)),ac.Y5.commit()},dispatch:t,dropdownShown:e.dropdownShown,dropdownClassName:"scroll_behavior_panel--fullWidth--reSmx",recordingKey:e.recordingKey,disabled:e.disabled,dataTestId:"scroll-behavior-dropdown"},r.createElement(s7,{value:"SCROLLS"}),r.createElement(s7,{value:"FIXED_WHEN_CHILD_OF_SCROLLING_FRAME",disabled:a}),r.createElement(s7,{value:"STICKY_SCROLLS"}))}let s9=()=>{let[e]=(0,sY.lJ)("marquee");return!!(0,sW.EA)(e)};var ce=n(105020),ct=n(548183),cn=n(854547),ca=n(654784),cr=n(351731);function co(){return r.createElement(il.u,{idForTests:"create-connection-hint",title:(0,d.t)("proto.onboarding.creating_a_connection"),userFlag:"dismissed_create_connection_hint",icon_DEPRECATED:cn.A,iconFallback:ca.A,hintText:(0,d.t)("proto.onboarding.select_a_frame_or_object_hint")})}function cl(){return r.createElement(il.u,{idForTests:"delete-connection-hint",title:(0,d.t)("proto.onboarding.removing_a_connection"),userFlag:"dismissed_delete_connection_hint",icon_DEPRECATED:ce.A,iconFallback:ct.A,hintText:(0,d.t)("proto.onboarding.to_delete_a_connection_click_and_drag_on_either_end")})}function ci(){return r.createElement(il.u,{idForTests:"play-button-hint",title:(0,d.t)("proto.onboarding.running_your_prototype"),userFlag:"dismissed_play_button_hint",icon_DEPRECATED:cr.A,hintText:(0,d.t)("proto.onboarding.use_the_play_button_hint")})}function cs({dismissedCreateConnectionHint:e,dismissedDeleteConnectionHint:t,dismissedPlayButtonHint:n,numTransitionsOnCurrentPage:a}){let o=0===a&&!e,l=0!==a&&!t,i=!n,s=r.useMemo(()=>o?ee.c.CREATING_A_CONNECTION:l?ee.c.REMOVING_A_CONNECTION:i?ee.c.RUNNING_YOUR_PROTOTYPE:null,[o,l,i]);return s?r.createElement(et.fu,{name:"Prototype Onboarding Hint Panel V1",properties:{trackingDescriptor:s}},r.createElement(rw.Zk,null,r.createElement("div",null,o&&r.createElement(co,null),l&&r.createElement(cl,null),i&&r.createElement(ci,null)))):null}class cc extends r.PureComponent{constructor(){super(...arguments),this.onClickShowPrototypeSettings=()=>{this.props.dispatch((0,io._P)({name:"Show Prototype Settings Clicked"})),e_.wr()}}renderOnboardingPanel(){let e=!!this.props.userFlags.dismissed_create_connection_hint,t=!!this.props.userFlags.dismissed_delete_connection_hint,n=!!this.props.userFlags.dismissed_play_button_hint,a=this.props.selectionProperties.numTransitionsOnCurrentPage;return r.createElement(cs,{dismissedCreateConnectionHint:e,dismissedDeleteConnectionHint:t,dismissedPlayButtonHint:n,numTransitionsOnCurrentPage:a})}renderPrototypeSettingsPanel(){return r.createElement(rf.k,{name:"show_prototype_settings_panel"},r.createElement(rw.Zk,{className:this.props.isUI3?l1.rq:void 0},r.createElement(oH.z,{onClick:this.onClickShowPrototypeSettings,recordingKey:as.Pt(this.props,"prototypeSettingsButton")},(0,d.tx)("proto.menu.show_prototype_settings"))))}renderDevicePanel(){(0,rd.KF)((0,rl.hS)(this.props.selectionProperties.prototypeDevice),"should not have mixed device selection");let e=(0,io.Qx)(this.props.selectionProperties.prototypeDevice);return r.createElement(iO,{key:"device-panel",dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,prototypeBackgroundColor:this.props.selectionProperties.prototypeBackgroundColor,prototypeDevice:e,smallNudgeAmount:this.props.smallNudgeAmount,bigNudgeAmount:this.props.bigNudgeAmount,recordingKey:"devicePanel",isUI3:this.props.isUI3,pickerShown:this.props.pickerShown})}render(){let e=!(0,rl.hS)(this.props.selectionProperties.transitionNodeID)||ir.fn((0,rl.E7)(this.props.selectionProperties.transitionNodeID)),t=this.props.selectionProperties.numSelected??!1,n=!this.props.isSites&&!!this.props.selectionProperties.numVideosSelected,a=this.props.selectionProperties.isInstanceSelected||this.props.selectionProperties.isInstanceSublayerSelected,o=this.props.selectionProperties.isInstanceSublayerSelected,l=!this.props.isSites&&this.props.selectionProperties.prototypeStartingPointsInfo&&this.props.selectionProperties.prototypeStartingPointsInfo.length>0,i=!this.props.isSites&&!e,s=!this.props.isSites&&((this.props.selectionProperties.isValidPrototypingSourceSelected??!0)||this.props.selectionProperties.isSectionSelected&&(0,ii.YR)());if(!t)return r.createElement("div",null,!this.props.isSites&&this.renderDevicePanel(),!this.props.isUI3&&r.createElement(im,{recordingKey:as.Pt(this.props,"backgroundPanel"),prototypeBackgroundColor:this.props.selectionProperties.prototypeBackgroundColor,pickerShown:this.props.pickerShown,dispatch:this.props.dispatch}),l&&r.createElement(li.A,null),!this.props.isSites&&i&&this.renderOnboardingPanel(),r.createElement(oI.Mw,{panelName:oI.ON.PROTOTYPE}));{let e=r.createElement(s1,{dropdownShown:this.props.dropdownShown,disableOverflowBehaviorItem:!!a,disableScrollBehaviorItem:!!o,recordingKey:as.Pt(this.props,"scrollBehaviorPanel"),updateSelectionProperties:ac.Y5.updateSelectionProperties});return r.createElement("div",null,!this.props.isSites&&this.props.selectionProperties.isTopLevelFrameAndValidPrototypeSourceSelected&&r.createElement(sC.A,{recordingKey:as.Pt(this.props,"startingPointPanel")}),s&&r.createElement(su,null),e,n&&r.createElement(sz,{updateSelectionProperties:ac.Y5.updateSelectionProperties,dispatch:this.props.dispatch,videoPlayback:function(e){let{videoMediaLoop:t,videoAutoplay:n,videoMuted:a,numVideosSelected:r}=e;return(0,rd.B1)(t),(0,rd.B1)(n),(0,rd.B1)(a),(0,rd.B1)(r),{autoplay:n,muted:a,mediaLoop:t,numVideosSelected:r}}(this.props.selectionProperties),recordingKey:as.Pt(this.props,"prototypeVideoPlaybackPanel")}),!this.props.isSites&&this.renderPrototypeSettingsPanel(),i&&this.renderOnboardingPanel(),r.createElement(oI.Mw,{panelName:oI.ON.PROTOTYPE}),r.createElement("div",null))}}}cc.displayName="PrototypePanel";let cd=(0,et.kp)(function(e){let t=(0,er.p8)("currentTool"),n=(0,er.p8)("activeCanvasEditModeType"),{bigNudgeAmount:a,smallNudgeAmount:o}=(0,aJ.sT)(),l=(0,ew.GS)(),i=(0,ia.cJ)();return r.createElement(cc,{...e,bigNudgeAmount:a,smallNudgeAmount:o,isUI3:l,isSites:i,currentTool:t,editModeType:n})},lo.e0.PROTOTYPE_PANEL);function cp({colorFormat:e,dropdownShown:t,expandedFramePresetType:n,library:a,pickerShown:l,sceneGraphSelection:s,selectedStyleProperties:c,selectionProperties:d,shownPanels:p,userFlags:m}){let u=(0,o.wA)(),E=(0,eo.q5)(),g=(0,ia.cJ)(),y=(0,re.RB)(c)?c:d,_=!p[i.ibQ.FRAME_PRESETS]&&!p[i.ibQ.PENCIL_TOOL]&&!y.containsResponsiveSets;return r.createElement(rn.i,null,r.createElement(ra.VF,{isVisible:p[i.ibQ.FRAME_PRESETS]},()=>r.createElement(rr.nl,{key:"frame-presets",recordingKey:"framePresetPanel",dispatch:u,expandedFramePresetType:n})),!g&&r.createElement(ra.VF,{isVisible:p[i.ibQ.PENCIL_TOOL]},()=>r.createElement(ro.q,{id:"pencilToolPanel",key:"pencilToolPanel",recordingKey:"pencilToolPanel",openFile:E})),r.createElement(ra.VF,{isVisible:_},()=>r.createElement(cd,{key:"prototype",recordingKey:"prototypePanel",dispatch:u,selectionProperties:y,pickerShown:l,dropdownShown:t,colorFormat:e,sceneGraphSelection:s,library:a,openFile:E,userFlags:m})))}function cm({scrollContainer:e,refMainScrollContainer:t,...n}){(0,lr.S2)();let a=(0,aQ.F)(),o=n.propertiesPanelTab,l=(0,er.p8)("topLevelMode"),c=(0,er.p8)("isReadOnly"),d=(0,re.Dj)(n.user),p=l!==i.lyf.PREVIEW&&(l!==i.lyf.BRANCHING||!d)&&l!==i.lyf.DEV_HANDOFF&&o===i.FAf.DESIGN,m=l!==i.lyf.PREVIEW&&l!==i.lyf.BRANCHING&&o===i.FAf.PROTOTYPE,u=l===i.lyf.PREVIEW&&!n.userStateLoaded&&!a||o===i.FAf.INSPECT,E=(0,s.kc)().livefish&&l===i.lyf.LAYOUT&&!c&&o===i.FAf.LIVING_DESIGNS,g=o===i.FAf.EXPORT,y=o===i.FAf.COMMENT;return r.createElement(r.Fragment,null,p&&r.createElement(lt,{scrollContainer:e,...n}),m&&r.createElement(cp,{colorFormat:n.colorFormat,dropdownShown:n.dropdownShown,expandedFramePresetType:n.expandedFramePresetType,library:n.library,pickerShown:n.pickerShown,sceneGraphSelection:n.sceneGraphSelection,selectedStyleProperties:n.selectedStyleProperties,selectionProperties:n.selectionProperties,shownPanels:n.shownPanels,userFlags:n.userFlags}),u&&r.createElement(ls,{scrollContainer:e,selectionProperties:n.selectionProperties}),E&&r.createElement(ie,null),g&&r.createElement(la,{dropdownShown:n.dropdownShown,pickerShown:n.pickerShown,saveAsState:n.saveAsState,sceneGraphSelection:n.sceneGraphSelection,selectedStyleProperties:n.selectedStyleProperties,selectionProperties:n.selectionProperties}),y&&r.createElement(n.commentsPanel,null))}function cu(e){!function(){let e="ui3"===(0,a5.DP)().version,{isPropertiesPanelCollapsed:t,setPropertiesPanelCollapsed:n}=(0,a3.iT)(),a=(0,eZ.Ye)(),l=(0,aX.ow)(),s=(0,er.ax)(),c=(0,er.dH)(),d=c===i.NLJ.FRAME||c===i.NLJ.COMMENTS||c===i.NLJ.VECTOR_PENCIL,p=(0,o.d4)(e=>e.mirror.appModel.activeUserAction===i.QOV.DEFAULT),m=(0,a3.ys)();(0,r.useEffect)(()=>{e&&p&&!l&&t&&(d||s)&&n(!1)},[s,p,c,e,n,t,a,d,l]),(0,r.useEffect)(()=>{m&&n(!0)},[m,n,t])}();let t=null,n=e=>{t=e};return r.createElement(it.j,{recordingKey:e.recordingKey,activeTab:e.propertiesPanelTab,refMainScrollContainer:n},r.createElement(cm,{...e,scrollContainer:t,refMainScrollContainer:n}))}var cE=n(991161),cg=n(692326),cy=n(480117),c_=n(282268);let ch=r.memo(function(){let e=(0,aY.R)(e=>(0,a0.getPermissionsState)(e)),t=(0,er.aV)(),n=(0,o.d4)(e=>e.loadingState),a=(0,y.md)(a1.wm),l=(0,o.d4)(e=>e.mirror.sceneGraphSelection),c=(0,o.d4)(e=>e.mirror.selectionPaints),d=(0,o.d4)(e=>e.mirror.selectionProperties),p=(0,o.d4)(e=>e.mirror.selectedStyleProperties),m=(0,o.d4)(e=>e.currentUserOrgId),u=(0,o.d4)(e=>e.dropdownShown),E=(0,o.d4)(e=>e.fonts),g=(0,o.d4)(e=>e.fileVersion),_=(0,o.d4)(e=>e.installedPluginVersions),h=(0,o.d4)(e=>e.library),f=(0,o.d4)(e=>e.localPlugins),v=(0,o.d4)(e=>e.modalShown),b=(0,o.d4)(e=>e.multiplayer),S=(0,o.d4)(e=>e.openFile),T=(0,o.d4)(e=>e.pickerShown),N=(0,o.d4)(e=>e.pickerInStyleCreationShown),I=(0,o.d4)(e=>e.publishedPlugins),P=(0,o.d4)(e=>e.saveAsState),C=(0,o.d4)(e=>e.selectedView),k=(0,o.d4)(e=>e.voice.showWidget),A=(0,o.d4)(e=>e.stylePickerListLayout),w=(0,o.d4)(e=>e.stylePickerShown),O=(0,o.d4)(e=>e.stylePreviewShown),x=(0,o.d4)(e=>e.styleSets),R=(0,o.d4)(e=>e.usedKeyboardShortcuts),L=(0,o.d4)(e=>e.user),D=(0,o.d4)(e=>e.userFlags),M=(0,o.d4)(e=>e.userStateLoaded),K=(0,o.d4)(e=>e.repos),F=(0,o.d4)(e=>e.folders),V=(0,o.d4)(e=>e.teams),U=(0,o.d4)(e=>e.orgById),B=(0,o.d4)(e=>e.orgUsersByOrgId),G=(0,o.d4)(e=>e.userEduGracePeriods),z=(0,o.d4)(e=>e.licenseGroups),W=(0,ew.GS)(),H=(0,aX.my)()===a4.nT.Design,Y=(0,aQ.F)(),$=(0,aZ.VP)(n,"edit_button_upgrading_to_edit"),X=t||$,j=(0,eS.ut)((0,e_.aY)(),i.FAf.DESIGN),Q=(0,eS.J2)(i.Ez5.propertiesPanelState().shownPropertiesPanels),J=(0,eS.J2)(i.Ez5.propertiesPanelState().strokePanelMode),q=(0,eS.J2)(i.Ez5.propertiesPanelState().strokePanelTerminalPointCount),Z=(0,eS.J2)((0,aJ.UK)().expandedFramePresetType),ee=(0,aJ.Ku)(),et=(0,aJ.qw)(),en=(0,aj.b)(),ea=(0,eS.J2)(i.Ez5.uiState().showPropertiesPanel),eo=!(0,a$.Oo)()&&W&&ea,el=(0,eS.J2)((0,aJ.UK)().renderRulers),{isRightPanelCollapsed:ei}=(0,r.useContext)(a2.t),{inProductHelpViewType:es}=(0,a8.A5)(),ec=(0,eS.J2)(i.Ez5.uiState().inProductHelpSidePanelWidth),ed=(0,aq.Tn)(),ep=(0,aq.qM)(),em=(0,r.useMemo)(()=>Y?i.FAf.COMMENT:j,[j,Y]);return(0,r.useEffect)(()=>{em!==j&&e_.aY()?.set(em)},[em,j]),r.createElement(c_.o,{boundaryKey:"PropertiesPanel",loggedOutDesktopRevampExpAvaialable:H},r.createElement(cu,{recordingKey:"propertiesPanel",isCollapsed:ei,propertiesPanelTab:em,strokePanelMode:J,strokePanelTerminalPointCount:q,commentsPanel:cy.L,isLoading:X,shouldAnimateLoadingState:t,shouldShowBackgroundGradient:eo,shownPanels:Q,rulersVisible:el,isInsetEditorEnabled:en,expandedFramePresetType:Z,colorFormat:ee,propertiesPanelSplitPosition:et,permissionsState:e,key:(0,tz.tw)()??void 0,sceneGraph:a,sceneGraphSelection:l,selectionPaints:c,selectionProperties:d,selectedStyleProperties:p,currentUserOrgId:m,dropdownShown:u,fonts:E,fileVersion:g,allSavedPlugins:_,library:h,localPlugins:f,modalShown:v,multiplayer:b,openFile:S,pickerShown:T,pickerInStyleCreationShown:N,publishedPlugins:I,saveAsState:P,selectedView:C,stylePickerListLayout:A,stylePickerShown:w,stylePreviewShown:O,styleSets:x,usedKeyboardShortcuts:R,user:L,userFlags:D,userStateLoaded:M,repos:K,folders:F,teams:V,orgById:U,orgUsersByOrgId:B,userEduGracePeriods:G,licenseGroups:z,isUI3:W,showVoiceWidget:k,hasMergedDimensionsAndAutolayout:W,inProductHelpViewType:es,inProductHelpSidePanelWidth:ec,justChangedMinimizeUIValue:ed,isUIMinimized:ep}),(0,s.kc)().asset_binding_picker?r.createElement(cg.lD,null):r.createElement(cE.tZ,null))});var cf=n(637638),cv=n(987711),cb=n(55934),cS=n(312028),cT=n(114181),cN=n(90430),cI=n(831049),cP=n(412634),cC=n(55048),ck=n(766307),cA=n(485075),cw=n(413481);let cO="stack_controls--input--gK1jo text--fontNeg12--2PWcg text--_fontBase--QdLsd text--_negText--j9g-L",cx="stack_controls--scrubbableControl--b1ChI",cR="stack_controls--inputSvg--wFizL",cL="stack_controls--stackSpacingRow--Uus3H";function cD(){let e=(0,eS.J2)(i.Ez5.canvasViewState().focusedStackRegion);if(!e)return null;let{region:t,focus:n}=e;return t===i.RN9.SPACING?r.createElement(cK,{focusOnMount:n}):t===i.RN9.COUNTER_SPACING?r.createElement(cF,{focusOnMount:n}):r.createElement(cV,{stackRegion:t,focusOnMount:n})}let cM=e=>{if(e.keyCode===rK.Uz.TAB){e.preventDefault(),e.currentTarget.blur();let t=e.shiftKey;i.Qa7.tabActiveStackRegion(t)}};function cK({focusOnMount:e}){return r.createElement(rw.fI,{className:cL},r.createElement(cw.KI,{focusOnMount:e,outerClassName:cx,inputClassName:cO,svgClassName:cR,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:cM,onPaste:cU,noBorderOnFocus:!0,recordingKey:"stackSpacingControl",inputTestId:"stackSpacingControl",source:"canvas",onCanvasUI:!0}))}function cF({focusOnMount:e}){return r.createElement(rw.fI,{className:cL},r.createElement(cC.q,{focusOnMount:e,outerClassName:cx,inputClassName:cO,svgClassName:cR,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:cM,onPaste:cU,noBorderOnFocus:!0,recordingKey:"stackCounterSpacingControl",inputTestId:"stackCounterSpacingControl",source:"canvas",onCanvasUI:!0}))}function cV({stackRegion:e,focusOnMount:t}){let[n]=(0,cA.HF)(e),a=Array.isArray(n)?n.length:0;return e===i.RN9.SPACING?null:r.createElement(rw.fI,{className:eG()("stack_controls--stackPaddingRow--40WUa",{"stack_controls--large--bJFUN":a>3})},r.createElement(ck.s,{paddingSelection:e,focusOnMount:t,outerClassName:cx,inputClassName:cO,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:cM,onPaste:cU,noBorderOnFocus:!0,svgClassName:cR,recordingKey:"stackPaddingControl",inputTestId:"stackPaddingControl",source:"canvas",disableVariablesEntryPoint:!0}))}function cU(e){(0,cP.gk)(e)&&(e.preventDefault(),e.currentTarget.blur(),rE.l7.user("paste-in-stack",()=>{i.glU.triggerAction("paste",{})}))}let cB=r.memo(function(){return(0,o.d4)(e=>e.mirror.appModel.isReadOnly)?null:r.createElement(cG,null)});function cG(){return r.createElement(cb.k,{isShown:!0},r.createElement(cN.IA,null,r.createElement(cz,{testID:"DesignInlineMenu"})))}function cz({testID:e}){let t=(0,o.d4)(e=>{let t=e.mirror.selectionProperties.stackMode;return 1===e.mirror.selectionProperties.numSelected&&("HORIZONTAL"===t||"VERTICAL"===t)});return(0,o.d4)(e=>{let t=e.mirror.selectionProperties.selectedWidgetInfo;return!!(1===e.mirror.selectionProperties.numSelected&&t?.propertyMenu.length)})?r.createElement(cI.W1,{size:"small",testID:e},r.createElement(cS.jk,null),r.createElement(cT.x,null)):t?r.createElement(cI.W1,{testID:e,darkModePreferred:!0},r.createElement(cD,{key:"stackControls"})):null}var cW=n(497233),cH=n(344903),cY=n(762568),c$=n(994719),cX=n(10336),cj=n(202592),cQ=n(612091),cJ=n(206744),cq=n(520493),cZ=n(11396),c0=n(754468),c1=n(296027),c4=n(102774),c2=n(996390),c8=n(588684),c5=n(249064),c3=n(778566),c7=n(949824),c6=n(279625),c9=n(236121);function de(){let e=(0,o.wA)(),t=(0,o.d4)(e=>!!e.modalShown),n=(0,o.d4)(e=>e.versionHistory.compareId),a=i.AWq.getChunkChangeCount(),l=(0,S.Z)("chunk_change_navigator_navigate"),s=(0,c7.E)(),c=r.useCallback(e=>{i.Egt.setSelectedNodeAndCanvas(e,!0),l((0,N.QZ)({nodeId:e,...c9.ob}),c9.kh),s(e)},[l,s]),p=r.useCallback(e=>{t||0===a||("ArrowUp"===e.key||"ArrowLeft"===e.key||e.shiftKey&&"Tab"===e.key?c(i.glU.navigateToNextChange(-1)):("ArrowDown"===e.key||"ArrowRight"===e.key||"Tab"===e.key)&&c(i.glU.navigateToNextChange(1)))},[t,a,c]);return(r.useEffect(()=>{e(c3.Q.dequeue({type:c5._.SEE_WHATS_CHANGED}))},[e]),r.useEffect(()=>{n&&0!==a&&c(i.glU.navigateToFirstVisibleOrClosestChange())},[a,n,c]),r.useLayoutEffect(()=>{if(0!==a)return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[a,p]),0===a)?null:r.createElement(r.Fragment,null,r.createElement("div",{className:"chunk_change_navigator--chunkChangeCount--ZFnfP"},(0,d.tx)("collaboration.feedback.change_count",{changeCount:a})),r.createElement("div",{className:"chunk_change_navigator--chunkChangeNavigator--82303"},r.createElement(c6.K0,{svg:n6.A,onClick:e=>{e.stopPropagation(),c(i.glU.navigateToNextChange(-1))},"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("collaboration.feedback.previous_change"),recordingKey:"change_stepper.previous",disabled:0===a}),r.createElement(c6.K0,{svg:n7.A,onClick:e=>{e.stopPropagation(),c(i.glU.navigateToNextChange(1))},"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("collaboration.feedback.next_change"),recordingKey:"change_stepper.next",disabled:0===a})))}var dt=n(49596),dn=n(126049),da=n(669260),dr=n(950521),dl=n(323649),di=n(458806),ds=n(774619),dc=n(939501),dd=n(792250),dp=n(481822),dm=n(606131),du=n(573545),dE=n(885153),dg=n(41453),dy=n(545456),d_=n(977251),dh=n(633540),df=n(719900),dv=n(790566),db=n(485234),dS=n(551141);function dT({searchOptions:e,keyboardNavigationPath:t,keyboardNavigationColumn:n}){let a=(0,o.wA)(),l=(0,o.d4)(dv.UQ),{activeTab:s,shouldFocusSearchBar:c}=(0,o.d4)(e=>e.leftPanel),p=s===i.xae.ASSETS,m=r.useRef(null),u=(0,o.d4)(e=>e.mirror.appModel.activeCanvasEditModeType),E=(0,db.vb)({isVisible:p,autofocus:!0,selectOnFocus:!0,ref:m});r.useEffect(()=>{let e=e=>{(df.Ay.chromeos?e.altKey&&e.shiftKey&&e.keyCode===rK.Uz.KEY_2:e.altKey&&e.keyCode===rK.Uz.KEY_2)&&u!==i.m1T.TEXT&&(E(),e.preventDefault())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[u,E]);let g=r.useCallback(t=>{let n;e&&((0,dv.eu)(e.type)?n=e.type:(n={type:dS.I.ALL},e.onSetAssetType(n))),a(rb.ku({query:t,searchOptions:n,entryPoint:"asset_panel"}))},[a,e]),y=eG()("component_sidebar_search--searchWithViewModeToggle--nKJ2-","component_sidebar_search--negMargin--QTfpB");return null!=t?r.createElement(db.E1,{query:l.query,onChange:g,isVisible:p,className:y,recordingKey:"componentsLibrarySearch",placeholder:(0,d.t)("design_systems.assets_panel.search"),autofocus:c,selectOnFocus:!0,hideSearchIcon:!0,entryPointForTracking:"editor:assets_panel",path:t,column:n,forwardedRef:m}):r.createElement(db.aU,{query:l.query,onChange:g,isVisible:p,className:y,recordingKey:"componentsLibrarySearch",placeholder:(0,d.t)("design_systems.assets_panel.search"),autofocus:c,selectOnFocus:!0,hideSearchIcon:!0,forwardedRef:m,entryPointForTracking:"editor:assets_panel"})}var dN=n(513896),dI=n(35645),dP=n.n(dI),dC=n(247295),dk=n(937648),dA=n(517147),dw=n(647942),dO=n(296463),dx=n(749315),dR=n(55777),dL=n(837177),dD=n(997996);function dM(e){let{assetType:t,libraryNameByFileKey:n,fileKeyToLibraryKey:a,onSetAssetType:l,onSetKeyboardNavigationElement:i,validAssetTypeOptions:s}=e,c=(0,o.wA)(),p=(0,o.d4)(e=>e.modalShown),m=(0,o.d4)(e=>e.dropdownShown),u=(0,o.d4)(eo.tB),E=t.type===dS.I.FILE?t.fileKey:void 0,g=(0,dw.Fl)(),y=r.useCallback(()=>{p?.type===dD.V&&c(lg.AS()),ez.az.trackDefinedEvent("assets_panel.asset_type_dropdown_opened",{fileKey:u?.key,assetsPanelVersion:2})},[c,p,u?.key]),_=r.useMemo(()=>{if((0,dx.NX)(g)){let e=Object.entries(n??{}).map(([e,t])=>({key:e,name:t,library_key:a[e]}));return(0,dx.k9)({libraries:e,approvedLibraryKeysByResourceType:g}),e.map(({key:e})=>e)}return Object.keys(n??{}).sort((e,t)=>dC.f.LEXICOGRAPHICALLY(n[e],n[t]))},[n,g,a]),h=(0,dc.Ck)(),[f,v]=dP()(_,e=>!(0,dA.wJ)(e)),b=v.length>0&&h(),S=r.useMemo(()=>({format:e=>{switch(e.type){case dS.I.RECENT:return(0,d.t)("design_systems.assets_panel.dropdown_type_recents");case dS.I.ALL:return(0,d.t)("design_systems.assets_panel.dropdown_type_all_libraries");case dS.I.LOCAL:return(0,d.t)("design_systems.assets_panel.created_in_this_file");case dS.I.FILE:return n[e.fileKey];case dS.I.SITE_KIT:return""}},isEqual:dK}),[n]);return r.createElement(iv.l6,{className:"sidebar_asset_type_select--select--PTmwH",id:"component-sidebar-asset-type-select",property:t,formatter:S,onChange:l,dropdownAlignment:"left",openOnKeyPressed:[rK.Uz.SPACE,rK.Uz.ENTER],inputRef:i,dispatch:c,chevronClassName:"sidebar_asset_type_select--chevron--xyZLx",inputClassName:"sidebar_asset_type_select--input--sSEn2",dropdownShown:e.useLocalState?e.dropdownShown:m,dropdownWidth:260,onShowDropdown:y,onShowDropdownOverride:e.useLocalState?e.onShowDropdownOverride:void 0,onHideDropdownOverride:e.useLocalState?e.onHideDropdownOverride:void 0,rightIcon:r.createElement(dL.P,{resourceId:E,libraryKey:E?(0,dk.$)(E):void 0})},!!s[dS.I.ALL]&&r.createElement(iv.c$,{value:{type:dS.I.ALL}}),!!s[dS.I.RECENT]&&r.createElement(iv.c$,{value:{type:dS.I.RECENT}}),!!s[dS.I.LOCAL]&&r.createElement(iv.c$,{value:{type:dS.I.LOCAL}}),f.length>0?r.createElement(iv.sK,null):null,f.length>0?r.createElement(iv.c$,{isHeader:!0,formattedValue:u?.org?.name?(0,d.t)("design_systems.assets_panel.dropdown_org_libraries",{orgName:u.org.name}):(0,d.t)("design_systems.assets_panel.dropdown_libraries")}):null,f.map(e=>(0,dx.sF)(a[e])?r.createElement(iv.c$,{key:e,value:{type:dS.I.FILE,fileKey:e},removeTextRightPadding:!0,rightSettingsIcon:r.createElement(dO.FX,null)}):r.createElement(iv.c$,{key:e,value:{type:dS.I.FILE,fileKey:e},fullWidth:!0})),b?r.createElement(iv.sK,null):null,b?r.createElement(iv.c$,{isHeader:!0,formattedValue:(0,d.t)("design_systems.assets_panel.dropdown_curated_libraries")}):null,b&&v.map(e=>r.createElement(iv.c$,{key:e,value:{type:dS.I.FILE,fileKey:e},removeTextRightPadding:!0,rightSettingsIcon:r.createElement(dR.t,null)})))}function dK(e,t){return e.type===dS.I.FILE&&t.type===dS.I.FILE?e.fileKey===t.fileKey:e.type===t.type}var dF=n(280999),dV=n(731719);function dU({disabled:e,isList:t,onSetKeyboardNavigationElement:n,onToggleViewMode:a,recordingKey:o}){let l=t?(0,d.t)("design_systems.assets_panel.show_as_grid"):(0,d.t)("design_systems.assets_panel.show_as_list");return r.createElement(c6.K0,{ref:n,recordingKey:as.Pt(o,"toggleComponentsSidebarViewMode"),"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":l,svg:t?dF.A:dV.A,onClick:a,disabled:e})}var dB=n(210890),dG=n(966491),dz=n(897214);let dW=(0,dz.Wh)(()=>(0,lb.eU)(0)),dH=(0,dz.Wh)(()=>(0,lb.eU)(nf.Bk.Grid));var dY=n(940788),d$=n(279159);function dX(e,t,n){return null!=e&&(t[e.type]||e.type===dS.I.FILE&&n[e.fileKey])?e:{type:dS.I.ALL}}var dj=n(258214),dQ=n(89865),dJ=n.n(dQ),dq=n(780278),dZ=n(169348),d0=n(670034),d1=n(64051),d4=n(436735),d2=n(422335);let d8="searchResults";function d5(e,t){return`${t}:${e.key}`}function d3(e){return`${e}:${d8}:templates`}function d7(e){return`${e}:recentlyUsed`}function d6(e){return`${e}:stickySection`}var d9=n(565407),pe=n(537977),pt=n(870501),pn=n(898499),pa=n(615832),pr=n(390816),po=n(45899),pl=n(992243),pi=n(333713),ps=n(822565),pc=n(733562),pd=n(548810),pp=n(267361),pm=n(893177),pu=n(603111),pE=n(981702),pg=n(471069),py=n(408938);let p_=(0,pt.fv)();function ph({asset:e,fileName:t,sourceForTracking:n,thumbHeight:a,thumbLayout:l,thumbWidth:i,viewMode:c,sectionNameForTracking:d,sectionPosition:p,noFlyout:m,preventDrag:u,disableContextMenu:E}){let g=(0,o.wA)(),_=(0,o.d4)(e=>e.dropdownShown),h=(0,o.d4)(iY.dK),f=(0,o.d4)(np.F9),v=(0,o.d4)(np.e_),b=(0,y.md)(ps.T),S=v.assetsPanelSearch.searchOptions?.type===dS.I.ALL,T=r.useMemo(()=>p_(e),[e]),N=(0,dw.fV)(e.library_key),I=(0,pl.E_)(T),P=S&&(N||I),C=r.useRef(null),k=(0,rI.kH)(e.name),A=(0,pa.NG)({text:k,textRef:C}),w=r.useRef(null),O=(0,pa.NG)({text:t??"",textRef:w}),x=_?.type===pu.K.ASSETS_PANEL?_?.data?.component:void 0,R=x?.node_id===e.node_id,L=c===nf.Bk.List,D=L?"list-no-padding":"grid",M=!!v.assetsPanelSearch.query,K=(0,pd.F)(e,pu.K.ASSETS_PANEL,p,d),F=(0,pc.n)(e),V=(0,rg.ZC)(F),U=!m;r.useEffect(()=>{F&&!V&&g(po.jD())},[F,g,V]);let B=e.isLocal&&(0,tz.PN)()?(0,pE.eT)(e.node_id,h).join("-"):e.node_id,G="Local components"===d||"Local private components"===d||e.isLocal,z=l!==nh.rp.SMALL&&!L,W=!L&&(0,s.kc)().api_asset_search_with_scores,H=(0,pp.Y)(e),Y=L?a:a-2,$=L?i:i-2,X=r.useMemo(()=>u?void 0:{sourceForTracking:n,clickToInsert:!1,afterSuccessfulInsert:pi.$z,sectionNameForTracking:d},[u,d,n]),j=G?r.createElement(pm.MT,{item:e,height:Y,width:$,draggable:X,buttonProps:{onContextMenu:E?void 0:K},shouldHideTooltip:U||R||F,isFilePublished:f,recordingNodePath:B,isSearch:M,useBaseTile:!0,hideNameOverlay:z,numVariants:H,displayType:D,sectionPosition:p,showTooltipImmediately:!1,fileName:A||O?t:void 0,alwaysShowBorder:!0}):r.createElement(pm.lX,{item:e,showName:!0,height:Y,width:$,draggable:X,buttonProps:{onContextMenu:E?void 0:K},shouldHideTooltip:U||R||F,recordingNodePath:B,isSearch:M,useBaseTile:!0,hideNameOverlay:z,numVariants:H,displayType:D,sectionPosition:p,showTooltipImmediately:!1,fileName:A||O?t:void 0,alwaysShowBorder:!0});return r.createElement("div",{className:L?pg.AD:pg.iE},L?j:r.createElement("div",{className:eG()(pg.QX,{[pg.Gr]:F,[pg.HR]:F&&b})},j),z&&r.createElement("div",{role:"button",className:pg.Bm,style:{width:i}},r.createElement("span",{className:pg.UU,ref:C},k),U&&r.createElement(nH.B,{ariaHidden:!0,className:pg.OW,svg:py.A})),z&&!!t&&r.createElement(pr.Y,{spacing:0,direction:"horizontal"},r.createElement("div",{className:eG()(pg.Md,pg.Rm),ref:w,style:P?{maxWidth:i-dL.J}:{width:i}},t),P&&r.createElement(dL.P,{resourceId:T,libraryKey:e.library_key,showPresetTooltip:!0,tooltipDelay:500,tooltipLocation:"below",compact:!0})),W&&r.createElement(r.Fragment,null,r.createElement("div",{className:eG()(pg.Md,pg.Rm),style:P?{maxWidth:i-dL.J}:{width:i}},"AI: "+(e.ai_score??"N/A")),r.createElement("div",{className:eG()(pg.Md,pg.Rm),style:P?{maxWidth:i-dL.J}:{width:i}},"Lex: "+(e.lexical_score??"N/A"))),U&&L&&r.createElement(nH.B,{ariaHidden:!0,className:pg.Ki,svg:py.A}))}var pf=n(113218),pv=n(110393);let pb="library_section_header--sectionHeaderH1--P70zQ ellipsis--ellipsis--Tjyfa",pS="library_section_header--sectionHeader3_redesign--TGISe ellipsis--ellipsis--Tjyfa",pT="library_section_header--sectionHeaderH3--5VrMz ellipsis--ellipsis--Tjyfa",pN=e=>"isExpandable"in e&&e.isExpandable,pI=(e,t)=>{switch(e){case pb:return t?"library_section_header--sectionHeaderDivider--SdrS5 ellipsis--ellipsis--Tjyfa":"library_section_header--sectionHeader1_redesign--cWZaj ellipsis--ellipsis--Tjyfa";case pT:return pS;default:return"library_section_header--sectionHeader3_normal--bf4ra"}},pP=e=>{let t=[];if(e&&e.length){t.push(r.createElement("div",{className:"library_section_header--sectionHeader1_sticky--mZ4QY ellipsis--ellipsis--Tjyfa",key:e[0]},e[0]+" / ","\xa0"));let n=e.slice(1).join(" / ");t.push(r.createElement("div",{className:pS,key:n},n,"\xa0"))}return t};class pC extends r.Component{componentDidUpdate(e){pN(this.props)&&pN(e)&&e.isExpanded!==this.props.isExpanded&&"h1"===this.props.size&&(0,eX.YQ)({id:"library_section_header_toggled"})}render(){let e="h1"===this.props.size?pb:pT,t=pN(this.props)?"library_section_header--sectionHeaderExpandable--hHEFq":"",n=pI(e,this.props.shouldShowDividerLine),a=pN(this.props)&&this.props.isFixed?"library_section_header--isFixed--eVHns":"";return r.createElement(et.fu,{name:"Section Header",properties:{title:this.props.title,isExpanded:!!pN(this.props)&&this.props.isExpanded},trackingTargets:pf.K.RCS},r.createElement("div",{className:eG()(n,e,t,a)},pN(this.props)&&r.createElement(nH.B,{className:this.props.isExpanded?"library_section_header--expandCaretOpen--083vU library_section_header--expandCaret--20Tzs object_row--expandCaret--f1MjE object_row--indent--uZlad":"library_section_header--expandCaret--20Tzs object_row--expandCaret--f1MjE object_row--indent--uZlad",svg:this.props.isExpanded?rW.A:rH.A}),pN(this.props)&&this.props.breadcrumbPath&&!this.props.isFixed&&r.createElement("div",{className:"library_section_header--breadcrumbPath--Jevbg"},this.props.breadcrumbPath,"\xa0"),pN(this.props)&&this.props.isFixed&&this.props.stickyHeadertokens&&this.props.stickyHeadertokens.length?pP(this.props.stickyHeadertokens):r.createElement("div",{className:n},this.props.title),(0,dx.sF)(this.props.subscribedLibraryKey)&&r.createElement("div",{className:W.cx.flex.alignCenter.justifyCenter.ml4.$},r.createElement(dO.KP,{libraryKey:this.props.subscribedLibraryKey})),((0,pl.TX)(this.props.subscribedFileKey)||(0,pl.Ag)(this.props.subscribedFileKey))&&r.createElement("div",{className:W.cx.flex.alignCenter.justifyCenter.ml4.$},r.createElement(dR.E,{hubFileId:this.props.subscribedFileKey,showTooltip:!0,redirectToHubFile:!0}))))}}pC.H1_HEIGHT=(0,nK.hG)(pv.BS),pC.H3_HEIGHT=(0,nK.hG)(pv.T);class pk extends r.Component{render(){return r.createElement("div",{className:12===this.props.size?"library_section_header--spacer12--0h1Dt":"library_section_header--spacer16--iPkYc"})}}pk.HEIGHT=(0,nK.hG)(pv.FX);let pA="component_sidebar--stickyHeaderSpacer--SaKsM",pw=(0,nK.hG)(pv.FX),pO=(0,nK.hG)(pv.FX)/2,px=(0,nK.hG)(pv.Nz),pR=(0,nK.hG)(pv.cP),pL=(0,pt.fv)();function pD({parent:e,outputElements:t,libraryNameByResourceId:n,items:a,keyPrefix:o,sharedOptions:l,sectionNameForTracking:i}){let c=(0,nh.PI)(a,!0),d={layout:c,...l},p=(0,nh.A5)(d),{width:m,height:u}=(0,nh.rj)(d,p),E=l.isList?1:0,g=l.isList?0:px,y=l.isList||!n?0:pR,_=u+(l.isList?pO:pw)+g+y+E+(l.isList?0:-2);(0,s.kc)().api_asset_search_with_scores&&(_+=2*(0,nK.hG)(pv.uY));let h=m+(l.isList?pO:pw)+(l.isList?0:-2),f=0,v=pe.oz.getNextRenderedElementTop(t)+pO;for(let[d,E]of a.entries()){let a;let g=l.isList?v+f*_:v+Math.floor(f/p)*_,y=l.isList?0:3+f%p*h,b=(0,pn.V)(E),S=pL(E),T=S?n?.[S]:void 0;a=(0,s.kc)().asset_search_return_file_name&&E.file_name?E.file_name:T,t.push({parent:e,type:pe.zq.TILE,top:g,left:y,height:_,key:`${o}:${b}`,element:function({item:e,fileName:t,sourceForTracking:n,sectionNameForTracking:a,thumbLayout:o,thumbHeight:l,thumbWidth:i,isList:s,sectionPosition:c}){return r.createElement(ph,{asset:e,fileName:t,sourceForTracking:n,sectionNameForTracking:a,thumbLayout:o,thumbHeight:l,thumbWidth:i,viewMode:s?nf.Bk.List:nf.Bk.Grid,sectionPosition:c})}({containerWidth:l.containerWidth,fileName:a,sourceForTracking:l.sourceForTracking,sectionNameForTracking:i,thumbLayout:c,thumbHeight:u,thumbWidth:m,isList:l.isList,item:E,isExpanded:l.isExpanded,sectionPosition:d}),item:E,numCols:p,containerWidth:l.containerWidth,sectionNameForTracking:i,sectionPosition:d}),f+=1}}let pM=(e,t,n)=>{let a=d6(n.keyPrefix),o=pe.oz.getNextRenderedElementTop(t),l={parent:e,type:pe.zq.ROW,top:o,height:"h1"==n.size?pC.H1_HEIGHT:pC.H3_HEIGHT,key:a,element:r.createElement(pC,{size:n.size,isExpandable:!0,isExpanded:n.isExpanded,title:n.title,breadcrumbPath:n.breadcrumbPath?n.breadcrumbPath:null,stickyHeadertokens:n.stickyHeaderTokens?n.stickyHeaderTokens:void 0,isFixed:!1,subscribedFileKey:n.subscribedFileKey,subscribedLibraryKey:n.subscribedLibraryKey}),isSticky:!0,isFixed:!1,children:[],isExpandable:!0,isExpanded:n.isExpanded,getExpandableElement:e=>r.createElement(pC,{size:n.size,isExpandable:!0,isExpanded:e,title:n.title,breadcrumbPath:n.breadcrumbPath?n.breadcrumbPath:null,stickyHeadertokens:n.stickyHeaderTokens?n.stickyHeaderTokens:void 0,subscribedFileKey:n.subscribedFileKey,subscribedLibraryKey:n.subscribedLibraryKey}),sectionNameForTracking:n.sectionNameForTracking,rowType:n.rowType,fixedElement:r.createElement(r.Fragment,null,r.createElement("div",{className:pA}),r.createElement(pC,{size:"h1",isExpandable:!0,isExpanded:n.isExpanded,title:n.title,breadcrumbPath:n.breadcrumbPath?n.breadcrumbPath:null,stickyHeadertokens:n.stickyHeaderTokens?n.stickyHeaderTokens:void 0,isFixed:!0,subscribedFileKey:n.subscribedFileKey,subscribedLibraryKey:n.subscribedLibraryKey}))};return t.push(l),l};function pK({sectionHeaderText:e,isFixed:t}){return r.createElement("div",{className:eG()("component_sidebar--sectionHeader--v0N1h",t?"component_sidebar--isFixed--orinE":"")},r.createElement("div",{className:"component_sidebar--sectionHeaderText--hDKu5"},e))}function pF(e,t,n){let a=pe.oz.getNextRenderedElementTop(e),o={key:`${n.keyPrefix}:sectionHeader:${t}`,isSticky:!0,parent:null,isFixed:!1,type:pe.zq.ROW,top:a,height:40,element:r.createElement(pK,{sectionHeaderText:t,isFixed:!1}),fixedElement:r.createElement(r.Fragment,null,r.createElement("div",{className:pA}),r.createElement(pK,{sectionHeaderText:t,isFixed:!0})),isStaticRow:!0,sectionNameForTracking:n.sectionNameForTracking};return e.push(o),o}function pV({outputElements:e,results:t,moreResults:n,showMoreResults:a,keyPrefix:o,overallOptions:l,libraryNameByResourceId:i,toggleShowMoreResults:s,parent:c}){if(t.length>0&&pD({parent:c??null,outputElements:e,items:t,keyPrefix:`${o}:results`,sharedOptions:l,libraryNameByResourceId:i,sectionNameForTracking:"Primary search results"}),n.length>0){let t=pe.oz.getNextRenderedElementTop(e);e.push({parent:c??null,type:pe.zq.ROW,top:t,height:40,key:`${o}:moreResultsLink`,element:r.createElement("div",{className:"component_sidebar--text--g20jk"},a&&(0,d.tx)("design_systems.assets_panel.showing_results_from_all_libraries"),!a&&r.createElement("a",{className:"component_sidebar--link--I-ane blue_link--blueLink--9rlnd",onClick:s},(0,d.tx)("design_systems.assets_panel.more_results_in_all_libraries",{results:n.length}))),sectionNameForTracking:"More search results"}),a&&pD({parent:null,outputElements:e,items:n,keyPrefix:`${o}:moreResults`,sharedOptions:l,libraryNameByResourceId:i,sectionNameForTracking:"More search results"})}}function pU({prevParent:e,outputElements:t,inputSubtree:n,inputParentTree:a,keyPrefix:o,sharedOptions:l,sectionNameForTracking:i,hideTitle:c}){let d=d5(n,o),p=!c&&function(e,t){switch(e.type){case"FILE":return""!==e.name;case"PAGE":return t.subtrees.length>1;case"NAME_GROUP":return!e.skipElementsInRendering;case"ASSET_TYPE":return e.items.length>0||e.subtrees.length>0}}(n,a),m=function(e,t,n,a,r,o){if(!e)return null;let l=d5(a,r),i=d6(l),s=o.isExpanded(i,(0,d9.pR)(a.type,a.sectionNameForTracking));switch(a.type){case"FILE":return pM(null,n,{keyPrefix:l,size:"h1",title:a.name,isExpanded:s,stickyHeaderTokens:a.stickyHeaderTokens?a.stickyHeaderTokens:void 0,subscribedFileKey:a.subscribedFileKey,subscribedLibraryKey:a.subscribedLibraryKey,sectionNameForTracking:a.sectionNameForTracking,rowType:pe.l$.LIBRARY});case"PAGE":return pM(t,n,{keyPrefix:l,title:a.name,size:"h3",isExpanded:s,stickyHeaderTokens:a.stickyHeaderTokens?a.stickyHeaderTokens:void 0,sectionNameForTracking:a.sectionNameForTracking,rowType:pe.l$.PAGE});case"NAME_GROUP":return pM(t,n,{keyPrefix:l,size:"h3",title:a.flattenedPath?a.flattenedPath:a.name,isExpanded:s,breadcrumbPath:a.breadcrumbPath?a.breadcrumbPath:void 0,stickyHeaderTokens:a.stickyHeaderTokens?a.stickyHeaderTokens:void 0,sectionNameForTracking:a.sectionNameForTracking,rowType:pe.l$.NAME_GROUP});case"ASSET_TYPE":let c=pB(a.sectionNameForTracking);return pM(t,n,{keyPrefix:l,size:"h3",title:a.name,isExpanded:!0,sectionNameForTracking:a.sectionNameForTracking,rowType:c})}}(p,e,t,n,o,l),u=m?m.children:t,E=m||e;if((0,s.kc)().dse_templates_proto){let e=n.subtrees.find(d1.Qe);null!=e&&pU({prevParent:null,outputElements:u,inputSubtree:e,inputParentTree:n,keyPrefix:o,sharedOptions:l,sectionNameForTracking:e.sectionNameForTracking})}switch(n.type){case"PAGE":case"ASSET_TYPE":case"FILE":pD({parent:E,outputElements:u,items:n.items,keyPrefix:d,sharedOptions:l,sectionNameForTracking:i});break;case"NAME_GROUP":n.skipElementsInRendering||pD({parent:E,outputElements:u,items:n.items,keyPrefix:d,sharedOptions:l,sectionNameForTracking:i});break;default:(0,rd.xb)(n.type)}for(let e of n.subtrees)(0,s.kc)().dse_templates_proto&&(0,d1.Qe)(e)||pU({prevParent:E,outputElements:u,inputSubtree:e,inputParentTree:n,keyPrefix:d,sharedOptions:l,sectionNameForTracking:i});"FILE"===n.type&&p&&function(e,t,n){let a=pe.oz.getNextRenderedElementTop(t);t.push({parent:e,type:pe.zq.SEPARATOR,top:a,height:n.size,key:`${n.keyPrefix}:spacer${n.size}`,element:r.createElement(pk,{size:n.size})})}(E,u,{keyPrefix:d,size:16})}let pB=e=>{let t=e?.toLowerCase().includes("local");return e?.toLowerCase().includes("templates")?t?pe.l$.LOCAL_TEMPLATES:pe.l$.TEMPLATES:t?pe.l$.LOCAL_COMPONENTS:pe.l$.COMPONENTS},pG="root";var pz=n(401966);let pW=[];function pH(e,t,n){let a=[];return e&&pU({prevParent:null,outputElements:a,inputSubtree:e,inputParentTree:t,keyPrefix:pG,sharedOptions:n,sectionNameForTracking:e.sectionNameForTracking,hideTitle:!0}),a}let pY="library-section-asset-type";function p$(e){switch(e){case"all":return{type:dS.I.ALL};case"recent":return{type:dS.I.RECENT};case"local":return{type:dS.I.LOCAL};default:return{type:dS.I.FILE,fileKey:e}}}var pX=n(564533),pj=n(229952),pQ=n(378376),pJ=n(799413);let pq=(0,nK.hG)(rF.gNA),pZ={improved:{search:{path:[0,0],column:0},libraryModal:{path:[0,0],column:1},dropdown:{path:[0,1],column:0},viewToggle:{path:[0,1],column:1}}};function p0(e,t){(0,ez.sx)("Component Sidebar Viewed",{viewMode:(0,nf.RN)(e),assetsPanelVersion:2,fileKey:t?.key,fileTeamId:t?.teamId??void 0,fileOrgId:t?.parentOrgId??void 0})}function p1({containerSizingOptions:e,recordingKey:t}){let n=(0,eL.iZ)(),a=(0,eo.q5)(),[o,l]=(0,y.fp)(dW),i=(0,dn.A)(e=>{l(e),n&&(0,c0.uE)("action_left_panel_scroll",{user:n},{assetsPanelVersion:2,tab:"assets",fileKey:a?.key,fileTeamId:a?.teamId??void 0,fileOrgId:a?.parentOrgId??void 0})},500),[s,c]=(0,y.fp)(dH);(0,eW.h)(()=>{p0(s,a)});let d=r.useCallback(()=>{c(e=>{let t=e===nf.Bk.Grid?nf.Bk.List:nf.Bk.Grid;return p0(t,a),t})},[a,c]);return r.createElement(tD.dP,{recordingKey:"localComponents",className:"component_sidebar--container--Wxtr4",dataTestId:"component-sidebar","data-does-not-dismiss-component-flyout":!0},r.createElement(p4,{initialScrollTop:o,onScroll:i,viewMode:s,toggleViewMode:d,containerSizingOptions:e,recordingKey:t}))}function p4({initialScrollTop:e,onScroll:t,viewMode:n,toggleViewMode:a,containerSizingOptions:l,recordingKey:i}){let c=(0,o.wA)(),p=(0,o.d4)(e=>e.dropdownShown),m=(0,o.d4)(np.e_),u=(0,o.d4)(dE.hK),E=(0,o.d4)(iY.dK),g=(0,o.d4)(iY.Xt),_=(0,o.d4)(dg.P),h=(0,o.d4)(e=>e.userFlags.has_dismissed_component_sidebar_library_upsell_banner),f=(0,o.d4)(e=>e.isFreeUser),v=(0,o.d4)(e=>e.user),b=(0,da.Av)(),S=(0,eo.q5)(),T=(0,dm.FC)(),N=(0,d2.D)(),{query:I,searchSessionId:P}=(0,dd.Gq)();(0,pX.y)(),(0,ds.S)();let C=(0,tD.q_)();r.useEffect(()=>{c(rb.cr({shouldSearchDefaultLibraries:!1}))},[c]);let{assetType:k,libraryNameByFileKey:A,fileKeyToLibraryKey:w,onSetAssetType:O,scrollContent:x,validAssetTypeOptions:R}=function({containerSizingOptions:e,viewMode:t}){var n;let a=function(){let e=(0,o.d4)(np.e_),t=(0,o.d4)(eo.tB),n=(0,o.d4)(d0.t_),a=(0,o.d4)(e=>e.hubFiles),l=r.useMemo(()=>dJ()(Object.values(a),e=>(0,dj.l)(e.library_key??"")),[a]),i=(0,o.d4)(np.MH),s=(0,o.d4)(np.dM),c=(0,o.d4)(np.h3),d=(0,o.d4)(dg.P),p=(0,dc.Ck)(),m=(0,dw.Fl)(),u=t?.teamId?d[t.teamId]:null,E=!!u&&(0,du.w5)(u),g=r.useMemo(()=>(0,nf.Sg)(i,s),[i,s]),y=r.useMemo(()=>(0,nf.ND)(c),[c]),_=(0,nf.UY)(e,n),h=(0,d4.Lm)(),f=(0,nf.jl)(h,n),v=(0,nf.Tk)(e,a),b=(0,nf.oV)({library:e,hubFilesByLibraryKey:l}),S=r.useMemo(()=>p()?v:null,[p,v]),T=r.useMemo(()=>p()?b:null,[p,b]);return(0,dZ.jP)(S,T),r.useMemo(()=>(0,d1.Nx)({localLibraryItemsInfo:g,localTemplatesInfo:y,subscribedItemsInfo:_,subscribedTemplatesInfo:f,subscribedCommunityItemsInfo:S,defaultSubscribedItemsInfo:(0,nf.Mt)(),canPublish:E,currentFileKeyForPublish:t?(0,dq.Kz)(t)?t.sourceFileKey:t.key:null,approvedLibraryKeysByResourceType:m}),[g,y,_,f,S,E,t,m])}(),{productComponents:l,templates:i}=(0,dY.g5)(d$.$A.Design),c=(0,o.d4)(dv.q5),p=(0,d2.D)(),m=r.useMemo(()=>({productComponents:l,templates:(0,s.u4)("dse_editor_templates_v1",i,[])}),[l,i]),u=r.useMemo(()=>c?dS.v:function(e,t,n,a=[]){let r=!!((0,s.kc)().dse_editor_templates_v1&&n&&(n.items.length>0||t.subtrees.length>0));return{[dS.I.ALL]:!0,[dS.I.RECENT]:!!(e.length+(0,s.u4)("dse_editor_templates_v1",a.length,0)),[dS.I.LOCAL]:t.items.length>0||t.subtrees.length>0||r,[dS.I.FILE]:!1,[dS.I.SITE_KIT]:!1}}(l,a.localSubtree,a.localTemplateSubtree,i),[c,l,i,a.localSubtree,a.localTemplateSubtree]),E=(n=a.subscribedFileSubtrees,r.useMemo(()=>{let e={};for(let[t,a]of Object.entries(n))a&&(e[t]=a.name);return e},[n])),g=a.fileKeyToLibraryKey,{assetType:y,onSetAssetType:_}=function(e,t){let[n,a]=r.useState(!1),[l,i]=r.useState({type:dS.I.ALL}),s=(0,o.wA)(),c=(0,o.d4)(dv.q5),d=(0,eo.q5)();r.useEffect(()=>{n||"loading"===e||(i(dX(function(){if(rh.x4)try{let e=rh.x4.getItem(pY);if(!e)return;return p$(e)}catch(e){return}}(),e,t)),a(!0))},[n,e,t]);let p=r.useCallback(e=>{(!c||(0,dv.eu)(e))&&(i(e),rh.x4?.setItem(pY,function(e){switch(e.type){case dS.I.ALL:return"all";case dS.I.RECENT:return"recent";case dS.I.LOCAL:return"local";case dS.I.FILE:return e.fileKey;case dS.I.SITE_KIT:return""}}(e)),c&&s(rb.gP({searchOptions:e})),ez.az.trackDefinedEvent("assets_panel.asset_type_changed",{assetType:e.type,isSearching:!!c,fileKey:e.type===dS.I.FILE?e.fileKey:void 0,openFileKey:d?.key,fileTeamId:d?.teamId??void 0,fileOrgId:d?.parentOrgId??void 0,assetsPanelVersion:2}))},[c,s,d?.key,d?.parentOrgId,d?.teamId]),m=r.useCallback(e=>e.key===pY&&null!=e.newValue,[]),u=r.useCallback(n=>{if(!n)return;let a=p$(n);"loading"!==e&&i(dX(a,e,t))},[e,t]);return(0,rh.tl)({onSync:u,shouldSyncValue:m}),{assetType:l,onSetAssetType:p}}(p?"loading":u,E),h=function({assetType:e,containerSizingOptions:t,recentlyUsedItems:n,treeWithSubtrees:a,viewMode:o}){let{library:l}=(0,aY.R)(e=>({library:e.library})),i=(0,pz.O)(),[c,p]=r.useState(!1),m=o===nf.Bk.List,u=r.useMemo(()=>({isList:m,isExpanded:d9.xO,sourceForTracking:nf.mZ,...t}),[t,m]),E=r.useMemo(()=>{let e,t;let{query:n,normalizedSearchResults:a,unsubscribedSearchResults:r}=l.assetsPanelSearch;if(!n)return pW;(0,s.kc)().dse_editor_templates_v1?[t,e]=(0,dv._2)(a):e=a;let o=e,m=o.length+r.length;if(0===m&&(!t||0===t.length))return pW;!c&&0===o.length&&r.length>0&&p(!0);let E=[];if(t&&t.length>0&&(0,s.kc)().dse_editor_templates_v1){let e=pF(E,(0,d.t)("design_systems.assets_panel.templates"),{keyPrefix:d3(pG),sectionNameForTracking:"Templates search results"});pV({outputElements:E,results:t,moreResults:[],showMoreResults:!1,keyPrefix:d3(pG),overallOptions:u,libraryNameByResourceId:i,toggleShowMoreResults:()=>{},parent:e})}if(m>0){let e=(0,s.kc)().dse_editor_templates_v1?pF(E,(0,d.t)("design_systems.assets_panel.components"),{keyPrefix:`${pG}:${d8}`,sectionNameForTracking:"Primary search results"}):null;pV({outputElements:E,results:o,moreResults:r,showMoreResults:c,keyPrefix:`${pG}:${d8}`+((0,s.kc)().dse_editor_templates_v1?"1":""),overallOptions:u,libraryNameByResourceId:i,toggleShowMoreResults:()=>{p(e=>!e)},parent:e})}return E},[i,l.assetsPanelSearch,u,c]),{productComponents:g,templates:y}=n,_=r.useMemo(()=>{if(!g.length&&!y.length)return pW;let e=[];return(0,s.kc)().dse_editor_templates_v1?(y.length>0&&pD({parent:pF(e,(0,d.t)("design_systems.assets_panel.templates"),{keyPrefix:d7(pG+":templates"),sectionNameForTracking:"Recently used templates"}),outputElements:e,items:y,keyPrefix:d7(pG+":templates"),sharedOptions:u}),g.length>0&&pD({parent:pF(e,(0,d.t)("design_systems.assets_panel.components"),{keyPrefix:d7(pG+":components"),sectionNameForTracking:"Recently used"}),outputElements:e,items:g,keyPrefix:d7(pG+":components"),sharedOptions:u})):pD({parent:null,outputElements:e,items:g,keyPrefix:d7(pG),sharedOptions:u}),e},[g,y,u]),h=r.useMemo(()=>(0,s.kc)().dse_editor_templates_v1?function(e,t,n){let a=[];return e.forEach(e=>{e&&pU({prevParent:null,outputElements:a,inputSubtree:e,inputParentTree:t,keyPrefix:pG,sharedOptions:n,sectionNameForTracking:e.sectionNameForTracking,hideTitle:!1})}),a}([a.localTemplateSubtree,a.localSubtree],a.tree,u):pH(a.localSubtree,a.tree,u),[u,a.localSubtree,a.localTemplateSubtree,a.tree]),f=r.useMemo(()=>pH(e.type===dS.I.FILE?a.subscribedFileSubtrees[e.fileKey]:void 0,a.tree,u),[e,u,a.subscribedFileSubtrees,a.tree]),v=r.useMemo(()=>{let e=[];return!function(e,t,n,a){if((0,s.kc)().dse_templates_proto){let r=t.subtrees.find(d1.Qe);null!=r&&pU({prevParent:null,outputElements:e,inputSubtree:r,inputParentTree:t,keyPrefix:n,sharedOptions:a,sectionNameForTracking:r.sectionNameForTracking})}for(let r of(t.items.length>0&&pD({parent:null,outputElements:e,items:t.items,keyPrefix:n,sharedOptions:a}),t.subtrees))(0,s.kc)().dse_templates_proto&&(0,d1.Qe)(r)||pU({prevParent:null,outputElements:e,inputSubtree:r,inputParentTree:t,keyPrefix:n,sharedOptions:a,sectionNameForTracking:r.sectionNameForTracking})}(e,a.tree,pG,u),e},[u,a.tree]);return l.assetsPanelSearch.query?E:e.type===dS.I.RECENT?_:e.type===dS.I.LOCAL?h:e.type===dS.I.FILE?f:v}({assetType:y,containerSizingOptions:e,recentlyUsedItems:m,treeWithSubtrees:a,viewMode:t});return{assetType:y,libraryNameByFileKey:E,fileKeyToLibraryKey:g,onSetAssetType:_,scrollContent:h,validAssetTypeOptions:u}}({viewMode:n,containerSizingOptions:l}),[L,D]=(0,y.fp)(td.Cl);(0,eW.h)(()=>{L&&(O({type:dS.I.FILE,fileKey:L}),D(null))});let M=(0,dp.LR)(),K=(0,o.d4)(e=>e.universalInsertModal.showing),F=r.useCallback(()=>{K&&M()},[M,K]),V=r.useCallback((e,t,n)=>{F(),c((0,lg.to)({type:dG.m,data:{asset:e,searchSessionId:P??void 0,query:I??void 0,sectionPosition:t,sectionNameForTracking:n,assetTypeDropdownSelection:k?.type,containerWidth:l.containerWidth,onGetKeyboardNavigationItemById:C}}))},[k,l.containerWidth,c,F,C,P,I]),U=r.useMemo(()=>({onOpenFlyout:V,assetTypeDropdownSelection:k?.type}),[k,V]);(0,pQ.d)({allElements:x});let B=n===nf.Bk.List,G=m.assetsPanelSearch,z=0===x.length,W=p?.type===pu.K.ASSETS_PANEL,H=W&&p?.data?.component||null,Y=(0,pj.K)(!0),$=r.useCallback(()=>{W||(0,e_.wr)()},[W]),[X,j]=(0,rh.Vc)("has-auto-expanded-component-libraries-for-nux",!1),Q=(0,dc.Ck)(),J=r.useRef(null);r.useEffect(()=>{let e=J.current;e&&0!==x.length&&Q()&&!X&&e.expandAllComponentLibraries(308)>0&&j(!0)},[X,Q,x.length,j]);let q=r.useCallback(()=>{let e=!!m.assetsPanelSearch.query,t=0===x.length;return r.createElement("div",null,e&&t&&r.createElement(d_.Wq,null),!e&&t&&r.createElement(d_.od,null))},[m.assetsPanelSearch,x.length]),Z=N||G.isLoading,ee=(0,ti.jO)(),et=S?.teamId?_[S.teamId]:null,en=!h&&f&&(!et||!(0,du.w5)(et)&&(0,a0.canEditTeam)(et.id,T))&&S?.canEdit&&ee&&Object.keys(m.local.components).length>0&&(0,di.Hz)(v?.id);return r.createElement(dB.U.Provider,{value:U},r.createElement(p2,{assetType:k,componentsEmpty:z,isList:B,isSearching:!!G.query,isComponentSidebarInitialLoading:N,libraryNameByFileKey:A,fileKeyToLibraryKey:w,onSetAssetType:O,onToggleViewMode:a,recordingKey:i,validAssetTypeOptions:R}),Z?r.createElement("div",{className:"component_sidebar--loadingSpinnerContainerWithDropdown--9b8ZI"},r.createElement(dl.kt,null)):r.createElement("div",{className:"component_sidebar--assetPanelSection--mYuo2"},r.createElement(dr.O,{ref:J,scrollContent:x,recordingKey:"componentsListContainer",isList:B,getViewportHeight:e=>e-2*b,topOffset:pq,isTileSelected:e=>!!e.item.isLocal&&g&&(0,dy.sp)(E,g,e.item.node_id),onMouseUp:$,renderEmptyState:q,width:l.containerWidth,className:"component_sidebar--scrollContainerFullHeight---DTUM component_sidebar--_scrollContainerBase--1rakD",initialScrollTop:e,onScroll:t,enableKeyboardNavigation:!0,shouldRefocusAfterKeyboardInsert:k.type===dS.I.RECENT,fileKey:S?.key,teamId:S?.teamId??void 0,orgId:S?.parentOrgId??void 0}),!!H&&r.createElement(pu.h,{selectedView:u,dropdownShown:p,onJumpToLocalComponent:Y,onOpenFlyout:V,usePortal:!0}),en&&r.createElement(pJ.V,null)))}function p2({assetType:e,componentsEmpty:t,isList:n,isSearching:a,isComponentSidebarInitialLoading:o,libraryNameByFileKey:l,fileKeyToLibraryKey:i,onSetAssetType:s,onToggleViewMode:c,validAssetTypeOptions:d,recordingKey:p}){let m=pZ.improved,{setKeyboardNavigationElement:u}=(0,tD.M3)({path:m.libraryModal.path,column:m.libraryModal.column}),{setKeyboardNavigationElement:E}=(0,tD.M3)({path:pZ.improved.dropdown.path,column:pZ.improved.dropdown.column}),{setKeyboardNavigationElement:g}=(0,tD.M3)({path:m.viewToggle.path,column:m.viewToggle.column});return r.createElement("div",null,r.createElement("div",{className:"component_sidebar--searchHeader--yTD7D component_sidebar--_header--nHN39"},r.createElement(dT,{searchOptions:{type:e,onSetAssetType:s},keyboardNavigationPath:m.search.path,keyboardNavigationColumn:m.search.column}),r.createElement(dN.b,{entrypoint:dh.r6.ASSETS_PANEL_BUTTON,onSetKeyboardNavigationElement:u,recordingKey:p})),o||t&&!a?null:r.createElement("div",{className:"component_sidebar--pageHeader--m9FWc component_sidebar--_header--nHN39"},r.createElement(dM,{assetType:e,libraryNameByFileKey:l,fileKeyToLibraryKey:i,onSetAssetType:s,onSetKeyboardNavigationElement:E,validAssetTypeOptions:d}),r.createElement(dU,{isList:n,onToggleViewMode:c,onSetKeyboardNavigationElement:g,recordingKey:p})))}var p8=n(885669),p5=n(721668),p3=n(541445),p7=n(476067);function p6({children:e}){return r.createElement("div",{className:"objects_panel_container--container--jBz9j"},e)}var p9=n(236471),me=n(324253),mt=n(685670),mn=n(124402),ma=n(334071),mr=n(558050);function mo({showTabs:e,activeTab:t,isComparingChanges:n,pageTabChevron:a,currentPageName:o,onCanvasSearch:l,onPageContextMenu:s,onTogglePages:c,recordingKey:p}){let m=(0,mt.U)(),u=(0,c1.dh)(),E=(0,as.rf)(as.Pt(p,"collapsedRow"),"contextmenu",(0,r.useCallback)(e=>{(0,rT.jo)(e),s({nodeId:u,clientX:e.clientX,clientY:e.clientY})},[s,u]));return r.createElement(mn.y,{withBorder:!0},e&&r.createElement(r.Fragment,null,r.createElement(ma._,{onClick:l}),r.createElement(nT.Bx,{className:t===i.xae.LAYERS?mr.yR:mr.Mf,onMouseDown:m.showLayersPanel,onContextMenu:rT.jo,"data-label":(0,d.t)("fullscreen.pages_panel.layers_tab"),recordingKey:as.Pt(p,"tab","layers"),innerText:"Layers"},(0,d.tx)("fullscreen.pages_panel.layers_tab")),r.createElement(nT.Bx,{className:mr.dB,onMouseDown:()=>m.showPublish(),onContextMenu:rT.jo,recordingKey:as.Pt(p,"tab","assets"),innerText:"Assets","data-onboarding-key":eF.Qr},r.createElement("div",{className:t===i.xae.ASSETS?mr.yR:mr.Mf,"data-label":(0,d.t)("fullscreen.pages_panel.assets_tab")},r.createElement("div",null,(0,d.tx)("fullscreen.pages_panel.assets_tab"))))),!e&&r.createElement("div",{className:eG()("ui2_tabs_row--viewOnlySearchRow--lXeEC",{"ui2_tabs_row--hidden--H29bc":n})},r.createElement(cH.Y,{onFocus:l})),r.createElement(nb.E,{className:eG()("ui2_tabs_row--toggleButton--3lJw1",{"ui2_tabs_row--viewOnly--crQc4":!e}),onClick:c,htmlAttributes:{onContextMenu:E},recordingKey:as.Pt(p,"collapsedRow")},r.createElement("span",{className:"ui2_tabs_row--pageTitle--PPrKt ellipsis--ellipsis--Tjyfa","data-onboarding-key":"pages-panel-toggle"},o||""),r.createElement(nH.B,{className:"ui2_tabs_row--chevron--GSVx7",svg:a})))}var ml=n(464835),mi=n(79866),ms=n(480953),mc=n(543878),md=n(861423);function mp({isReadOnly:e,renamingGuid:t,isLayersOpen:n,onToggleLayers:a,currentPageGuid:o,width:l,startRenamingNode:i,stopRenamingNode:c,versionHistory:p,recordingKey:m,onSelectionUpdated:u}){let E=(0,eo.q5)(),g=E?.thumbnailGuid||null,y=(0,es.dg)({deepEqual:!1,allowDeferral:(0,s.kc)().use_scene_selector_deferral},e=>{if(!(0,s.kc)().aip_lpe_overflow)return!1;let t=e.getCurrentPage();return t&&(0,mi.sq)(t)});return r.createElement(r.Fragment,null,r.createElement(ms.B,null,r.createElement(mc.H,{dataOnboardingKey:c4.BZ},r.createElement(nb.E,{onClick:a,className:"ui3_objects_panel--toggleButton--A3BEZ",recordingKey:as.Pt(m,"layersCollapsedRow")},r.createElement(md.g,{isExpanded:n}),(0,d.tx)("fullscreen.pages_panel.layers_tab")),y&&r.createElement(mm,null))),n&&r.createElement(p3.X,{isReadOnly:e,currentPage:o,width:l,renamingGuid:t,startRenaming:i,stopRenaming:c,thumbnailGuid:g,versionHistory:p,onSelectionUpdated:u}))}function mm(){let e=(0,r.useMemo)(()=>[{displayText:(0,d.t)("fullscreen.pages_panel.rename_all_layers_menu_item"),callback:()=>{(0,mi.vm)(),(0,mi.Br)({source:i.uQ6.LAYERS_PANEL_OVERFLOW_MENU,trackingDataSource:"layers_panel_overflow_menu"})}}],[]);return r.createElement(ml.kB,{dropdownItems:e})}var mu=n(459481),mE=n(693769),mg=n(201218);let my=new Map;var m_=n(783423),mh=n(560560);function mf(){let e=(0,eZ.cT)(),{pagesList:t,pageToNumChangesMap:n,isComparingChanges:a}=function(){let e=(0,eZ.n0)(),t=(0,o.d4)(e=>!!(0,s.kc)().version_diffing&&e.mirror.appModel.activeCanvasEditModeType===i.m1T.COMPARE_CHANGES),n=(0,o.d4)(e=>e.versionHistory.compareId);return r.useMemo(()=>{if(!t||!n)return{pagesList:e,pageToNumChangesMap:my,isComparingChanges:t};let a=(0,c9.ee)(e);return{pagesList:e,pageToNumChangesMap:a,isComparingChanges:t}},[t,n,e])}(),l=(0,mE.g)({pagesList:t}),c=(0,eZ.GQ)();return t.length?r.createElement(mv,{recordingKey:"pagesPanel",isReadOnly:e,width:c,pagesList:t,isComparingChanges:a,pageToNumChanges:n,onPageContextMenu:l}):null}function mv({width:e,isReadOnly:t,pagesList:n,onPageContextMenu:a,isComparingChanges:l,pageToNumChanges:s,recordingKey:c}){let d=(0,ew.GS)(),p=(0,p8.M)(),m=(0,pE._j)(),u=(0,eo.q5)(),E=(0,o.d4)(e=>t||!u?i.xae.LAYERS:e.leftPanel.activeTab),g=(0,o.d4)(e=>e.versionHistory),_=(0,c1.dh)(),h=(0,c1.nn)(),f=(0,y.md)(me.l7),v=(0,mt.U)(),{toggleManageMemoryModal:b,closeManageMemoryModal:S}=(0,c8.P)({sidebarWidth:e}),T=(0,eh.T)(),{isLayersOpen:N,toggleLayersAction:I}=(0,eZ.vr)(),{renamingNodeGuid:P,startRenamingNode:C,stopRenamingNode:k}=(0,eZ.TU)(),A=(0,eZ._4)(),{height:w,setHeight:O,isOpen:x,setIsOpen:R}=(0,mg.d)({defaultIsOpen:n.length>1||d}),L=E===i.xae.LAYERS,D=L&&(!!d||x),M=x&&L?mh.A:m_.A,K=i.AWq.getChunkChangeCount(),F=(0,o.Pj)(),V=(0,r.useCallback)(e=>{v.showLayersPanel(),(0,c0.ds)("pages_panel_open_toggle",u?.key,F.getState(),{isPagesOpen:e},{forwardToDatadog:!0}),R(e)},[u,v,R,F]),U=(0,r.useCallback)(()=>{V(!0)},[V]),B=(0,cq.F)(x),G=(0,r.useCallback)(()=>{V(!B.current)},[B,V]),z=(0,cJ.$)(f);return(0,r.useEffect)(()=>{f&&z&&!t&&U()},[z,f,t,U]),r.createElement(p7.A,{isFullHeight:!0},d?r.createElement(r.Fragment,null,r.createElement(cZ.$,null),!t&&r.createElement(mu.I,{recordingKey:c,activeTab:E,onCanvasSearch:A})):r.createElement(r.Fragment,null,r.createElement(mo,{recordingKey:c,showTabs:!t,activeTab:E,pageTabChevron:M,isComparingChanges:l,currentPageName:h,onCanvasSearch:A,onTogglePages:E===i.xae.ASSETS?U:G,onPageContextMenu:a}),E===i.xae.LAYERS&&r.createElement(cZ.$,null)),l&&L&&r.createElement(r.Fragment,null,g.compareId&&r.createElement(dt.ZI,{compareId:g.compareId,versions:g.versions}),K>0&&r.createElement(mn.y,{withBorder:!0},r.createElement(de,null))),u&&r.createElement(c2.QU,{fileKey:u.key,toggleManageMemoryModal:b,closeManageMemoryModal:S}),D&&r.createElement(p9.R,{isOpen:x,onToggle:G,height:w,onHeightChange:O,showHeader:!T,pages:n,isComparingChanges:l,pageToNumChanges:s,isReadOnly:t,onPageContextMenu:a,onCanvasSearch:A}),L&&r.createElement(p6,null,m&&N&&r.createElement(eC.p,null,r.createElement(c4.Ay,null)),d?r.createElement(mp,{isReadOnly:t,isLayersOpen:N,onToggleLayers:I,currentPageGuid:_,width:e,renamingGuid:P,startRenamingNode:C,stopRenamingNode:k,versionHistory:g,recordingKey:c}):r.createElement(p3.X,{isReadOnly:t,currentPage:_,width:e,renamingGuid:P,startRenaming:C,stopRenaming:k,thumbnailGuid:u?.thumbnailGuid||null,versionHistory:g})),E===i.xae.ASSETS&&r.createElement(r.Fragment,null,p?r.createElement(p5.g,{width:e}):r.createElement(p1,{recordingKey:"componentsSidebar",containerSizingOptions:{containerWidth:e,maxSmallThumbSize:40,maxWideColWidth:300}})))}let mb=r.memo(function(){let e=(0,y.md)((0,np.Xh)(void 0)),t=(0,eo.q5)(),n=(0,ew.GS)(),a=(0,er.aV)();(0,eZ.bi)();let o=(0,eE.X0)(),l=!!t&&e,s=(0,eS.J2)(i.Ez5.uiState().showCanvasSearch);return r.useEffect(()=>{l&&(0,eX.YQ)({id:"Found Updates To Publish"})},[l]),r.createElement(cQ.Q,{ignoreRulers:a},r.createElement(c$.s,null),r.createElement(cY.$,null,n&&r.createElement(cj.n,null),n&&r.createElement(cX.d,{shouldUseBottomBorder:!o}),s?r.createElement(cW.EA.Provider,{value:!0},r.createElement(cH.f,{showFilter:!0})):r.createElement(mf,null)))});var mS=n(463918),mT=n(206276),mN=n(215514),mI=n(988241);let mP=(0,r.memo)(function(e){return(0,nU.jsxs)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:[(0,nU.jsx)("mask",{id:"fpl-icon-24-mail-a",fill:"#fff",children:(0,nU.jsx)("path",{fillRule:"evenodd",d:"M5.88 7h12.24a.88.88 0 0 1 .88.88v.82l-7 3.733L5 8.7v-.82A.88.88 0 0 1 5.88 7M4 8.99v7.13A1.88 1.88 0 0 0 5.88 18h12.24A1.88 1.88 0 0 0 20 16.12V7.88A1.88 1.88 0 0 0 18.12 6H5.88A1.88 1.88 0 0 0 4 7.88zm15 .843v6.287a.88.88 0 0 1-.88.88H5.88a.88.88 0 0 1-.88-.88V9.833l6.765 3.608.235.126.235-.126z",clipRule:"evenodd"})}),(0,nU.jsx)("path",{fill:"var(--color-icon)",d:"m19 8.7.47.882L20 9.3v-.6zm-7 3.733-.47.883.47.25.47-.25zM5 8.7H4v.6l.53.282zm-1 .31h1v-.02zm0-.02 1 .02v-.02zm16 .02-1-.02v.02zm0-.02h-1v.02zm-1 .843h1V8.167l-1.47.784zm-14 0 .47-.882L4 8.167v1.666zm6.765 3.608-.47.882zm.235.126-.47.882.47.251.47-.251zm.235-.126.471.882zM18.12 6H5.88v2h12.24zM20 7.88A1.88 1.88 0 0 0 18.12 6v2a.12.12 0 0 1-.12-.12zm0 .82v-.82h-2v.82zm-7.53 4.616 7-3.734-.94-1.764-7 3.733zM4.53 9.582l7 3.734.94-1.765-7-3.733zM4 7.88v.82h2v-.82zM5.88 6A1.88 1.88 0 0 0 4 7.88h2a.12.12 0 0 1-.12.12zM5 8.99v.02l-2-.04v.06zm-2 .02v7.11h2V9.01zm0 7.11A2.88 2.88 0 0 0 5.88 19v-2a.88.88 0 0 1-.88-.88zM5.88 19h12.24v-2H5.88zm12.24 0A2.88 2.88 0 0 0 21 16.12h-2a.88.88 0 0 1-.88.88zM21 16.12V9.01h-2v7.11zm-2-7.11v-.02l2 .04v-.06zm2-.02V7.88h-2v1.11zm0-1.11A2.88 2.88 0 0 0 18.12 5v2a.88.88 0 0 1 .88.88zM18.12 5H5.88v2h12.24zM5.88 5A2.88 2.88 0 0 0 3 7.88h2A.88.88 0 0 1 5.88 7zM3 7.88v1.11h2V7.88zm17 8.24V9.833h-2v6.287zM18.12 18A1.88 1.88 0 0 0 20 16.12h-2a.12.12 0 0 1 .12-.12zM5.88 18h12.24v-2H5.88zM4 16.12A1.88 1.88 0 0 0 5.88 18v-2a.12.12 0 0 1 .12.12zm0-6.287v6.287h2V9.833zm8.235 2.726L5.471 8.95l-.941 1.765 6.764 3.608zm.236.125-.236-.125-.94 1.765.235.125zm-.706-.125-.236.125.942 1.765.235-.126zm6.764-3.608-6.764 3.608.941 1.765 6.765-3.608z",mask:"url(#fpl-icon-24-mail-a)"})]})});var mC=n(137035),mk=n(136189),mA=n(19294),mw=n(907555),mO=n(364329),mx=n(828824);function mR(){let e=(0,v.e)({overlay:A.Dqt,priority:I.N.DEFAULT_MODAL});(0,f.E)(e.uniqueId,"commentThreadMobileAnnouncementClicked",()=>{(0,ez.sx)("sidebar_announcement_mobile_app_download_prompt_modal_shown"),e.show({})});let t=(0,r.useCallback)(async()=>{(0,ez.sx)("sidebar_announcement_mobile_app_download_prompt_email_me_cta_clicked"),await tq.Ay.post("/api/send_mobile_download_email"),e.complete()},[e]);return r.createElement(mw.h,{isShowing:e.isShowing,modalType:mO.q3.FEATURE_UPDATE,closeButtonStyle:mO.M_.ON_DARK,element:()=>r.createElement(mL,{onEmailClick:t}),trackingContextName:"mobile_comment_announcement",onClickPrimaryCta:e.complete,onClose:e.complete,onManualDismiss:e.complete})}function mL(e){return r.createElement("div",{className:"modal_comment_sidebar_announcement--container--5oh-p"},r.createElement("div",{className:"modal_comment_sidebar_announcement--imageContainer--Vuo-V"},r.createElement("img",{alt:"Background",src:(0,s.ck)("e19f2f58bc09414847ad59ff9228e07032e8842c"),className:"modal_comment_sidebar_announcement--image--lyA61"}),r.createElement("div",{className:"modal_comment_sidebar_announcement--spacer--m02YT"}),r.createElement(mx.T,null)),r.createElement("div",{className:"modal_comment_sidebar_announcement--textContainer--btaTy"},r.createElement("div",{className:"modal_comment_sidebar_announcement--title--eiyLq"},r.createElement(mA.E,{fontSize:24,fontWeight:"semi-bold"},(0,d.t)("rcs.mobile_comment_announcement.title"))),r.createElement("div",{className:"modal_comment_sidebar_announcement--description--Y8AJE"},r.createElement(mA.E,{fontSize:14},(0,d.t)("rcs.mobile_comment_announcement.description")))),r.createElement("div",{className:"modal_comment_sidebar_announcement--buttonsContainer--UTcgc"},r.createElement(am.$n,{variant:"secondary",onClick:e.onEmailClick,iconPrefix:r.createElement(mP,null)},(0,d.t)("rcs.mobile_comment_announcement.email_download_link")),r.createElement(am.$n,{variant:"primary",onClick:()=>{(0,ez.sx)("sidebar_announcement_mobile_app_download_prompt_learn_more_cta_clicked"),mk.Ay.unsafeRedirect("https://help.figma.com/hc/articles/1500007537281-Guide-to-the-Figma-mobile-app#download","_blank")},iconPrefix:r.createElement(mC.b,null)},(0,d.t)("rcs.rcs_shared.learn_more"))))}var mD=n(131663),mM=n(599248),mK=n(688572),mF=n(926325),mV=n(765726),mU=n(340868),mB=n(503965);let mG=(0,sa.ex)("prototype_action_info",function(){return r.createElement("div",{className:W.cx.flex.itemsCenter.justifyCenter.$},r.createElement(nH.B,{className:"prototype_action_info_tooltip--prototypeDestinationInfoIcon--GeQWS",svg:mB.A}),r.createElement("span",{className:W.cx.flexGrow1.m6.$,style:{maxWidth:144}},(0,d.tx)("proto.prototype_panel.use_the_circular_node_to_connect_the_selected_object_to_another_frame_tooltip")))},()=>({unconstrainWidth:!0})),mz=(0,r.memo)(function(e){return(0,nU.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,nU.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M11.5 6a.5.5 0 0 1 .5.5V11a1 1 0 0 0 1 1h4.5a.5.5 0 0 1 0 1H13a2 2 0 0 1-2-2V6.5a.5.5 0 0 1 .5-.5",clipRule:"evenodd"})})});var mW=n(931294),mH=n(444229),mY=n(935271);let m$=iv.c$,mX=iv.l6;function mj({action:e}){return r.createElement("div",{className:"prototype_action_dropdown--prototypeActionIcon--qChhY"},r.createElement(rD.U,{svg:(0,iW.Yb)(e)},(0,iW.av)(e)))}function mQ(e){let t=`prototype-action-select-${e.recordingKey}`,n=e.dropdownShown&&e.dropdownShown.type===t,a=(0,rl.E7)(e.action),l=(0,iW.Yb)(a),i=(0,iW.av)(a),s=(0,ew.GS)(),c=(0,o.d4)(ij.ZM),d=new iz.js(s,c),p=new iz.Z6(s,c),m=n?d:p,u=!(0,o.d4)(e=>e.mirror.selectionProperties.isValidPrototypingSourceSelected??!0),E=r.useCallback(e=>e-24,[]),g=r.useCallback(e=>e+24,[]),[y,_]=r.useState(void 0),h=r.createElement(mH.Q,{setMaxWidth:_,options:mJ(e),formatOption:e=>e&&e.props.value?m.format(e.props.value):"",getIcon:()=>r.createElement(mj,{action:"NAVIGATE_TO"})}),f=eG()({[e.className??""]:!0,"prototype_action_dropdown--select--b3Ssx":!s}),v=r.createElement(rD.U,{svg:l},i);return r.createElement(r.Fragment,null,r.createElement(mX,{disabled:u,id:t,dataTestId:"action-select",className:f,chevronClassName:"prototype_action_dropdown--prototypeActionChevron--ZL1Q4",inputClassName:"prototype_action_dropdown--prototypeActionInputWithSvg--Atfua",property:e.action,formatter:m,onChange:e.onChange,dispatch:e.dispatch,dropdownShown:e.dropdownShown,icon:v,iconClassName:"prototype_action_dropdown--selectActionSvg--XfhUx",recordingKey:as.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,tz.nl)(),dropdownAlignment:E,dropdownWidth:s?y:g},mJ(e)),s&&h)}function mJ(e){let t=(0,ia.cJ)(),n=(0,ew.GS)(),a=r.createElement(m$,{key:"NONE",value:"NONE",icon:r.createElement(mj,{action:"NONE"}),recordingKey:as.Pt(e,"clear-option"),disabled:!1}),o=r.createElement(m$,{key:"NAVIGATE_TO",value:"NAVIGATE_TO",icon:r.createElement(mj,{action:"NAVIGATE_TO"}),recordingKey:as.Pt(e,"navigate-to-option"),disabled:!1}),l=r.createElement(m$,{key:"SWAP_STATE_TO",value:"SWAP_STATE_TO",icon:r.createElement(mj,{action:"SWAP_STATE_TO"}),recordingKey:as.Pt(e,"swap-state-to-option"),disabled:!i.glU.isSelectionContainedInStateOrStateInstance()}),c=r.createElement(m$,{key:"GO_BACK",value:"GO_BACK",icon:r.createElement(mj,{action:"GO_BACK"}),recordingKey:as.Pt(e,"back-option"),disabled:!1}),d=r.createElement(m$,{key:"SCROLL_TO",value:"SCROLL_TO",icon:r.createElement(mj,{action:"SCROLL_TO"}),recordingKey:as.Pt(e,"scroll-to-option"),disabled:!1}),p=r.createElement(m$,{key:"OPEN_URL",value:"OPEN_URL",icon:r.createElement(mj,{action:"OPEN_URL"}),recordingKey:as.Pt(e,"url-option"),disabled:!1}),m=r.createElement(m$,{key:"OPEN_OVERLAY",value:"OPEN_OVERLAY",icon:r.createElement(mj,{action:"OPEN_OVERLAY"}),recordingKey:as.Pt(e,"open-overlay-option"),disabled:!1}),u=r.createElement(m$,{key:"SWAP_WITH",value:"SWAP_WITH",icon:r.createElement(mj,{action:"SWAP_WITH"}),recordingKey:as.Pt(e,"swap-with-option"),disabled:!1}),E=r.createElement(m$,{key:"CLOSE_OVERLAY",value:"CLOSE_OVERLAY",icon:r.createElement(mj,{action:"CLOSE_OVERLAY"}),recordingKey:as.Pt(e,"close-option"),disabled:!1}),g=r.createElement(m$,{key:"SET_VARIABLE",value:"SET_VARIABLE",icon:r.createElement(mj,{action:"SET_VARIABLE"}),recordingKey:as.Pt(e,"set-variable"),disabled:!1}),y=(0,s.kc)().prototype_set_mode_action&&r.createElement(m$,{key:"SET_VARIABLE_MODE",value:"SET_VARIABLE_MODE",icon:r.createElement(mj,{action:"SET_VARIABLE_MODE"}),recordingKey:as.Pt(e,"set-variable-mode"),disabled:!1}),_=!e.isNestedInConditional&&r.createElement(m$,{key:"CONDITIONAL",value:"CONDITIONAL",icon:r.createElement(mj,{action:"CONDITIONAL"}),recordingKey:as.Pt(e,"conditional"),disabled:!1}),h=r.createElement(iv.sK,{key:"first-divider"}),f=r.createElement(iv.sK,{key:"second-divider"}),v=r.createElement(iv.sK,{key:"third-divider"}),{getConfig:b}=(0,mY.I7)("exp_prototyping_reorder_actions"),S=!!b().getValue("new_ordering",!1),T=(0,s.kc)().sts_interaction_interop&&t?[l,c,d,h,g,_]:n?S?[a,h,o,l,c,d,p,f,g,y,_,v,m,u,E]:[a,h,o,l,c,d,p,f,m,u,E,v,g,y,_]:[a,h,o,l,c,f,g,y,_,d,p,v,m,u,E];if(e.showVideoActions&&!t){let t=[r.createElement(iv.sK,{key:"fourth-divider"}),r.createElement(m$,{key:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",value:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",icon:r.createElement(mj,{action:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS"}),recordingKey:as.Pt(e,"update-media-play-pause-options"),disabled:!1}),r.createElement(m$,{key:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",value:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",icon:r.createElement(mj,{action:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS"}),recordingKey:as.Pt(e,"update-media-mute-unmute-options"),disabled:!1}),r.createElement(m$,{key:"UPDATE_MEDIA_SKIP_TO",value:"UPDATE_MEDIA_SKIP_TO",icon:r.createElement(mj,{action:"UPDATE_MEDIA_SKIP_TO"}),recordingKey:as.Pt(e,"update-media-skip_to"),disabled:!1}),r.createElement(m$,{key:"UPDATE_MEDIA_SKIP_BY_OPTIONS",value:"UPDATE_MEDIA_SKIP_BY_OPTIONS",icon:r.createElement(mj,{action:"UPDATE_MEDIA_SKIP_BY_OPTIONS"}),recordingKey:as.Pt(e,"update-media-skip-by-options"),disabled:!1})];T=T.concat(t)}return T.filter(Boolean)}var mq=n(983405),mZ=n(629851),m0=n(344386),m1=n(441907),m4=n(698020),m2=n(908367);let m8="prototype_action_verbose_title--actionNameInsertion--aF4kI",m5="prototype_action_verbose_title--actionName--qWJL3",m3="prototype_action_verbose_title--actionNameUI3--JAYsG",m7=()=>{let e=(0,o.d4)(e=>e.mirror.sceneGraph);return r.useMemo(()=>new iz.cP(e),[e])};function m6({action:e,isNestedInConditional:t,isNarrowPanel:n,onClick:a}){let o=(0,i0.YT)()===i0.Oz.TWO_COL,l=r.useContext(m0.c),s=o&&l===m0.P.LEFT,c=t||n,p=(0,nJ.u)((0,rl.hS)(e.targetVariable)&&e.targetVariable&&"id"in e.targetVariable?e.targetVariable?.id:void 0),m=(0,rl.hS)(e.targetVariable)&&e.targetVariable&&"nodeFieldAlias"in e.targetVariable?(0,mZ.aA)(e.targetVariable.nodeFieldAlias.stablePathToNode,e.targetVariable.nodeFieldAlias.indexOrKey):void 0,u=p?.name??m?.name,E=m7(),g=new iz.Z6((0,ew.GS)()),y=(0,iz._X)(e),_=(0,rl.E7)(y),h=r.createElement(rD.U,{svg:(0,iW.Yb)(_)},(0,iW.av)(_)),f=e=>{if(!e.connectionType||(0,rl.gl)(e.connectionType))return null;let t=eG()({[m5]:!0,[m3]:o}),n=eG()({"prototype_action_verbose_title--actionDestination--JZ-gU":!0,"prototype_action_verbose_title--actionDestinationUI3--ZGxbq":o});switch(e.connectionType){case"NONE":case"SET_VARIABLE_MODE":case"OBJECT_ANIMATION":return null;case"INTERNAL_NODE":case"BACK":case"CLOSE":case"UPDATE_MEDIA_RUNTIME":{let a=e.transitionNodeID;if((0,rl.gl)(a))return r.createElement("div",{className:t},(0,d.t)("proto.variant_actions.mixed"));if(void 0===a)return null;let o=ir.dI(a),l=E.format(o);return r.createElement("div",{className:n},l)}case"URL":{let a=e.connectionURL;if(!a)return null;if((0,rl.gl)(a))return r.createElement("div",{className:t},(0,d.t)("proto.variant_actions.mixed"));return r.createElement("div",{className:n},a)}case"SET_VARIABLE":if(!e.targetVariableData||(0,rl.gl)(e.targetVariableData))return null;return r.createElement("div",{className:"prototype_action_verbose_title--setVariablePreviewContainer--6omxy"},r.createElement(mF.y3,{targetVariableData:e.targetVariableData,onClick:z.lQ,showVariableThumbnails:!1,isNarrowPanel:c,isInConditional:!0}));case"CONDITIONAL":{if((0,rl.gl)(e)||(0,rl.gl)(e.conditionalActions)||!e.conditionalActions)return null;let t=e.conditionalActions.length>0?e.conditionalActions[0].condition:void 0;return r.createElement(mF.y3,{targetVariableData:t,onClick:z.lQ,isInConditional:!0,showVariableThumbnails:!1})}default:(0,rd.xb)(e.connectionType)}},v=eG()({[W.cx.block.bgTransparent.$]:!0,"prototype_action_verbose_title--buttonResetTextAlign--gy69p":!0,[m2.Li]:c&&!o,[m2.O8]:!c&&!o,[m2.kE]:o}),b=eG()({"prototype_action_verbose_title--iconContainer--jqarD":!0,"prototype_action_verbose_title--iconContainerUI3--yBP0-":o});return r.createElement(nb.E,{className:v,onClick:a},r.createElement(mq.Y1,{horizontalAlignItems:"space-between",width:"fill-parent"},r.createElement("div",{className:b},h),(e=>{let t=_?g.format(_):"Undefined",n=eG()({[m5]:!0,[m3]:o});if((0,rl.gl)(e.connectionType)&&(t=(0,d.t)("fullscreen.mixed")),!e.connectionType||(0,rl.gl)(e.connectionType)||"NONE"===e.connectionType||"BACK"===e.connectionType||"CLOSE"===e.connectionType)return r.createElement(r.Fragment,null,r.createElement("div",{className:n},t));var a=f(e);switch(e.connectionType){case"INTERNAL_NODE":if("SWAP_STATE"===e.navigationType)return r.createElement(r.Fragment,null,r.createElement("div",{className:n},(0,d.t)("proto.action_change_to")),a);if(a){if("OVERLAY"===e.navigationType)return r.createElement(r.Fragment,null,r.createElement("div",{className:m8},(0,d.tx)("proto.action_overlay_title",{overlayFrameName:r.createElement("span",null,a)})));if("SWAP"===e.navigationType)return r.createElement(r.Fragment,null,r.createElement("div",{className:n},(0,d.t)("proto.action_swap_overlay_title")),a)}return r.createElement(r.Fragment,null,r.createElement("div",{className:n},t),a);case"UPDATE_MEDIA_RUNTIME":return r.createElement(r.Fragment,null,r.createElement("div",{className:n},t),a);case"URL":return r.createElement(r.Fragment,null,r.createElement("div",{className:n},a?(0,d.t)("proto.action_url_title"):(0,d.t)("proto.action_open_link")),a);case"SET_VARIABLE":{let l=e.targetVariableData&&(0,rl.hS)(e.targetVariableData)&&e.targetVariableData.resolvedType===i.rXF.COLOR,c=eG()({"prototype_action_verbose_title--actionNameInsertionColor--isir- prototype_action_verbose_title--actionNameInsertion--aF4kI":!0,"prototype_action_verbose_title--actionNameInsertionColorUI3--Apj0i":o});if(u&&a)return r.createElement(r.Fragment,null,r.createElement("div",{className:l?c:m8},(0,d.tx)("proto.action_set_variable_title",{variableName:r.createElement("span",{className:"prototype_action_verbose_title--variableNameContainer--XeJX2"},r.createElement(m4.wG,{text:u,isDeleted:!!p&&(0,m1.eF)(p),disableHover:s})),variableValue:r.createElement("span",{className:"prototype_action_verbose_title--variableDestinationContainer--RXbKo prototype_action_verbose_title--variableNameContainer--XeJX2"},a)})));return r.createElement(r.Fragment,null,r.createElement("div",{className:n},t))}case"SET_VARIABLE_MODE":return r.createElement(r.Fragment,null,r.createElement("div",{className:n},(0,d.t)("proto.action_set_variable_mode")));case"CONDITIONAL":return r.createElement(r.Fragment,null,r.createElement("div",{className:n},o?(0,d.t)("proto.if"):(0,d.t)("proto.action_conditional_title")),a);case"OBJECT_ANIMATION":return r.createElement(r.Fragment,null);default:(0,rd.xb)(e.connectionType)}})(e)))}var m9=n(396353),ue=n(789529),ut=n.n(ue),un=n(636149),ua=n.n(un),ur=n(675551),uo=n.n(ur),ul=n(184058),ui=n.n(ul),us=n(649792),uc=n(882230),ud=n(458243);let up="prototype_set_variable_mode_controls--dropdownRow--vl5z4",um="missing",uu=iv.l6,uE=iv.c$,ug=iv.l6,uy=iv.c$,u_={},uh=(0,pt.fv)();function uf(){let e=(0,nJ.h6)()||u_,t=(0,uc.iR)(),n=r.useMemo(()=>{let n=uo()(t,(e,t)=>({collectionID:e.node_id,collectionName:e.name,key:e.key,modeOptions:e.modes?.map(t=>({modeId:{guid:t.id,collectionKey:e.key},name:t.name,isCompatible:!0}))||[],explicitMode:null,inheritMode:null,fileKey:uh(e),libraryKey:e.library_key}));return ut()({},e,n)},[t,e]),a=r.useMemo(()=>Object.entries(n).map(([e,t])=>({setKey:e,modeData:t,isLocal:void 0===t.libraryKey})),[n]),l=r.useMemo(()=>Object.values(a).filter(e=>e.modeData?.modeOptions&&e.modeData?.modeOptions.length>1),[a]),s=r.useMemo(()=>ui()(l.map(e=>e.modeData.libraryKey??ud.CC)),[l]),c=(0,us.U)(s),[p,m]=r.useMemo(()=>{let{_local:e,_unknownFile:t,...n}=ua()(l,e=>e.isLocal?"_local":e.modeData.libraryKey&&c.data?.[e.modeData.libraryKey]===void 0?"_unknownFile":e.modeData.libraryKey),a=Object.entries(n).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>[{libraryKey:e,fileName:c.data?.[e]??""},...t]).flat(1);return t&&(a.push({libraryKey:ud.CC,fileName:(0,d.t)("variables.mode_properties_panel.used_variables.subheading")}),a.push(...t)),[e??[],a]},[c,l]),u=(0,uc.d2)(),E=r.useCallback(e=>{let t=u[(0,ru.yG)(e)],n=l.find(t=>t.setKey===e);if(n)return(e=>{if(e)return void 0===t&&(t=e.modeData.modeOptions[0].modeId.guid),e.modeData.modeOptions.find(e=>e.modeId.guid!==t&&(t=e.modeId.guid,!0))?.modeId.guid})(n)},[u,l]),g=l.length>0?l[0]:void 0,y=g?.setKey,_=g?.modeData.collectionID,h=r.useMemo(()=>y&&E(y),[y,E]),f=(0,o.wA)();return{localVariableSets:p,allVariableSets:l,firstVariableSet:g,firstVariableSetID:_,firstVariableSetMode:h,getDefaultNewModeForVariableCollectionKey:E,reportAnalyticsEventWhenSelected:e=>{let t=i.mSn.getVariableSetInfoForSetModeAnalytics(e);f((0,io.Zh)({name:"prototype.set_mode_select_variable_set",params:{...t}}))},subscribedVariableSetsWithSections:m}}function uv({targetVariableSetID:e,targetVariableModeID:t,deprecatedTargetVariableSetKey:n,updateSelectionProperties:a,recordingKey:o,actionIndexPath:l}){let{getDefaultNewModeForVariableCollectionKey:i,allVariableSets:s,reportAnalyticsEventWhenSelected:c}=uf(),{shouldShowAdvancedPrototypingPaywall:p,showAdvancedPrototypingVariablesModal:m}=(0,i0.zt)(),u=(0,ew.GS)();r.useEffect(()=>{if(!n||(0,rl.gl)(n))return;let e=s.find(e=>e.setKey===n);e?((0,tJ.Lo)("SetVariableModeControls","updating variable set key to non-deprecated id value"),a({targetVariableSetKey:void 0,targetVariableSetID:e?.modeData.collectionID})):((0,tJ.Lo)("SetVariableModeControls","attempted to update variable set key to non-deprecated id value, but could not find it in the list of variable sets, will just clear out the bad data."),a({targetVariableSetKey:void 0}))},[n,s,a]);let[E,g]=r.useMemo(()=>{let t=(0,rl.gl)(e)||void 0===e?e:function(e,t){let n=e.find(e=>e.modeData.collectionID===t);if(n)return n;let a=m9.gr.toRefIfSubscribed(t);if(a)return e.find(e=>e.setKey===a.key)}(s,e)||um,n=(()=>{if(!(0,rl.gl)(t)&&void 0!==t&&t!==um)return t})();return[t,n]},[e,s]),y=r.createElement(uT,{selectedVariableSet:E,onChange:e=>{p?m():(c(e.modeData.collectionID),a({targetVariableSetID:e.modeData.collectionID,targetVariableModeID:i(e.setKey)}))},actionIndexPath:l}),_=u?r.createElement(ip.cS,{input:y,label:(0,d.tx)("proto.set_variable_mode.collection_label")}):r.createElement(rw.fI,{recordingKey:as.Pt(o,"selectTargetVariableSet")},y),h=r.createElement(uP,{selectedVariableSetKey:g&&g.setKey,selectedVariableModeID:t,onChange:e=>{p?m():a({targetVariableModeID:e})},actionIndexPath:l}),f=u?r.createElement(ip.cS,{input:h,label:(0,d.tx)("proto.set_variable_mode.mode_label")}):r.createElement(rw.fI,{recordingKey:as.Pt(o,"selectTargetVariableMode")},h);return r.createElement("div",{className:u?void 0:W.cx.relative.$},_,g&&f)}let ub={format:e=>void 0===e?(0,d.t)("proto.prototype_panel.edit_set_mode.none"):e===um?(0,d.t)("proto.prototype_panel.edit_set_mode.missing_collection"):e.modeData.collectionName,isEqual:(e,t)=>void 0!==e&&void 0!==t&&e!==um&&t!==um&&(e.setKey===t.setKey||e.modeData.collectionID===t.modeData.collectionID)};function uS(e,t){return"libraryKey"in e?[t&&r.createElement(iv.sK,{key:e.libraryKey+"divider"}),r.createElement(uE,{isHeader:!0,key:e.libraryKey+"header",formattedValue:e.fileName})]:r.createElement(uE,{key:e.setKey,value:e})}function uT({selectedVariableSet:e,onChange:t,actionIndexPath:n}){let a=(0,o.wA)(),l=(0,r3.Um)(),i="set-variable-mode--select-variable-set-"+n,{localVariableSets:c,allVariableSets:p,subscribedVariableSetsWithSections:m}=uf();return r.createElement(uu,{id:i,className:up,property:e,formatter:ub,dispatch:a,dropdownShown:l?.type===i?l:null,onChange:e=>{(0,rl.gl)(e)||void 0===e||e===um||t(e)}},p.length>0?[c.length>0&&r.createElement(uE,{key:as.Pt(i,"local_variables"),isHeader:!0,formattedValue:(0,s.kc)().ds_variable_props_unified_ui?(0,d.t)("variables.mode_properties_panel.assets_created_in_file.subheading"):(0,d.t)("variables.mode_properties_panel.local_variables.subheading")}),...c.map(e=>uS(e,!1)),...m.map((e,t)=>uS(e,c.length>0||t>0))]:[])}let uN={format:e=>void 0===e?(0,d.t)("proto.prototype_panel.edit_set_mode.none"):e===um?(0,d.t)("proto.prototype_panel.edit_set_mode.missing_mode"):e?.name??""};function uI(e){return r.createElement(uy,{key:e.modeId.guid,value:e})}function uP({selectedVariableSetKey:e,selectedVariableModeID:t,onChange:n,actionIndexPath:a}){let l=(0,o.wA)(),i=(0,r3.Um)(),s="set-variable-mode--select-variable-mode-"+a,{allVariableSets:c}=uf(),d=r.useMemo(()=>c.find(t=>t.setKey===e)?.modeData.modeOptions,[e,c]),p=r.useMemo(()=>(0,rl.gl)(t)||void 0===t?t:d?.find(e=>e.modeId.guid===t)||um,[t,d]);return r.createElement(ug,{id:s,className:up,property:p,formatter:uN,dispatch:l,dropdownShown:i?.type===s?i:null,onChange:e=>{!e||(0,rl.gl)(e)||e===um||n(e.modeId.guid)}},d&&d?.map(uI))}var uC=n(769612),uk=n(910392),uA=n(909666),uw=n(442458);let uO=ag.TI;function ux({children:e}){return(0,ew.GS)()?r.createElement(ip.TN,null,e):r.createElement(rw.fI,{className:"overlay_panel--fplCheckboxRow--EYTAZ checkbox--_checkboxRow--oEhow"},e)}function uR({interactionType:e,recordingKey:t,actionIndexPath:n,nodeId:a}){let[l,s]=r.useState(!1),[c,p]=r.useState(new tL.Mi),m=(0,o.wA)(),u=(0,ew.GS)(),E="{ "+n.join(", ")+" }",{destinationOverlayBackgroundColor:g,destinationOverlayBackgroundType:y,destinationOverlayPositionType:_,destinationOverlayBackgroundInteraction:h}=(0,aY.R)(e=>({destinationOverlayBackgroundColor:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[E]?.destinationOverlayBackgroundColor,destinationOverlayBackgroundType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[E]?.destinationOverlayBackgroundType,destinationOverlayPositionType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[E]?.destinationOverlayPositionType,destinationOverlayBackgroundInteraction:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[E]?.destinationOverlayBackgroundInteraction})),f=r.useRef(null),v=r.useRef(null),b=r.useCallback(()=>{s(!1)},[s]),S=r.useCallback(()=>{if(l)b();else{s(!0);let e=u?v.current:f.current;p((0,is.cn)(e))}},[l,b,u]),T=r.useCallback(e=>{let t=e?"SOLID_COLOR":"NONE";rE.l7.user("overlay-background-type-edit-scope",()=>{i.X3B.setOverlayBackgroundType(ir.dI(a),t)}),m((0,io._P)({name:"Overlay background visible changed",params:{backgroundType:t}}))},[m,a]),N=r.useCallback(e=>{let t=e?"CLOSE_ON_CLICK_OUTSIDE":"NONE";rE.l7.user("overlay-background-interaction-edit-scope",()=>{i.X3B.setOverlayBackgroundInteraction(ir.dI(a),t)}),m((0,io._P)({name:"Overlay background interaction changed",params:{backgroundInteraction:t}}))},[m,a]),I=r.useCallback(()=>(0,rl._W)(g,{r:0,g:0,b:0,a:.25}),[g]),P=r.useCallback((e,t)=>{t!==i$.zk.NO&&rE.l7.user("overlay-background-color-edit-scope",()=>{i.X3B.setOverlayBackgroundColor(ir.dI(a),e)})},[a]),C=r.useCallback((e,t)=>{P(e,i$.zk.YES)},[P]),k=r.useCallback((e,t)=>{let n=I();P({r:n.r,g:n.g,b:n.b,a:e},t)},[I,P]),A=r.useCallback(e=>{rE.l7.user("overlay-position-type-edit-scope",()=>{i.X3B.setOverlayPositionType(ir.dI(a),e)}),m((0,io._P)({name:"Overlay position changed",params:{position:e}}))},[m,a]),w=I(),O=I().a,x=(0,rl.E7)(_),R="CLOSE_ON_CLICK_OUTSIDE"===(0,rl.E7)(h),L="SOLID_COLOR"===(0,rl.E7)(y),D=r.createElement("div",{className:"overlay_panel--colorValueContainer--gJtb9 paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t"},r.createElement(ad.J,{onClick:L?S:()=>{},color:w,opacity:O,recordingKey:as.Pt(t,"chit"),className:"overlay_panel--chit--Zn66r paint_panels--chit--twQEy"}),r.createElement(id.AN,{className:u?"overlay_panel--colorInputUI3--ozOrK paint_panels--colorInput--nSz13":"overlay_panel--colorInput--6yyym paint_panels--colorInput--nSz13",noLeftBorder:!0,formatter:uO,property:w,disabled:!L,onChange:C,recordingKey:as.Pt(t,"colorInput"),noBorderOnFocus:!0}),r.createElement(ly.Pd,{className:"overlay_panel--opacity--vrrjV paint_panels--opacityInputContainer--oqlsk",value:O,onValueChange:k,dispatch:m,disabled:!L,noBorderOnFocus:!0,recordingKey:as.Pt(t,"opacity")}));return r.createElement(rw.Zk,{className:u?"overlay_panel--overlayPanelUI3--GLqgD":"overlay_panel--overlayPanel--l-Hts"},!u&&r.createElement(rw.fI,null,r.createElement(rw.xw,{faded:!0,className:"overlay_panel--overlayPanelTitle--e9pjs"},(0,d.tx)("proto.overlay_settings"))),r.createElement(uU,{overlayPositionType:x,onOverlayPositionTypeChange:A,recordingKey:t}),!("ON_HOVER"===e||"ON_PRESS"===e)&&r.createElement(ux,null,r.createElement(sk.S,{label:r.createElement(iV.J,null,(0,d.tx)("proto.close_when_clicking_outside")),recordingKey:as.Pt(t,"closeOnClickOutside"),onChange:N,checked:R})),r.createElement(ux,null,r.createElement(sk.S,{label:r.createElement(iV.J,null,u?(0,d.tx)("proto.overlay_panel.background"):(0,d.tx)("proto.add_background")),recordingKey:as.Pt(t,"addBackgroundBehindOverlay"),onChange:T,checked:L})),L&&(u?r.createElement(ip.cS,{ref:v,label:(0,d.tx)("proto.overlay_panel.background"),input:D}):r.createElement(rw.fI,{ref:f}," ",D," ")),l&&r.createElement(ic.h3,{disabledVariableIds:new Set,initialPosition:c,color:w,boundVariable:null,onChange:P,onClose:b,recordingKey:as.Pt(t,"colorPicker")}))}let uL=iv.l6,uD=iv.c$;class uM extends r.PureComponent{constructor(){super(...arguments),this.titleFormatter=new iz.Cr,this.renderOverlayPositionOption=(e,t)=>r.createElement(uD,{key:t,value:e,recordingKey:as.Pt(this.props,e)})}render(){let e=["CENTER","TOP_LEFT","TOP_CENTER","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT"].map(this.renderOverlayPositionOption);return r.createElement(uL,{id:this.props.recordingKey??"overlay-position_select",className:this.props.className,chevronClassName:"overlay_panel--chevron--7RTA-",inputClassName:"overlay_panel--input--tGHHB",dropdownWidth:rF.DxS,property:this.props.property,formatter:this.titleFormatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,recordingKey:as.Pt(this.props,"select")},e,r.createElement(iv.sK,null),this.renderOverlayPositionOption("MANUAL",10))}}uM.displayName="OverlayPositionDropdown";class uK extends uC.I{}class uF extends uC.Y{}class uV extends r.PureComponent{render(){return r.createElement(uK,{className:this.props.className,property:this.props.property,onChange:this.props.onChange,recordingKey:this.props.recordingKey},r.createElement(uF,{value:"CENTER",tooltip:(0,d.t)("proto.tooltip_overlay_position_center"),svg:uA.A,recordingKey:as.Pt(this.props,"center")}),r.createElement(uF,{value:"TOP_LEFT",tooltip:(0,d.t)("proto.tooltip_overlay_position_top_left"),svg:uw.A,recordingKey:as.Pt(this.props,"top-left")}),r.createElement(uF,{value:"BOTTOM_CENTER",tooltip:(0,d.t)("proto.tooltip_overlay_position_bottom_center"),svg:uk.A,recordingKey:as.Pt(this.props,"bottom-center")}))}}function uU({overlayPositionType:e,onOverlayPositionTypeChange:t,recordingKey:n}){let a=(0,ew.GS)(),l=(0,o.wA)(),i=(0,r3.Um)(),s=r.createElement(uM,{className:"overlay_panel--overlayPositionDropdown--ZxxSI",property:e,dispatch:l,dropdownShown:i,onChange:t,recordingKey:as.Pt(n,"overlayPositionDropdown")}),c=r.createElement(uV,{property:e,onChange:t,recordingKey:as.Pt(n,"overlayPositionControl"),className:"overlay_panel--overlayPositionControl--SWngJ"});return a?r.createElement(ip.cS,{label:(0,d.tx)("proto.overlay_panel.position"),input:s}):r.createElement(rw.fI,null,s,c)}var uB=n(578942),uG=n(791970),uz=n(474538),uW=n(500440);let uH=e=>`interaction-panel-create-action-${e}`;function uY(e){let t=uH(e.recordingKey);var{showing:n,toggle:a,hide:l}=(0,r3.BK)(t);let i=(0,r.useRef)(null),{recordingKey:s,addButtonPressed:c,presetInteractions:p}=e,{shouldShowAdvancedPrototypingPaywall:m,showAdvancedPrototypinglMultipleActionsModal:u}=(0,i0.zt)(),E=(0,r.useCallback)(()=>{!e.skipPaywall&&m?u():a()},[e.skipPaywall,m,u,a]),g=(0,i0.YT)()===i0.Oz.TWO_COL,y=(0,i0.hP)(),h=(0,ew.GS)(),f=(0,ia.cJ)(),v=(0,i0.He)({showVideoActions:y,isNestedInConditional:e.isNestedInConditional,isSites:f,isUI3:h,showPresetActions:!!e.presetInteractions}),b=(0,o.wA)(),S=(0,r.useCallback)(e=>{c((0,i0.Bs)(e)),l()},[c,l]),T=eG()({[m2.x1]:e.renderButton,[m2.xm]:!e.renderButton&&!g,[m2.U3]:!e.renderButton&&g}),N=[];v.forEach(e=>{(0,i0.vc)(e)?N.push(uz.w):e===i0.Xk&&p?.length?N.push(...p,uz.w):N.push(function({actionType:e,clickCb:t,recordingKey:n,isUI3:a}){let o=(0,iW.Yb)(e),l=(0,iW.av)(e),i=new iz.Z6(a),s=e?i.format(e):"Undefined";return{className:m2.BP,callback:()=>t(e),icon:r.createElement(rD.U,{className:m2.QE,svg:o},l),displayText:s,recordingKey:as.Pt(n,"createActionOption",e)}}({clickCb:S,recordingKey:s,actionType:e,isUI3:h}))});let I=e.isNestedInConditional?(0,d.t)("proto.prototype_panel.add_nested_action"):(0,d.t)("proto.prototype_panel.add");return r.createElement(r.Fragment,null,r.createElement(_.e6,{ref:i,recordingKey:as.Pt(s,"createActionDropdown"),className:T,onClick:E,"aria-label":(0,d.t)("proto.prototype_panel.create_action_button"),htmlAttributes:{"data-tooltip":I,"data-tooltip-type":"text"}},e.renderButton?r.createElement(rD.U,{svg:rY.A},r.createElement(oo.e,null)):(0,d.tx)("fullscreen.properties_panel.click_plus_to_add_new_action")),n&&i.current&&r.createElement(uW.j,{minWidth:130,lean:"center",parentRect:i.current.getBoundingClientRect(),hidePointWhenContentOffScreen:!0,showPoint:!0,items:N,dispatch:b,onSelectItem:e=>e.callback?.(),recordingKey:"actionDropdown"}))}let u$="prototype_conditional_controls--conditionalRowUI3--rQlu6",uX="prototype_conditional_controls--conditionIcon--Npk57";var uj=n(381809),uQ=n(527967),uJ=n(5068);function uq({onDeleteAction:e,updateMultipleDestinationNodes:t,updateSelectionProperties:n,updateCondition:a,updateActions:o,onAddAction:l,autoOpenVariablePicker:s,isSelected:c,handleMouseDownUI3:p,...m}){let u=m.conditionalActions,E=u?.actions?u?.actions:[],g=u?.condition?u?.condition:void 0,y=(0,i0.YT)()===i0.Oz.TWO_COL,_=y?u$:"prototype_conditional_controls--conditionalRowIf--25FqB prototype_conditional_controls--conditionalRow--u0PaS",h=r.createElement(mF.KN,{resolvedType:i.rXF.BOOLEAN,targetVariableData:g,updateSelectionProperties:n,recordingKey:m.recordingKey,updateConditionInConditionalAction:a,showVariableThumbnails:!0,isNarrowPanel:!0}),f=r.createElement("div",{className:"prototype_conditional_controls--addButton--vlYLn"},r.createElement(uY,{addButtonPressed:l,recordingKey:as.Pt(m.recordingKey,"addActionToIfButton"),renderButton:!0,isNestedInConditional:!0})),v=r.createElement(r.Fragment,null,y?r.createElement("span",{className:"prototype_conditional_controls--conditionIconUI3--zcwx0"},(0,d.tx)("proto.else")):r.createElement(nH.B,{className:uX,svg:uj.A}),!y&&E.length>0&&r.createElement("div",{className:"prototype_conditional_controls--addButtonForElse--ogBWu prototype_conditional_controls--addButton--vlYLn"},r.createElement(uY,{addButtonPressed:l,recordingKey:as.Pt(m.recordingKey,"addActionToElseButton"),renderButton:!y,isNestedInConditional:!0}))),b=y?r.createElement(nb.E,{className:"prototype_conditional_controls--elseBlockRowUI3--VXjmO",onClick:p},v):r.createElement(rw.fI,{className:y?u$:"prototype_conditional_controls--conditionalRow--u0PaS"},v);return r.createElement(r.Fragment,null,m.ifStatement&&r.createElement("div",{className:_},!y&&r.createElement(pr.Y,{direction:"horizontal",spacing:4},r.createElement("span",{className:y?"prototype_conditional_controls--conditionalRowConditionUI3--M2mOx":"prototype_conditional_controls--conditionalRowCondition--kn-f7"},r.createElement(pr.Y,{direction:"horizontal",spacing:0},r.createElement(nH.B,{className:uX,svg:uQ.A}),r.createElement(pr.Y,{direction:"horizontal",spacing:0},(0,rl.hS)(g)&&h),r.createElement(nH.B,{className:"prototype_conditional_controls--icon--JV1i0",svg:uJ.default}))),!y&&E.length>0&&f)),!m.ifStatement&&b,E&&E.map((a,o)=>r.createElement(EM,{key:o,updateMultipleDestinationNodes:t.appendActionIndex(o),action:a,recordingKey:as.Pt(m.recordingKey,"conditional-action-row",o),updateSelectionProperties:n.appendActionIndex(o),onDeleteAction:()=>e(o),interactionType:m.interactionType,actionIndexPath:[m.actionIndexPath[0],m.actionIndexPath[1],o],numActions:E.length,isNestedInConditional:!0,stateManagementVersion:m.stateManagementVersion,selectedInteractions:m.selectedInteractions,onDrop:m.onDrop,onSelect:m.onSelect,onExpand:m.onExpand,onAddAction:l,selectedActionIndex:m.selectedActionIndex,expandedRows:m.expandedRows,autoOpenVariablePicker:s})),0===E.length&&r.createElement(EM,{key:0,updateMultipleDestinationNodes:t.appendActionIndex(0),action:m.emptyAction,recordingKey:as.Pt(m.recordingKey,"conditional-action-row",0),updateSelectionProperties:n.appendActionIndex(0),onDeleteAction:()=>e(0),interactionType:m.interactionType,actionIndexPath:[m.actionIndexPath[0],m.actionIndexPath[1],0],numActions:E.length,isNestedInConditional:!0,stateManagementVersion:m.stateManagementVersion,selectedInteractions:m.selectedInteractions,onDrop:m.onDrop,onSelect:m.onSelect,onExpand:m.onExpand,onAddAction:l,selectedActionIndex:m.selectedActionIndex,expandedRows:m.expandedRows,autoOpenVariablePicker:s}))}function uZ(e,t,n){return function(a){var r=[...t];r.length>e?r[e].condition=a:r.push({condition:0===e?a:void 0,actions:[]},{condition:1===e?a:void 0,actions:[]}),n({conditionalActions:r})}}function u0({onDrop:e,onSelect:t,onExpand:n,action:a,updateMultipleDestinationNodes:l,updateSelectionProperties:i,interactionType:s,recordingKey:c,stateManagementVersion:p,selectedInteractions:m,actionIndexPath:u,selectedActionIndex:E,expandedRows:g,autoOpenVariablePicker:y,onNewActionAdded:_,handleMouseDownUI3:h}){let f=(0,o.wA)(),v=(0,er.p8)("currentPage"),b=(0,i0.YT)()===i0.Oz.TWO_COL,S=b?E.equals(u):void 0,{shouldShowAdvancedPrototypingPaywall:T,showAdvancedPrototypingConditionalActionsModal:N}=(0,i0.zt)(),I=(0,rl.hS)(a.conditionalActions)&&a.conditionalActions?a.conditionalActions:[],P=e=>function(t){var n=[...I];n.length>e?n[e].actions=[...t]:n.push({actions:t}),i({conditionalActions:n})},C=e=>function(t){var n=[...I],a=0;if(n.length>e){var r=n[e].actions;r?r.push(t):r=[t],a=r.length}else n.push({actions:0===e?[t]:[]},{actions:1===e?[t]:[]}),a=1;"SET_VARIABLE"===t.connectionType&&(y.current=!0),i({conditionalActions:n}),_&&_(new uG.Op([u[0],e,a-1])),f((0,io._P)({name:"Prototype add action",params:{action:t.connectionType?t.connectionType:"NONE",source:"panel",page_id:v,actionInConditionalAction:!0}}))},k=e=>function(t){if(T)N();else{var n=[...I];let a=I[e],r=[];if(a&&a.actions)for(let e=0;e<a.actions.length;e++){let n=a.actions[e];e!==t?r.push(n):f((0,io._P)({name:"Prototype delete action",params:{action:n.connectionType?n.connectionType:"NONE",source:"panel",page_id:v,actionInConditionalAction:!0}}))}n[e].actions=r,i({conditionalActions:n})}},A=I.length>0?I[0]:void 0,w=I.length>1?I[1]:void 0;return r.createElement("div",{style:b?{position:"relative"}:void 0},(0,rl.gl)(a.conditionalActions)&&r.createElement(mq.Y1,null,r.createElement(nb.E,{className:"prototype_conditional_controls--mixedConditionalText--6O32b",onClick:()=>{var e=[];e.push({},{}),i({conditionalActions:e})}},(0,d.t)("fullscreen.properties_panel.click_to_replace_mixed_content"))),(0,rl.hS)(a.conditionalActions)&&r.createElement(r.Fragment,null,r.createElement(uq,{key:0,conditionalActions:A,recordingKey:as.Pt(c,"conditional-block",0),updateCondition:uZ(0,I,i),updateActions:P(0),onAddAction:C(0),updateMultipleDestinationNodes:l.appendActionIndex(0),onDeleteAction:k(0),interactionType:s,updateSelectionProperties:i.appendActionIndex(0),ifStatement:!0,stateManagementVersion:p,selectedInteractions:m,actionIndexPath:[u[0],0],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:E,autoOpenVariablePicker:y,expandedRows:g,emptyAction:{ifStatement:!0,action:a},isSelected:S,handleMouseDownUI3:h}),r.createElement(uq,{key:1,conditionalActions:w,recordingKey:as.Pt(c,"conditional-block",1),updateCondition:uZ(1,I,i),updateActions:P(1),onAddAction:C(1),updateMultipleDestinationNodes:l.appendActionIndex(1),onDeleteAction:k(1),interactionType:s,updateSelectionProperties:i.appendActionIndex(1),ifStatement:!1,stateManagementVersion:p,selectedInteractions:m,actionIndexPath:[u[0],1],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:E,autoOpenVariablePicker:y,expandedRows:g,emptyAction:{ifStatement:!1,action:a},isSelected:S,handleMouseDownUI3:h})))}function u1({updateSelectionProperties:e,conditionalActions:t,autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,...o}){let l=t.length>0?t[0]:void 0,s=l?.condition?l?.condition:void 0,c=eG()({"prototype_conditional_controls--standaloneIfConditional--GLFDU":!0,"prototype_conditional_controls--placeholderText--esG0u":!s});return r.createElement(r.Fragment,null,r.createElement(ip.cS,{input:null,label:(0,d.tx)("proto.condition")}),r.createElement(oY.Ad,{appendedClassName:"prototype_conditional_controls--conditionalActionRightPadding--xpK6Z",label:null,input:(0,rl.hS)(s)?r.createElement("div",{className:c},r.createElement(mF.KN,{resolvedType:i.rXF.BOOLEAN,targetVariableData:s,updateSelectionProperties:e.appendActionIndex(0),recordingKey:o.recordingKey,updateConditionInConditionalAction:uZ(0,t,e),autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,showVariableThumbnails:!0,isNarrowPanel:!0})):null}))}var u4=n(806285),u2=n(845412),u8=n(328628);let u5=iv.c$,u3=iv.l6;function u7(e){let t=r.useMemo(()=>new iz.cP(e.scene),[e.scene]),[n,a]=r.useState([]),[o,l]=r.useState([]),s=(0,ia.cJ)(),c=e.nodeId===rl.oV?rl.oV:ir.dI(e.nodeId),d=n;(0,rl.hS)(c)&&c!==ir.AD&&-1===d.indexOf(c)&&(d=d.concat([c]));let p=`prototype-destination-select-${e.recordingKey}`,m="SCROLL_TO"!==e.action?d.filter(e=>t.hasNameForNode(e)).map((t,n)=>r.createElement(u5,{key:`enabled-${t}`,value:t,recordingKey:as.Pt(e,`viable-option-${n}`),disabled:!1})):((n,a)=>{let o=ua()(n.filter(e=>t.hasNameForNode(e)),t=>t===a&&(0,rl.hS)(a)?t9.Ql(e.scene,t)?.guid:e.scene.get(t)?.parentGuid),l=Object.keys(o);(0,t9.X4)(l,t.format.bind(t));let{tlfId:i,index:s}=(0,t9.H_)(e.scene,l);return i&&s&&(l.splice(s,1),l=[i,...l]),l.reduce((t,n,a)=>(0!==a&&t.push(r.createElement(iv.sK,{key:a})),t.push(r.createElement(u5,{key:`disabled-${n}`,value:n+" ",recordingKey:as.Pt(e,`disabled-option-${n}`),disabled:!0})),o[n].forEach((n,a)=>{t.push(r.createElement(u5,{key:`enabled-${n+a}`,value:n,recordingKey:as.Pt(e,`viable-option-${a}`),disabled:!1}))}),t),[])})(d,c),u=o.filter(e=>t.hasNameForNode(e)).map((t,n)=>r.createElement(u5,{key:`disabled-${t}`,value:t,recordingKey:as.Pt(e,`disabled-option-${n}`),disabled:!0})),E=e.isUI3?r.Fragment:rw.fI;return r.createElement(E,null,r.createElement(u3,{id:p,dataTestId:"destination-select",className:e.className,chevronClassName:"prototype_destination_dropdown--chevron--pmWtI",inputClassName:"prototype_destination_dropdown--input--rzglN",dropdownWidth:rF.DxS,property:c,formatter:t,onChange:e.onChange,dispatch:e.dispatch,dropdownShown:e.dropdownShown,recordingKey:as.Pt(e,"select"),willShowDropdown:()=>{let t=i.baT.ALL;"SCROLL_TO"===e.action?t=i.baT.SCROLL_TO:"SWAP_STATE_TO"===e.action?t=i.baT.STATES:"NAVIGATE_TO"===e.action&&s&&(t=i.baT.RESPONSIVE_SETS);let{viableIds:n,disabledIds:r}=i.X3B.getTransitionDestinationsOnActiveCanvas(t);return a(n),l(r),Promise.resolve()},onOptionFocus:e=>{e_.Uc(e??"")},hideDropdownWhenContainerMoves:!(0,tz.nl)()},m||null,0!==o.length&&0!==d.length&&r.createElement(iv.sK,null),u))}let u6=r.memo(function(e){let t=(0,eo.tS)(),n=(0,eo._G)(),a=(0,o.d4)(u9),l=(0,o.d4)(iY.qd),s=(0,o.d4)(iY.dK),c=(0,u4.D)(l,s),d=(0,o.d4)(Ee),p=r.useMemo(()=>(0,u8.cP)(d,t,n,e.actionIndexPath),[d,t,n,e.actionIndexPath]),m=r.useMemo(()=>(0,u8.cP)(a,t,n),[a,t,n]),u=p||m;if(!u||u.mode!==i.iCO.STATE_OR_STATE_INSTANCE_SUBLAYER)return null;let{allStates:E,stateGroupModel:g,selectedStates:y,selectedStatesPropertyValues:_}=u,h=g.propertySortOrder||[],f=g.propertyValues;return f?r.createElement(u2.lS,{sortedProperties:h,stateGroupPropertyValues:f,selectedStatesPropertyValues:_,selectedStates:y,allStates:E,onSelectProperty:t=>{let n={};for(let e of Object.keys(t)){let a=t[e].symbol.node_id;for(let t of(n[e]=a,c[e]||[]))n[t]=a;for(let e of l)n[e]||(n[e]=a)}e.onChange(n)},recordingKey:e.recordingKey,hideErrorsPanel:!0,shouldIndent:!0,extended:!0}):null});function u9(e){return e.mirror.selectionProperties.stateGroupSelectionInfo}function Ee(e){return e.mirror.selectionProperties.prototypeDestinationStateGroupSelectionInfo}var Et=n(57721),En=n(700201),Ea=n(184970),Er=n(629785),Eo=n(318982);let El="prototype_set_variable_controls--dropdownAndIconContainer--6m3Tw",Ei="prototype_set_variable_controls--icon---HzDt",Es="prototype_set_variable_controls--placeholderText--PBIqf";function Ec({targetVariableData:e,targetVariable:t,updateSelectionProperties:n,autoOpenVariablePicker:a,...l}){let c=r.useRef(null),p=(0,o.wA)(),m=(0,ew.GS)(),u=(0,o.d4)(e=>e.variablePickerShown),E=(0,nJ.tZ)((0,rl.hS)(t)&&"id"in t?t.id:void 0),g=(0,nJ.u)((0,rl.hS)(t)&&"id"in t?t.id:void 0),[y,_]=r.useState("");(0,eW.h)(()=>{a&&!0===a.current&&(f(),a.current=!1)});let h=(0,nJ.BQ)((0,rl.hS)(t)&&"id"in t?t.id:void 0)??(0,mZ.m9)((0,rl.hS)(t)&&"nodeFieldAlias"in t?t.nodeFieldAlias:void 0);r.useEffect(()=>{void 0!==e&&h&&"MIXED"!==h&&(0,rl.hS)(e)&&e.resolvedType!==h.resolvedType&&!((0,mZ.tz)(e.resolvedType)&&(0,mZ.tz)(h.resolvedType))&&n({targetVariableData:void 0})},[h,n,e]);let f=()=>{let e=c.current.getBoundingClientRect();p((0,Et.C)({type:"variable-picker-set-variable-action",isShown:!0,resolvedType:i.rXF.STRING,initialPosition:new tL.Mi(e.left-20,e.top),key:l.recordingKey,onVariableSelected:T}))},v=r.useCallback(()=>{p((0,Et.B)())},[p]),[b,S]=r.useState(!1),T=r.useCallback(t=>{if(void 0!==t&&t.node_id){let a={targetVariable:{id:t.node_id}},r=i.CWU.getVariableResolvedValue(t.node_id,new Map);!e&&t.resolvedType===i.rXF.COLOR&&r&&(a.targetVariableData=r??void 0),n(a),p((0,io.Zh)({name:"prototype.variable_selected",params:{collectionId:t.variableSetId,variableId:t.node_id,variableType:t.resolvedType}})),S(!0)}},[p,e,n]),N=r.useCallback(e=>{e.value.stablePath.map(e=>ir.sH(e))&&(n({targetVariable:{nodeFieldAlias:{stablePathToNode:e.value.stablePath,nodeField:"COMPONENT_PROP_ASSIGNMENTS",indexOrKey:e.value.explicitDefId}}}),S(!0))},[n]),I=r.useMemo(()=>({type:"LOCAL_VARIABLES",layout:"list"}),[]),P=r.useRef(null);r.useEffect(()=>{let e=i.Ez5.prototypingEditorState().colorPickerEyedropperVarData;return(0,eS.lu)(e,{onChangeImmediate(){let t=e.getCopy();t&&n({targetVariableData:t})}})},[n]);let C="nodeFieldAlias"in t?(0,mZ.aA)(t.nodeFieldAlias.stablePathToNode,t.nodeFieldAlias.indexOrKey):void 0,k=C?(0,mZ.Xx)(C.varValue.resolvedType):null,A=null;if((0,rl.gl)(t))A=null;else if(h?.resolvedType===i.rXF.COLOR)A=(0,rl.gl)(e)?r.createElement("div",{className:"prototype_set_variable_controls--targetVariableDataMixedContainer--H6uGu"},(0,d.t)("fullscreen.mixed")):r.createElement(r.Fragment,null,r.createElement(Eo.gJ,{variableValue:e??h,onChange:e=>{n({targetVariableData:e})},recordingKey:as.Pt(l.recordingKey,"variableValueInput"),setVariableAction:!0,innerContainerClassName:"prototype_set_variable_controls--variableColorInputContainer--NaOmp"}));else{let t=l.isNestedInConditional?"prototype_set_variable_controls--absoluteIconInConditional--BbEmW":"prototype_set_variable_controls--absoluteIcon--1XpBF",a=i.rXF.BOOLEAN;g?a=g.resolvedType:C&&(a=C.varValue.resolvedType===i.rXF.TEXT_DATA?i.rXF.STRING:C.varValue.resolvedType),A=r.createElement("div",{className:m?void 0:W.cx.ml12.$},r.createElement("div",{className:El},r.createElement(mF.KN,{resolvedType:a,targetVariableData:e,autoOpenExpressionBuilder:b,setAutoOpenExpressionBuilder:S,updateSelectionProperties:n,recordingKey:l.recordingKey,isNarrowPanel:l.isNarrowPanel,showVariableThumbnails:!0}),!m&&r.createElement(nH.B,{className:eG()(Ei,t),svg:uJ.default})))}let w=eG()({"prototype_set_variable_controls--targetVariableDropdown--IZwoF":!m&&!l.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownNarrow--WWi-t prototype_set_variable_controls--targetVariableDropdown--IZwoF":!m&&l.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownUI3--Pz71q":m,[Es]:m&&!(E||C)}),O=(0,o.d4)(ij.ZM),x=(0,s.kc)().ds_variable_props_unified_ui&&O?(0,d.t)("proto.select_variable_unified"):m?(0,d.t)("proto.select_variable.short"):(0,d.t)("proto.select_variable"),R=r.createElement(nT.D8,{recordingKey:as.Pt(l.recordingKey,"selectTargetVariable"),onClick:f},r.createElement("div",{className:m?void 0:(0,rl.hS)(t)?"prototype_set_variable_controls--targetVariableLabel--AFCqK":"prototype_set_variable_controls--targetVariableLabelInactive--zHWCC prototype_set_variable_controls--targetVariableLabel--AFCqK",ref:c},r.createElement(pr.Y,null,r.createElement("div",{className:w},r.createElement("div",{className:El},(0,rl.gl)(t)?r.createElement("div",{className:eG()(W.cx.pt2.$,W.cx.pb2.$)},(0,d.t)("fullscreen.mixed")):E?r.createElement(m4.wG,{text:E,thumbnailValue:h,isDeleted:!!g&&(0,m1.eF)(g)}):C?r.createElement(m4.wG,{text:C.name,thumbnailValue:k,isDeleted:!1,colorTheme:m4.J2.COMPONENT}):r.createElement("div",{className:eG()(W.cx.pt2.$,W.cx.pb2.$,m?"prototype_set_variable_controls--placeholderTextColorUI3--Pc-4N":void 0)},x),!m&&r.createElement(nH.B,{className:Ei,svg:uJ.default})))))),L=m?r.createElement(ip.cS,{input:R,label:(0,s.kc)().ds_variable_props_unified_ui?(0,d.tx)("proto.target"):(0,d.tx)("proto.variable")}):R,D=eG()({"prototype_set_variable_controls--setVariableToContainerNarrow--HHbHQ prototype_set_variable_controls--setVariableToContainer--kxsCZ":!m&&l.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainer--kxsCZ":!m&&!l.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainerUI3--pGbDe":m,[Es]:m&&!e&&h?.resolvedType!==i.rXF.COLOR}),M=r.createElement("div",{className:D,"data-testid":"set-variable-container"},A),K=m?null!==A?r.createElement(ip.cS,{label:(0,d.tx)("proto.variable.value"),input:M}):null:M;return r.createElement("div",{className:m?void 0:W.cx.relative.$},L,u.isShown&&"variable-picker-set-variable-action"===u.type&&u.key===l.recordingKey?r.createElement(r.Fragment,null,r.createElement(lW.vx,{title:"",headerSize:"hidden",initialPosition:u.initialPosition,onClose:v,dragHeaderOnly:!1,initialWidth:216,canRenderBelowViewport:!0},r.createElement(Er.YK,{selectedItem:g,disabledVariableIds:new Set,currentView:I,pickerType:"set-variable",onVariableSelected:T,onClose:v,recordingKey:as.Pt(l.recordingKey,"variablePickerForSelection"),searchQuery:y,onSearchInputChange:_,onComponentPropSelected:(0,s.kc)().ds_variable_props_proto?N:void 0,searchInputRef:P,renderSetControls:()=>r.createElement(Ea.Z,{currentView:I,subscribedLibraries:[],setControlRightButtons:r.createElement(En.f,{resolvedTypes:[i.rXF.BOOLEAN,i.rXF.STRING,i.rXF.FLOAT,i.rXF.COLOR]}),recordingKey:as.Pt(l.recordingKey,"variablePickerForSelection")})})),r.createElement(Er.$3,{onClose:v})):null,K)}var Ed=n(995076),Ep=n(36815);let Em=(0,sa.ex)("prototype_state_management_info",function(){let e=r.createElement(M.N,{newTab:!0,href:"https://help.figma.com/hc/articles/14397859494295",htmlAttributes:{rel:"noopener noreferrer",onMouseDown:e=>{e.stopPropagation(),e.preventDefault()}}},(0,d.tx)("proto.state_management.info_tooltip_learn_more")),t=r.createElement("span",null,r.createElement("strong",null,(0,d.tx)("proto.animation_panel.preserve_scroll_position")));return r.createElement("div",{className:"prototype_state_management_info_tooltip--stateManagementMoreInfo---gER1 tooltip--text--Ll1mS"},(0,d.tx)("proto.state_management.info_tooltip",{PreserveScrollPositionBold:t,LearnMoreLink:e}))}),Eu="prototype_state_management_panel--checkboxRow--2u02e checkbox--_checkboxRow--oEhow",EE="prototype_state_management_panel--expandCaret--uuDge";function Eg({transition:e,navigationType:t,recordingKey:n,showPreserveScrollPosition:a,showResetVideoState:l,showResetInteractiveComponentState:i,updateSelectionProperties:s,stateManagementVersion:c,selectedInteractions:p}){let m=(0,o.wA)(),u=(0,ew.GS)(),[E,g]=r.useState(!u),y=r.useContext(m0.c);if((0,i0.YT)()===i0.Oz.TWO_COL&&y===m0.P.LEFT)return null;let _=(0,i0.LH)(c),h=r.createElement(sk.S,{onChange:t=>{m((0,io._P)({name:"Preserve Scroll Changed",params:{newValue:t}})),s({...function(e){if((0,rl.hS)(e.preserveScroll))return{transitionPreserveScroll:e.preserveScroll}}({...e,preserveScroll:t})})},checked:!0===e.preserveScroll,mixed:(0,rl.gl)(e.preserveScroll),recordingKey:as.Pt(n,"preserve-scroll-check"),label:r.createElement(iV.J,null,(0,d.tx)("proto.animation_panel.preserve_scroll_position"))}),f=u?r.createElement(ip.TN,null,h):r.createElement(rw.fI,{className:Eu},h),v=r.createElement(sk.S,{onChange:t=>{m((0,io._P)({name:"Reset Scroll Position Changed",params:{newValue:t,noodleUpgradedThisSession:Ep.zZ.haveAnyInteractionsBeenUpgraded(p)}})),s({...function(e){if((0,rl.hS)(e.resetScrollPosition))return{transitionResetScrollPosition:e.resetScrollPosition}}({...e,resetScrollPosition:t})})},checked:!0===e.resetScrollPosition,mixed:(0,rl.gl)(e.resetScrollPosition),recordingKey:as.Pt(n,"reset-scroll-position-check"),label:r.createElement(iV.J,null,(0,d.tx)("proto.animation_panel.reset_scroll_position"))}),b=r.createElement("div",{"data-tooltip-type":rM.Ib.SPECIAL,"data-tooltip":Em,"data-tooltip-interactive":!0,"data-tooltip-show-immediately":!0,"data-tooltip-max-width":240,className:u?"prototype_state_management_panel--stateManagementPanelTooltipUI3--x5MQ3":void 0},r.createElement(Ed.In,{icon:"info-16"})),S=u?r.createElement(ip.TN,null,v," ",b):r.createElement(rw.fI,{className:Eu},v),T=r.createElement(sk.S,{onChange:t=>{m((0,io._P)({name:"Reset Component State Changed",params:{newValue:t,noodleUpgradedThisSession:Ep.zZ.haveAnyInteractionsBeenUpgraded(p)}})),s({...function(e){if((0,rl.hS)(e.resetInteractiveComponents))return{transitionResetInteractiveComponents:e.resetInteractiveComponents}}({...e,resetInteractiveComponents:t})})},checked:!0===e.resetInteractiveComponents,mixed:(0,rl.gl)(e.resetInteractiveComponents),recordingKey:as.Pt(n,"reset-component-state-check"),label:r.createElement(iV.J,null,(0,d.tx)("proto.animation_panel.reset_component_state"))}),N=u?r.createElement(ip.TN,null,T):r.createElement(rw.fI,{className:Eu},T),I=r.createElement(sk.S,{onChange:t=>{m((0,io._P)({name:"Reset Video Position Changed",params:{newValue:t}})),s({...function(e){if((0,rl.hS)(e.resetVideoPosition))return{transitionResetVideoPosition:e.resetVideoPosition}}({...e,resetVideoPosition:t})})},checked:!0===e.resetVideoPosition,mixed:(0,rl.gl)(e.resetVideoPosition),recordingKey:as.Pt(n,"reset-video-position-check"),label:r.createElement(iV.J,null,(0,i0.LH)(c)?(0,d.tx)("proto.state_management.reset_video_state"):(0,d.tx)("proto.animation_panel.reset_video_state"))}),P=u?r.createElement(ip.TN,null,I):r.createElement(rw.fI,{className:Eu},I),C=r.createElement(rw.Zk,{className:`prototype_state_management_panel--stateManagementPanel--sYaaj ${(0,i0.kM)(c)&&"prototype_state_management_panel--stateManagementPanelWithVersion--AovOP"}`},!u&&r.createElement(rw.fI,null,r.createElement(rw.xw,{className:"prototype_state_management_panel--panelTitle--Nr4Eh",faded:!0},(0,d.tx)("proto.state_management")),!(0,i0.kM)(c)&&b),(0,i0.uU)(c)&&a&&f,l&&(0,i0.uU)(c)&&P,_&&S,_&&i&&N,_&&l&&P,(0,rl.gl)(c)&&r.createElement(pr.Y,{direction:"horizontal",padding:{horizontal:12,vertical:12}},r.createElement(rw.UZ,null,(0,d.tx)("proto.state_management.mixed_state_update")))),k=r.createElement(rD.U,{svg:E?rW.A:rH.A},E?r.createElement(rx.O,{className:EE}):r.createElement(rO.k,{className:EE})),A=r.createElement(nb.E,{key:"expand-caret",recordingKey:as.Pt(n,"expand-caret"),onClick:()=>{g(!E)},actionOnPointerDown:!0,className:"prototype_state_management_panel--expandRow--RVDCp"},k,r.createElement("span",null,(0,d.tx)("proto.state")));return r.createElement(rf.k,{name:"prototype_state_management_panel"},u&&A,(E||!u)&&C)}let Ey=iv.c$,E_=iv.l6,Eh=ir.AD;class Ef extends iz.cP{format(e){return e===Eh||null===e?(0,d.t)("proto.target_video_node_name_formatter.this_video"):super.format(e)}}function Ev(e){let{viableSameFrameVideoIds:t,disabledSameFrameVideoIds:n,scene:a,dropdownShown:l,targetVideoNodeID:i,isVideoSelected:s,onChange:c}=e,p=(0,o.wA)(),[m,u]=r.useState(()=>s?new Ef(a):new iz.cP(a));t.sort((e,t)=>{let n=m.format(e),a=m.format(t);return n.localeCompare(a)}),s&&t.unshift(Eh);let E=t.length>0&&n.length>0,g=`prototype-target-video-select-${e.recordingKey}`,y=(0,ew.GS)(),_=r.createElement(E_,{id:g,dataTestId:"target-video-select",className:"prototype_target_video_dropdown--targetVideoDropdown--6hKF-",chevronClassName:"prototype_target_video_dropdown--chevron--jgz53",inputClassName:"prototype_target_video_dropdown--input--infAK",property:(0,rl.gl)(i)?i:ir.dI(i),formatter:m,onChange:c,dispatch:p,dropdownShown:l,recordingKey:as.Pt(e,"select"),onOptionFocus:e=>{e_.Uc(e??"")},dropdownAlignment:"left"},t.filter(e=>m.hasNameForNode(e)).map((t,n)=>r.createElement(Ey,{key:`enabled-${n}`,value:t,recordingKey:as.Pt(e,`viable-option-${n}`),disabled:!1})),E&&r.createElement(iv.sK,null),n.filter(e=>m.hasNameForNode(e)).map((t,n)=>r.createElement(Ey,{key:`disabled-${n}`,value:t,recordingKey:as.Pt(e,`viable-option-${n}`),disabled:!0})));return y?r.createElement(ip.cS,{input:_,label:(0,d.tx)("proto.video_dropdown.label")}):_}var Eb=n(466391);function ES({action:e,recordingKey:t,onURLChange:n,onOpenInNewTabChange:a}){let o=(0,ew.GS)(),l=r.createElement(Eb.ks,{className:o?"prototype_open_url_action_options--urlInputUI3--H-JfT":"prototype_open_url_action_options--urlInput--T-tGT",dataTestId:"url-input",placeholder:(0,d.t)("proto.interaction.example_com"),value:(0,rl.gl)(e.connectionURL)?(0,d.t)("fullscreen.mixed"):(0,rl._W)(e.connectionURL,""),onChange:n,recordingKey:as.Pt(t,"urlTextInput"),autoFocus:!1}),i=r.createElement(sk.S,{label:r.createElement(iV.J,null,(0,d.tx)("proto.action_open_url_in_new_tab")),onChange:a,recordingKey:as.Pt(t,"open-url-in-new-tab-check"),checked:void 0===e.openUrlInNewTab||!0===e.openUrlInNewTab});return r.createElement(r.Fragment,null,o?r.createElement(ip.cS,{label:(0,d.tx)("proto.open_url.text_input_label"),input:l}):l,o?r.createElement(ip.TN,null,i):r.createElement(rw.fI,{className:"prototype_open_url_action_options--checkboxRow--mu17T checkbox--_checkboxRow--oEhow"},i))}var ET=n(588599);function EN({updateSelectionProperties:e,action:t,extraScrollOffset:n,showScrollToOptions:a,recordingKey:l}){let{smallNudgeAmount:i,bigNudgeAmount:s}=(0,aJ.sT)(),c=(0,o.wA)(),p=(0,ew.GS)(),m=(t,n)=>(a,r)=>{t&&e({extraScrollOffset:{...t,[n]:a}},{shouldCommit:r})},u=(0,rl._W)(n,{x:0,y:0});if(!a||"SCROLL_TO"!==t)return null;let E=r.createElement(ly.gq,{className:p?void 0:m2.U,inputClassName:p?m2.oM:m2.hF,value:u.y,wheelMultiplier:i,scrubMultiplier:i,smallNudgeAmount:i,bigNudgeAmount:s,onValueChange:m(u,"y"),dispatch:c,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.y_offset"),tooltipForScreenReadersOnly:!1,recordingKey:as.Pt(l,"extraScrollOffsetY")},p?r.createElement("span",{className:m2.QK},(0,d.tx)("proto.scroll_options.scroll_offset.y")):r.createElement(nH.B,{className:m2.QK,svg:ET.A})),g=r.createElement(ly.gq,{className:p?void 0:m2.sC,inputClassName:p?m2.oM:m2.hF,value:u.x,wheelMultiplier:i,scrubMultiplier:i,smallNudgeAmount:i,bigNudgeAmount:s,onValueChange:m(u,"x"),dispatch:c,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.x_offset"),tooltipForScreenReadersOnly:!1,recordingKey:as.Pt(l,"extraScrollOffsetX")},p?r.createElement("span",{className:m2.QK},(0,d.tx)("proto.scroll_options.scroll_offset.x")):r.createElement(nH.B,{className:m2.Kh,svg:ET.A}));return p?r.createElement(ip.Cm,{label:(0,d.tx)("proto.scroll_options.offset"),leftInput:g,rightInput:E}):r.createElement(rw.fI,null,E,g)}let EI=(0,r.memo)(function(e){return(0,nU.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,nU.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M18 12a6 6 0 1 1-12 0 6 6 0 0 1 12 0m1 0a7 7 0 1 1-14 0 7 7 0 0 1 14 0m-6.5-3.5a.5.5 0 0 0-1 0V12a.5.5 0 0 0 .146.354l2 2a.5.5 0 0 0 .708-.708L12.5 11.793z",clipRule:"evenodd"})})}),EP="prototype_video_action_options--chevron--mkNyv",EC="prototype_video_action_options--input--3-cEi",Ek=new iz.js,EA=new iz.Z6;function Ew({action:e,onChange:t,updateSelectionProperties:n,dropdownShown:a,recordingKey:l}){let i=(0,ew.GS)(),s=(0,iz.Od)(e),c=(0,rl.E7)(e.mediaAction),p="UPDATE_MEDIA_RUNTIME"===(0,rl.E7)(e.connectionType),m="SKIP_TO"===c,u="SKIP_FORWARD"===c||"SKIP_BACKWARD"===c,E="PLAY"===c||"PAUSE"===c||"TOGGLE_PLAY_PAUSE"===c,g="MUTE"===c||"UNMUTE"===c||"TOGGLE_MUTE_UNMUTE"===c,y=(0,o.wA)(),_=(0,aJ.RU)(),h=r.useCallback(e=>{n({mediaSkipToTime:e}),y((0,io._P)({name:"Media skip to time changed",params:{value:e}}))},[y,n]),f=`prototype-media-action-select-${l}`,v="prototype_video_action_options--shortDropdown--NOXXv",b=a&&a.type===f?Ek:EA,S=r.createElement(mX,{id:f,dataTestId:"media-play-pause-select",className:v,chevronClassName:EP,inputClassName:EC,property:s,formatter:b,onChange:t,dispatch:y,dropdownShown:a,recordingKey:as.Pt(l,"select")},r.createElement(m$,{key:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",value:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",recordingKey:as.Pt(l,"toggle-play-pause-option"),disabled:!1}),r.createElement(m$,{key:"UPDATE_MEDIA_PLAY",value:"UPDATE_MEDIA_PLAY",recordingKey:as.Pt(l,"play-option"),disabled:!1}),r.createElement(m$,{key:"UPDATE_MEDIA_PAUSE",value:"UPDATE_MEDIA_PAUSE",recordingKey:as.Pt(l,"pause-option"),disabled:!1})),T=r.createElement(mX,{id:f,dataTestId:"media-mute-unmute-select",className:v,chevronClassName:EP,inputClassName:EC,property:s,formatter:b,onChange:t,dispatch:y,dropdownShown:a,recordingKey:as.Pt(l,"select")},r.createElement(m$,{key:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",value:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",recordingKey:as.Pt(l,"toggle-mute-unmute-option"),disabled:!1}),r.createElement(m$,{key:"UPDATE_MEDIA_MUTE",value:"UPDATE_MEDIA_MUTE",recordingKey:as.Pt(l,"mute-option"),disabled:!1}),r.createElement(m$,{key:"UPDATE_MEDIA_UNMUTE",value:"UPDATE_MEDIA_UNMUTE",recordingKey:as.Pt(l,"unmute-option"),disabled:!1})),N=r.createElement(mX,{id:f,dataTestId:"media-skip-by-select",className:v,chevronClassName:EP,inputClassName:EC,property:s,formatter:b,onChange:t,dispatch:y,dropdownShown:a,recordingKey:as.Pt(l,"select"),dropdownWidth:160},r.createElement(m$,{key:"UPDATE_MEDIA_SKIP_FORWARD",value:"UPDATE_MEDIA_SKIP_FORWARD",recordingKey:as.Pt(l,"skip-forward-option"),disabled:!1}),r.createElement(m$,{key:"UPDATE_MEDIA_SKIP_BACKWARD",value:"UPDATE_MEDIA_SKIP_BACKWARD",recordingKey:as.Pt(l,"skip-backward-option"),disabled:!1})),I=r.createElement(ly.qd,{className:"prototype_video_action_options--timestampContainer---DdaI",inputClassName:"prototype_video_action_options--timestamp--luOrs",dataTestId:"mediaSkipToTime-input",dispatch:y,value:e.mediaSkipToTime||0,onValueChange:h,wheelMultiplier:_/1e3,scrubMultiplier:_/1e3,max:3600,displayFractions:!0,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.timestamp_to_set_to"),tooltipForScreenReadersOnly:!0,recordingKey:as.Pt(l,"mediaSkipToTimeInput")},i?r.createElement(EI,null):void 0),P="SKIP_BACKWARD"===c?(0,d.t)("proto.trigger.duration_to_jump_backward"):(0,d.t)("proto.trigger.duration_to_jump_forward"),C=r.createElement(ly.dE,{className:"prototype_video_action_options--timeAmountContainer--5kpHn",dataTestId:"mediaSkipByAmount-input",dispatch:y,value:e.mediaSkipByAmount||5,onValueChange:e=>{n({mediaSkipByAmount:e}),y((0,io._P)({name:"Media skip by amount changed",params:{value:e}}))},wheelMultiplier:_/1e3,scrubMultiplier:_/1e3,max:3600,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":P,tooltipForScreenReadersOnly:!0,recordingKey:as.Pt(l,"mediaSkipByAmountInput")});if(!p)return null;if(i){if(E)return r.createElement(ip.cS,{input:S,label:(0,d.tx)("proto.video_options.behavior")});if(g)return r.createElement(ip.cS,{input:T,label:(0,d.tx)("proto.video_options.behavior")});if(u)return r.createElement(r.Fragment,null,r.createElement(ip.cS,{input:N,label:(0,d.tx)("proto.video_options.direction")}),r.createElement(ip.cS,{input:C,label:(0,d.tx)("proto.video_options.offset")}));if(m)return r.createElement(ip.cS,{input:I,label:(0,d.tx)("proto.video_options.timestamp")})}return r.createElement(rw.fI,null,E&&S,g&&T,u&&N,u&&C,m&&I)}function EO({action:e,recordingKey:t,interactionType:n,onActionChange:a,updateMultipleDestinationNodes:l,updateSelectionProperties:s,stateManagementVersion:c,autoOpenVariablePicker:p,autoOpenExpressionBuilder:m,setAutoOpenExpressionBuilder:u,...E}){let g=(0,o.wA)(),y=(0,r3.Um)(),{scene:_}=(0,aY.R)(e=>({scene:e.mirror.sceneGraph})),h=(0,ew.GS)(),f=(0,i0.YT)(),v=f===i0.Oz.SINGLE_COL,b=f===i0.Oz.TWO_COL,S=r.useContext(m0.c),T=b&&S===m0.P.RIGHT,N="SET_VARIABLE"===(0,rl.E7)(e.connectionType),I="SET_VARIABLE_MODE"===(0,rl.E7)(e.connectionType),P="CONDITIONAL"===(0,rl.E7)(e.connectionType),C="INTERNAL_NODE"===(0,rl.E7)(e.connectionType),k="INTERNAL_NODE"===(0,rl.E7)(e.connectionType)&&"SWAP_STATE"===(0,rl.E7)(e.navigationType),A="URL"===(0,rl.E7)(e.connectionType),w=C||"BACK"===(0,rl.E7)(e.connectionType)||"CLOSE"===(0,rl.E7)(e.connectionType),O="UPDATE_MEDIA_RUNTIME"===(0,rl.E7)(e.connectionType),x=(0,o.d4)(e=>{let t=e.mirror.selectionProperties.numSelected,n=e.mirror.selectionProperties.numVideosSelected;return 1===t&&!!n}),R=(0,tY.uQ)(),L=[],D=[];if(R){let{viableIds:e,disabledIds:t}=i.X3B.getVideoNodesOnSameTlfAsNode(R);L=e,D=t}let M=ir.dI((0,rl.E7)(e.transitionNodeID)),K=null!=M&&M!==ir.AD,F=C&&(!(0,rl.hS)(e.transitionNodeID)||K),V=(0,rl.E7)(e.navigationType),U=C&&"OVERLAY"===(0,rl.E7)(V),B=(0,i0.hU)(e.transitionType,e.easingType,e.easingFunction,e.transitionDuration,e.transitionShouldSmartAnimate,e.transitionPreserveScroll,e.transitionResetVideoPosition,e.openUrlInNewTab,e.transitionResetScrollPosition,e.transitionResetInteractiveComponents),G=w&&!U&&("INSTANT"===B.behavior||"DISSOLVE"===B.behavior),z=C&&"OVERLAY"===(0,rl.E7)(e.navigationType)&&K,H=C&&(U||"SWAP"===(0,rl.E7)(V)),Y=!O&&(0,i0.oc)(e),$=(0,i0.GB)(e),X=(0,i0.uU)(c)?G||Y:(0,i0.Fp)(c,e.connectionType,e.navigationType),{selectedInteractions:j}=(0,i4.Ay)(iX.J.NORMAL),Q=j.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>iG.d({nodeID:e.sourceNodeID,interactionID:e.id})),J=r.useCallback(e=>{let t=ir.sH(e);t&&s({transitionNodeID:t}),g((0,io._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(Q),destinationTlfId:e}}))},[g,s,Q]),q=r.useCallback(e=>{l(e),g((0,io._P)({name:"Variant based prototyping UI changed",params:{source:"panel"}})),g((0,io._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(Q)}}))},[l,g,Q]),Z=r.useCallback(e=>{s({connectionURL:e.target.value})},[s]),ee=(0,iz.Od)(e),et=eG()({[m2.Ph]:!h,[m2.Ti]:E.isNestedInConditional&&!v&&!T}),en=C&&!k,ea=r.createElement(u7,{className:m2.iR,dispatch:g,dropdownShown:y,onChange:J,nodeId:e.transitionNodeID||ir.Hr,scene:_,recordingKey:as.Pt(t,"destinationDropdown"),action:ee,isUI3:h}),er=r.createElement(EN,{action:ee,showScrollToOptions:"SCROLL_TO"===ee,extraScrollOffset:e.extraScrollOffset,updateSelectionProperties:s,recordingKey:as.Pt(t,"scrollOptionsPanel")}),eo=r.createElement(uR,{interactionType:n,updateSelectionProperties:s,recordingKey:as.Pt(t,"overlaySettings"),actionIndexPath:E.actionIndexPath,nodeId:e.transitionNodeID||ir.Hr});return r.createElement("div",{className:et},en&&(h?r.createElement(r.Fragment,null,r.createElement(ip.cS,{label:H?(0,d.tx)("proto.overlay"):(0,d.tx)("proto.destination"),input:ea}),er,z&&eo):ea),A&&r.createElement(ES,{action:e,recordingKey:t,onOpenInNewTabChange:e=>{s({openUrlInNewTab:e}),g((0,io._P)({name:"Open Url In New Tab Changed",params:{value:e}}))},onURLChange:Z}),O&&r.createElement(Ev,{dropdownShown:y,scene:_,targetVideoNodeID:e.transitionNodeID||ir.Hr,recordingKey:as.Pt(t,"targetVideoDropdown"),viableSameFrameVideoIds:L,disabledSameFrameVideoIds:D,isVideoSelected:x,onChange:J}),r.createElement(Ew,{dropdownShown:y,action:e,onChange:a,updateSelectionProperties:s,recordingKey:t}),!h&&er,N&&r.createElement("div",{className:h?void 0:W.cx.ml4.$},r.createElement(Ec,{className:m2.PB,dispatch:g,onChange:J,nodeId:e.transitionNodeID||ir.Hr,targetVariable:e.targetVariable||{id:""},targetVariableData:e.targetVariableData,updateSelectionProperties:s,recordingKey:as.Pt(t,"setVariableControls"),action:ee,isNestedInConditional:E.isNestedInConditional,isNarrowPanel:E.isNestedInConditional||E.isNarrowPanel,autoOpenVariablePicker:p})),I&&r.createElement("div",{className:h?void 0:W.cx.ml4.$},r.createElement(uv,{dispatch:g,targetVariableSetID:e.targetVariableSetID,targetVariableModeID:e.targetVariableModeID,deprecatedTargetVariableSetKey:e.targetVariableSetKey,updateSelectionProperties:s,recordingKey:as.Pt(t,"setVariableControls"),actionIndexPath:E.actionIndexPath.join(",")})),P&&(T?r.createElement(u1,{recordingKey:as.Pt(t,"conditionalActionSection","conditional-block",0),autoOpenExpressionBuilder:m,setAutoOpenExpressionBuilder:u,updateSelectionProperties:s,conditionalActions:(0,rl.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]}):r.createElement(u0,{updateSelectionProperties:s,recordingKey:as.Pt(t,"conditionalActionSection"),action:e,updateMultipleDestinationNodes:l,interactionType:n,stateManagementVersion:c,selectedInteractions:E.selectedInteractions,actionIndexPath:E.actionIndexPath,onDrop:E.onDrop,onSelect:E.onSelect,onExpand:E.onExpand,onNewActionAdded:E.onNewActionAdded,selectedActionIndex:E.selectedActionIndex,expandedRows:E.expandedRows,autoOpenVariablePicker:p,handleMouseDownUI3:E.handleMouseDownUI3})),k&&r.createElement("div",{className:W.cx.ml0.$},r.createElement(u6,{onChange:q,nodeId:e.transitionNodeID||ir.Hr,recordingKey:as.Pt(t,"consumption"),actionIndexPath:E.actionIndexPath})),F&&r.createElement(r.Fragment,null,h&&r.createElement("div",{className:m2.x}),r.createElement(uB.X7,{transition:B,interactionType:n,navigationType:e.navigationType,recordingKey:as.Pt(t,"animationPanel"),updateSelectionProperties:s,isNarrowPanel:E.isNestedInConditional||E.isNarrowPanel,stateManagementVersion:c})),z&&!h&&eo,X&&r.createElement(r.Fragment,null,h&&r.createElement("div",{className:m2.x}),r.createElement(Eg,{connectionType:e.connectionType,transition:B,navigationType:e.navigationType,recordingKey:as.Pt(t,"stateManagementPanel"),updateSelectionProperties:s,showPreserveScrollPosition:G,showResetVideoState:!!Y,showResetInteractiveComponentState:!!$,stateManagementVersion:c,selectedInteractions:E.selectedInteractions})))}var Ex=n(474153),ER=n(323110),EL=n(482725);let ED=Symbol("ACTION_ROW");function EM({updateMultipleDestinationNodes:e,updateSelectionProperties:t,onDeleteAction:n,stateManagementVersion:a,selectedInteractions:l,autoOpenVariablePicker:i,autoOpenExpressionBuilder:s,setAutoOpenExpressionBuilder:c,...p}){let m=(0,o.wA)(),{shouldShowAdvancedPrototypingPaywall:u,showAdvancedPrototypingVariablesModal:E,showAdvancedPrototypingConditionalActionsModal:g}=(0,i0.zt)(),_=(0,r3.Um)(),h=(0,i0.hP)(),{firstVariableSetMode:f,firstVariableSetID:v}=uf(),b=p.action,S=p.isNestedInConditional&&(0,uG.qQ)(p.action),T=!!b.connectionType&&"CONDITIONAL"===b.connectionType,N=(0,ew.GS)(),I=(0,i0.YT)(),P=I===i0.Oz.SINGLE_COL,C=I===i0.Oz.TWO_COL,k=r.useContext(m0.c),A=C&&k===m0.P.RIGHT,w=C&&k===m0.P.LEFT,O=!((0,rl.gl)(p.action)||["CLOSE","NONE"].includes(b.connectionType))&&!N;var x=p.selectedActionIndex.equals(p.actionIndexPath);let R=1===p.selectedActionIndex.path.length&&p.isNestedInConditional&&p.actionIndexPath[0]===p.selectedActionIndex.path[0];var L=void 0===p.expandedRows||void 0!==p.expandedRows.find(e=>e.equals(p.actionIndexPath));N&&(L=!!P||!w||T);let D=r.useCallback(()=>{(O||P)&&p.onExpand(p.actionIndexPath)},[O,P,p]),[M,K]=r.useState(!1);r.useEffect(()=>{if(T){let e=setTimeout(()=>{K(!0)},0);return()=>clearTimeout(e)}K(!0)},[T]);let F=T&&!L,V=T&&L,U=r.useRef(null),[B,G]=(0,y.fp)(i0.hV),{position:z,dragItem:W}=(0,mU.h4)(()=>({type:ED,element:U,item:p.action,dropPositionThreshold:V?.2:F?1/3:.5,getDeepestTargetOnly:!0,canDrag:!!w||!L,onDrop(e){p.onDrop(e),G(!0)}})),H=r.useMemo(()=>{let e=U.current;if(!e||!z||A)return;if(W&&"CONDITIONAL"===W.connectionType&&p.isNestedInConditional||(0,uG.qQ)(W)){G(!1);return}let t=S?mU.Nz.BEFORE:z;var n=void 0;let a=e.offsetParent?.firstElementChild?.scrollTop??0;return t===mU.Nz.BEFORE?n=e.offsetTop-a:t===mU.Nz.AFTER&&(n=e.offsetTop+e.offsetHeight-a),G(!0),n},[z,A,W,p.isNestedInConditional,S,G]),Y=z&&T&&!L&&z===mU.Nz.INSIDE&&"CONDITIONAL"!==W.connectionType,$=as.rf(p.recordingKey,"mousedown",e=>{L||(x=!0,p.onSelect(p.actionIndexPath,!0))}),X=as.rf(p.recordingKey,"mousedown",e=>{x=!1,p.onSelect(p.actionIndexPath,!1)}),j=as.rf(p.recordingKey,"click",e=>{p.onSelect(p.actionIndexPath,!0)}),Q=as.rf(p.recordingKey,"mousedown",e=>{(0,uG.qQ)(p.action)||p.onSelect(p.actionIndexPath,!0)}),J=e=>{var n=!0,a=!1;switch(e){case"NONE":t({connectionType:"NONE"});break;case"NAVIGATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"NAVIGATE"});break;case"OPEN_OVERLAY":t({connectionType:"INTERNAL_NODE",navigationType:"OVERLAY"});break;case"SCROLL_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SCROLL_TO"});break;case"SWAP_WITH":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP"});break;case"SWAP_STATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP_STATE"});break;case"GO_BACK":t({connectionType:"BACK"});break;case"CLOSE_OVERLAY":t({connectionType:"CLOSE"});break;case"OPEN_URL":t({connectionType:"URL"});break;case"SET_VARIABLE":u?(n=!1,E()):(t({connectionType:"SET_VARIABLE"}),i.current=!0);break;case"SET_VARIABLE_MODE":u?(n=!1,E()):t({connectionType:"SET_VARIABLE_MODE",targetVariableSetID:v,targetVariableModeID:f});break;case"UPDATE_MEDIA_PLAY":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PLAY"});break;case"UPDATE_MEDIA_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PAUSE"});break;case"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_PLAY_PAUSE"});break;case"UPDATE_MEDIA_MUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"MUTE"});break;case"UPDATE_MEDIA_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"UNMUTE"});break;case"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_MUTE_UNMUTE"});break;case"UPDATE_MEDIA_SKIP_BY_OPTIONS":case"UPDATE_MEDIA_SKIP_FORWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_FORWARD"});break;case"UPDATE_MEDIA_SKIP_BACKWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_BACKWARD"});break;case"UPDATE_MEDIA_SKIP_TO":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_TO"});break;case"CONDITIONAL":a=!0,u?(n=!1,g()):(t({connectionType:"CONDITIONAL"}),N&&c&&c(!0))}if(N||L||D(),C&&p.onExpand(p.actionIndexPath,a),n){let t=l.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>iG.d({nodeID:e.sourceNodeID,interactionID:e.id}));m((0,io._P)({name:"Prototype action changed",params:{action:e,source:"panel",connectorIds:JSON.stringify(t)}}))}},q=p.isNestedInConditional?m2.It:m2.ft,Z=eG()({[m2.wu]:!w,[m2.zX]:w&&B}),ee=r.createElement(rD.U,{svg:ER.A},r.createElement(mz,{className:m2._2}));if(S&&p.onAddAction)return r.createElement("div",{className:w?m2.LW:void 0},H&&r.createElement("hr",{className:q,style:{transform:`translateY(${H}px)`}}),w&&p.isNestedInConditional&&ee,r.createElement("div",{className:Z,ref:U},r.createElement(uY,{addButtonPressed:p.onAddAction,recordingKey:as.Pt(p.recordingKey,"addAction"),isNestedInConditional:!0})));let et=(0,iz._X)(b),en="NONE"!==et,ea=(L||!en)&&!w,er=p.numActions>1,eo=(p.numActions>1||p.isNestedInConditional)&&!w,el=eG()({[m2.$l]:!0,[m2.KY]:w&&!p.isNestedInConditional,[m2.Iw]:w&&!p.isNestedInConditional&&B,[m2.DM]:w&&p.isNestedInConditional,[m2.vs]:w&&p.isNestedInConditional&&B,[m2.M9]:w&&p.isNestedInConditional&&R&&B,[m2.I_]:w&&T&&!x&&B,[m2.Cu]:x&&!N,[m2.PE]:x&&w&&!p.isNestedInConditional,[m2.Ze]:Y,[m2.Op]:p.isNestedInConditional&&!N}),ei=eG()({[m2.rn]:!0,[m2.Gu]:w,[m2.Ti]:p.isNestedInConditional&&!N&&!A,[m2.Yo]:p.isNestedInConditional&&N&&!A}),es=r.createElement(nH.B,{key:"expand-caret",className:m2.GE,svg:L?rW.A:rH.A,recordingKey:as.Pt(p.recordingKey,"expandCaret"),onClick:D}),ec=r.createElement(m6,{action:b,isNestedInConditional:p.isNestedInConditional,isNarrowPanel:p.isNarrowPanel&&er,onClick:N?j:void 0}),ed=r.createElement(mQ,{className:"NONE"===et||N?void 0:Ex.fH,dispatch:m,dropdownShown:_,onChange:J,action:et,recordingKey:as.Pt(p.recordingKey,"actionDropdown"),showVideoActions:h,isNestedInConditional:p.isNestedInConditional}),ep=r.createElement(rw.K0,{className:N?m2.gG:m2.hH,onClick:n,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("proto.prototype_panel.delete"),"aria-label":(0,d.t)("proto.prototype_panel.delete"),recordingKey:as.Pt(p.recordingKey,"actionDeleteButton")},r.createElement(rD.U,{svg:EL.A},r.createElement(iU.O,null))),em=r.createElement(rw.fI,{className:ei,onDoubleClick:D},O&&es,ea?r.createElement("span",{className:m2.P2},ed):ec,eo&&ep),eu=ea?ed:ec,eE=r.createElement(mW.S.div,{className:ei,onDoubleClick:D},O&&es,eo?r.createElement(oY.DE,{appendedClassName:m2.Jw,label:null,input:eu,icon:ep}):r.createElement(oY.Ad,{appendedClassName:m2.Jw,label:null,input:eu})),eg=(0,d.tx)("proto.action"),ey=r.createElement(mW.S.div,{className:ei},P||A?r.createElement(ip.cS,{label:eg,input:eu}):eu),e_=N?ey:eE,eh=eG()({[m2.Oe]:!0,[m2.h2]:x,[m2.Ob]:T});return r.createElement(mW.S.div,{className:el,ref:U,role:"button",tabIndex:0,onMouseDown:N?void 0:$,onMouseUp:N?void 0:X},void 0!==H&&r.createElement("hr",{className:q,style:{transform:`translateY(${H}px)`}}),w?r.createElement(mW.S.div,{className:eh,role:"button",tabIndex:0,onMouseDown:N?Q:void 0},p.isNestedInConditional&&ee,e_):N?e_:em,L&&M&&r.createElement(EO,{updateMultipleDestinationNodes:e,action:b,onActionChange:J,recordingKey:p.recordingKey,updateSelectionProperties:t,interactionType:p.interactionType,stateManagementVersion:a,selectedInteractions:l,isNestedInConditional:p.isNestedInConditional,isNarrowPanel:p.isNarrowPanel,actionIndexPath:p.actionIndexPath,onDrop:p.onDrop,onSelect:p.onSelect,onExpand:p.onExpand,onNewActionAdded:p.onNewActionAdded,selectedActionIndex:p.selectedActionIndex,expandedRows:p.expandedRows,autoOpenVariablePicker:i,autoOpenExpressionBuilder:s,setAutoOpenExpressionBuilder:c,handleMouseDownUI3:Q}))}var EK=n(427113),EF=n(220877);function EV({onChange:e,value:t,shouldFocusKeyCaptureField:n,setShouldFocusKeyCaptureField:a}){let o;let l=(0,i1._i)(t?.keyCodes),i=t=>e({keyCodes:t,triggerDevice:"KEYBOARD"}),[s,c]=r.useState(!1),p=r.useRef(null);r.useEffect(()=>{(!t||!t.keyCodes||0===t.keyCodes.length)&&n&&p.current&&(a(!1),p.current.focus(),c(!0))},[a,n,t]),r.useEffect(()=>{if(!s)return()=>{};let t=new EF.L,n=t.onPress(t=>{e({keyCodes:[t.buttons[0]],triggerDevice:t.controllerType}),requestAnimationFrame(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})});return t.start(),()=>{n.release(),t.end()}},[e,s]);let m=null,u=(0,i1.E8)(t),E=(0,ew.GS)();return s?o=r.createElement(EU,null,E?(0,d.tx)("proto.keyCapture.press_key_lowercase"):(0,d.tx)("proto.keyCapture.press_key")):t?.triggerDevice==="KEYBOARD"&&l?m=(0,i1.U8)(l):u?m=u:o=r.createElement(EU,null,E?(0,d.tx)("proto.keyCapture.click_to_set_key"):(0,d.tx)("proto.keyCapture.click_to_select")),r.createElement(rw.rp,{ref:p,className:"prototype_key_capture_field--root--bD21s","data-tooltip-type":rM.Ib.TEXT,"data-tooltip":m&&m.length>10?m:null,onFocus:()=>c(!0),onBlur:()=>c(!1),onKeyDown:e=>{e.preventDefault(),e.stopPropagation();let t=e.which||e.keyCode;!i1.RI.has(t)&&i1.pu[t]&&(t===l?.keyCode&&e.repeat?i((0,i1.wb)({keyCode:t,metaKey:e.metaKey||l.metaKey,shiftKey:e.shiftKey||l.shiftKey,ctrlKey:e.ctrlKey||l.ctrlKey,altKey:e.altKey||l.altKey})):i((0,i1.wb)({...e,keyCode:t})),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},recordingKey:"keycapture"},m??o)}function EU({children:e}){return r.createElement("span",{className:"prototype_key_capture_field--placeholder--gWUKF"},e)}let EB=iv.l6,EG=iv.c$,Ez=new iz.VG,EW=new iz.EX,EH=new iz.JV,EY=new iz.Eq;function E$(e){let t=(0,o.wA)(),n=(0,r3.Um)(),a=(0,ew.GS)(),l=(0,ia.cJ)(),{showVideoV2Triggers:s}=(0,aY.R)(e=>({allStatesInSelection:e.mirror.selectionProperties.stateGroupSelectionInfo?.mode===i.iCO.STATE,allTopLevelFramesInSelection:!!e.mirror.selectionProperties.allTopLevelFramesInSelection,showVideoV2Triggers:(0,iW.dq)(e.mirror.selectionProperties)})),c=(0,y.md)(iH.NE),d=(t,n)=>{let o=r.createElement("div",{className:"transition_interaction_dropdown--prototypeInteractionIcon---njby"},(0,iW.e7)(t));return r.createElement(EG,{key:n,value:t,icon:a?o:void 0,recordingKey:as.Pt(e,t),disabled:!function(t){if("NONE"===t)return!0;let n=!!e.interactionsOnSelectedNodes&&e.interactionsOnSelectedNodes.every(t=>e.interactionsOnSelectedNodes&&ir.aI(t.sourceNodeID,e.interactionsOnSelectedNodes[0].sourceNodeID))&&!(0,rl.hS)(e.property),a=(function(){if(e.interactionsOnSelectedNodes)return new Set(e.interactionsOnSelectedNodes.map(e=>e?.event?.interactionType).filter(e=>void 0!==e))})()?.has(t)&&(0,rl.hS)(e.property)&&e.property!==t;return(!n&&!a||!!["ON_KEY_DOWN","DRAG","ON_VOICE","ON_MEDIA_HIT"].includes(t))&&("AFTER_TIMEOUT"===t?!e.interactionContainsOpenLinkAction:"ON_MEDIA_HIT"===t||"ON_MEDIA_END"===t?s:(!e.interactionContainsOpenLinkAction||"ON_CLICK"===t||"MOUSE_UP"===t)&&(!e.interactionContainsUpdateMediaRuntime||"ON_HOVER"!==t&&"ON_PRESS"!==t&&"DRAG"!==t)&&(!e.interactionOnlyContainsBack||"ON_HOVER"!==t&&"ON_PRESS"!==t))}(t)})},p=(l?[]:["NONE"]).map(d),m=["ON_CLICK",...l?[]:["DRAG"],"ON_HOVER","ON_PRESS","ON_KEY_DOWN"].map(d),u=["MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].map(d),E=(l?[]:["ON_MEDIA_HIT","ON_MEDIA_END"]).map(d),g=["AFTER_TIMEOUT"].map(d),_=c?"ON_MEDIA_HIT"!==e.property?EW:EY:"ON_MEDIA_HIT"!==e.property?Ez:EH,h=r.useCallback(e=>e-24,[]),f=(0,rl.E7)(e.property);return r.createElement(EB,{id:"interaction-type-select",className:e.className,chevronClassName:"transition_interaction_dropdown--chevron--pyzhq",dataTestId:"interaction-select",property:e.property,formatter:_,icon:a&&f?(0,iW.e7)(f):void 0,onChange:e.onChange,dispatch:t,dropdownShown:n,recordingKey:as.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,tz.nl)(),dropdownAlignment:h,dropdownWidth:160},p,!l&&r.createElement(iv.sK,null),m,r.createElement(iv.sK,null),u,!l&&r.createElement(iv.sK,null),g,!l&&s&&[r.createElement(iv.sK,{key:""}),...E])}let EX={keyCodes:[],triggerDevice:"KEYBOARD"};function Ej(e,t,n,a){return n?r.createElement(ip.cS,{label:e,input:t,appendedClassName:a?void 0:m2.dU}):r.createElement(rw.fI,null,t)}function EQ(e){let{detailPropsMultipleActions:t,interactionsOnSelectedNodesAndComponents:n,updateSelectionProperties:a}=(0,i4.Ay)(e.category),{interactionType:l="NONE",transitionTimeout:i=.8,mediaHitTime:s=0,interactionMaintained:c=!1,interactionDuration:p=.3,keyTrigger:m=EX}=t.interactionEvent,u=(e,t)=>{if(e.connectionType===t)return e;if("CONDITIONAL"===e.connectionType)for(let n of(0,rl.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]){let e=n.actions?n.actions.find(e=>e.connectionType===t):void 0;if(void 0!==e)return e}return null},E=void 0!==t.interactionActions.find(e=>u(e,"URL")),g=void 0!==t.interactionActions.find(e=>u(e,"UPDATE_MEDIA_RUNTIME")),y=1===t.interactionActions.length&&"BACK"===t.interactionActions[0].connectionType,_=void 0!==t.interactionActions.find(e=>u(e,"CONDITIONAL"));return function(e){let t=(0,o.wA)(),n=e.updateSelectionProperties,a=(0,aJ.RU)(),[l,i]=r.useState(!1),s=(0,ew.GS)(),c=(0,i0.YT)(),p=c===i0.Oz.SINGLE_COL,m=c===i0.Oz.TWO_COL,u=!0===(0,rl.E7)(e.maintained),E=(0,rl.E7)(e.keyTrigger),g="ON_KEY_DOWN"===(0,rl.E7)(e.interactionType),y="AFTER_TIMEOUT"===(0,rl.E7)(e.interactionType),_="ON_MEDIA_HIT"===(0,rl.E7)(e.interactionType),h=["MOUSE_IN","MOUSE_OUT","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].indexOf((0,rl.E7)(e.interactionType)||"")>-1,f=r.createElement(E$,{className:m2.sQ,property:e.interactionType,onChange:a=>{mV.sn.start("interaction_details_changed"),n({interactionType:a}),t((0,io._P)({name:"Prototype Interaction Type Changed",params:{newType:a,oldType:(0,rl._W)(e.interactionType,"MIXED")}})),"ON_KEY_DOWN"===a&&i(!0)},interactionContainsOpenLinkAction:e.interactionContainsOpenLinkAction,interactionContainsUpdateMediaRuntime:e.interactionContainsUpdateMediaRuntime,interactionOnlyContainsBack:e.interactionOnlyContainsBack,recordingKey:as.Pt(e,"interactionDropdown"),interactionsOnSelectedNodes:e.interactionsOnSelectedNodes}),v=s?p?r.createElement(ip.cS,{label:(0,d.tx)("proto.trigger"),input:f}):r.createElement("div",{className:m2.BX},f):r.createElement(rw.fI,{className:eG()(m2.SG,m2.QT)},f,r.createElement("div",{className:m2.LY},e.headerButtons)),b=r.createElement(r.Fragment,null,y&&Ej((0,d.tx)("proto.delay"),r.createElement(ly.W4,{className:s?m2.Lp:m2.Zp,inputClassName:s?m2.Gl:void 0,dataTestId:"timeout-input",dispatch:t,value:e.timeout,onValueChange:e=>{n({transitionTimeout:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:20,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:as.Pt(e,"timeoutInput")},s?r.createElement(EK.A,null):void 0),s,p),g&&Ej((0,d.tx)("proto.key"),r.createElement(EV,{onChange:e=>{n({keyTrigger:e})},value:E,shouldFocusKeyCaptureField:l,setShouldFocusKeyCaptureField:i}),s,p),_&&Ej((0,d.tx)("proto.time"),r.createElement(ly.qd,{displayFractions:!0,className:m2.Ym,inputClassName:m2.vE,dataTestId:"mediaHitTime-input",dispatch:t,value:e.mediaHitTime,onValueChange:e=>{n({mediaHitTime:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:3600,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.video_hit_time"),tooltipForScreenReadersOnly:!0,recordingKey:as.Pt(e,"mediaHitTimeInput")},s?r.createElement(EI,null):void 0),s,p),h&&Ej((0,d.tx)("proto.delay"),r.createElement(ly.W4,{className:s?m2.Lp:m2.aq,inputClassName:s?m2.Gl:m2.p0,dataTestId:"duration-input",dispatch:t,value:u?e.interactionDuration:void 0,onValueChange:e=>{n(e&&e>0?{interactionMaintained:!0,interactionDuration:e}:{interactionMaintained:!1})},min:0,allowEmpty:!0,placeholder:(0,d.t)("proto.trigger.add_delay_placeholder"),wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,"data-tooltip-type":rM.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:as.Pt(e,"delayInput")},s?r.createElement(EK.A,null):void 0),s,p));return s?r.createElement("div",{className:m?m2.eU:void 0},v,b):r.createElement("div",{className:m2.cF},v,b)}({...e,updateSelectionProperties:a,interactionType:l,interactionContainsOpenLinkAction:E,interactionContainsUpdateMediaRuntime:g,interactionOnlyContainsBack:y,interactionContainsConditionalAction:_,timeout:i,maintained:c,interactionDuration:p,mediaHitTime:s,keyTrigger:m,interactionsOnSelectedNodes:n,recordingKey:as.Pt(e.recordingKey,i0.Qe)})}let EJ="prototype_interaction_edit_modal--contentContainer--bo2b4",Eq="prototype_interaction_edit_modal--ui3TwoColContentContainer--x9vrG",EZ="prototype_interaction_edit_modal--ui3SingleColContentContainer--uF-ir",E0="prototype_interaction_edit_modal--dividerHorizontal--3wvnB",E1="prototype_interaction_edit_modal--ui3InteractionsPanelContentRight--bVfG8";function E4(e){let{selectedInteractions:t,makeUpdateSelectionPropertiesForActionIndex:n,makeUpdateMultipleDestinationNodesForActionIndex:a,differentLengthActions:o,mergedActions:l}=(0,i4.Ay)(e.category),i="NONE"!==(0,rl.E7)(e.interactionType),s=void 0!==l.find(e=>"CONDITIONAL"===e.connectionType),{selectedActionIndex:c,onSelect:p}=e,m=(0,ew.GS)(),u=(0,i0.YT)(),E=u===i0.Oz.SINGLE_COL,g=u===i0.Oz.TWO_COL,{expandedRows:y,setExpandedRows:_,deleteButtonPressed:h,newActionIndexPath:f,resetNewActionIndexPath:v}=e;r.useEffect(()=>{f&&!f?.equals([])&&(m?p(f.path,!0):(_([...y,f]),p([],!1)),v())},[y,_,f,v,p,m]);let b=r.useCallback(e=>{y.find(t=>t.equals(e))?_(y.filter(t=>!t.equals(e))):_([...y,new uG.Op(e)])},[y,_]),S=r.useCallback(n=>{var a=n.dropItem;if((0,rl.gl)(a)||(0,uG.qQ)(n.dragItem))return;let r=e.interactionsOnSelectedNodes;if(!r||!t)return;for(var o=0;o<t?.length;o++){let e=t[o];if(e&&e.actions){let r=e.actions,l=(0,uG.Vp)(r,c,y,a,n.position);if(l.newSelectedActionIndex&&g&&p(l.newSelectedActionIndex.path,!0),l.newActions&&(t[o].actions=l.newActions,m||p([],!1)),l.newExpandedRows){if(g){let e=[];l.newActions?.forEach((t,n)=>{"CONDITIONAL"===t.connectionType&&e.push(new uG.Op([n]))}),_(e)}else _(l.newExpandedRows)}}}let l=r.map(e=>t.find(t=>t.id===e.id)??e);ac.Y5.updateSelectionProperties({prototypeInteractions:l})},[y,_,e.interactionsOnSelectedNodes,c,t,p,m,g]),T=eG()({"prototype_interaction_edit_modal--panelUI3--WK3CN":m,"prototype_interaction_edit_modal--panelUI3TwoColumn--V5gi4":g});return r.createElement(mU.hh,null,r.createElement(rw.Zk,{className:T},e.shouldHideTitle?null:r.createElement(rw.fI,null,r.createElement(rw.U8,{title:(0,d.t)("proto.interaction.interaction"),dataTooltipContentKey:mG,dataTooltipTimeoutDelay:50})),r.createElement("div",null,(i||m)&&r.createElement(r.Fragment,null,E&&r.createElement(r.Fragment,null,r.createElement(EQ,{category:e.category,recordingKey:i0.dJ,headerButtons:r.createElement(r.Fragment,null)}),r.createElement("div",{className:"prototype_interaction_edit_modal--dividerHorizontalUI3--HMCeE"})),o&&r.createElement(pr.Y,{direction:"horizontal",padding:{horizontal:16,vertical:12}},r.createElement(rw.UZ,null,(0,d.tx)("fullscreen.properties_panel.click_plus_to_replace_mixed_content"))),!o&&r.createElement(r.Fragment,null,l?.map((o,i)=>r.createElement(EM,{key:i,updateMultipleDestinationNodes:a(i),action:o,recordingKey:as.Pt(e.recordingKey,i0.eG,i),updateSelectionProperties:n(i),onDeleteAction:()=>h(i),interactionType:e.interactionType,actionIndexPath:[i],numActions:l.length,isNestedInConditional:!1,isNarrowPanel:!s,stateManagementVersion:e.stateManagementVersion,selectedInteractions:t,onDrop:S,onSelect:e.onSelect,onExpand:b,selectedActionIndex:c,autoOpenVariablePicker:e.autoOpenVariablePicker,expandedRows:y,onNewActionAdded:e.onNewActionAdded,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder})))))))}function E2({transition:e,recordingKey:t,updateSelectionProperties:n,stateManagementVersion:a,selectedInteractions:l}){let i=(0,o.wA)(),s=(0,ew.GS)(),c=(0,i0.YT)()===i0.Oz.SINGLE_COL,m=()=>{for(let t of(ez.az.trackDefinedEvent("prototype.state_management_noodle_upgraded",{num_interactions:l.length,preserve_scroll_position_value:!!e.preserveScroll}),l))(0,i0.uU)(t.stateManagementVersion)&&t.id&&t.sourceNodeID&&Ep.zZ.recordInteractionUpgraded(t.id,t.sourceNodeID);n({...(0,rl.hS)(e.preserveScroll)&&(0,rl.hS)(a)?{transitionResetScrollPosition:!e.preserveScroll}:{},stateManagementVersion:1}),i(p.F.enqueue({type:"state-management-updated",message:(0,d.t)("proto.state_management.visual_bell_updated_message"),button:{text:(0,d.t)("proto.state_management.visual_bell_update_all"),action:()=>{ac.Y5.triggerActionInUserEditScope("update-interactions-state-management-on-page"),i(p.F.enqueue({type:"state-management-updated-all",message:(0,d.t)("proto.state_management.visual_bell_update_all_message")}))}}}))},u=()=>{ez.az.trackDefinedEvent("prototype.state_management_noodle_reverted",{num_interactions:l.length}),n({stateManagementVersion:0})},E=1===a?r.createElement(am.$n,{variant:"link",recordingKey:as.Pt(t,"revert-state-management-version"),onClick:u,htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,d.tx)("proto.state_management.revert_controls")):r.createElement(am.$n,{variant:"secondary",recordingKey:as.Pt(t,"update-state-management-version"),onClick:m},(0,d.tx)("proto.state_management.update_controls")),g=c?am.IK:am.$n,y=1===a?r.createElement(g,{variant:"secondary",onClick:u,recordingKey:as.Pt(t,"revert-state-management-version"),htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,d.tx)("proto.state_management.revert_controls")):r.createElement(g,{variant:"primary",onClick:m,recordingKey:as.Pt(t,"update-state-management-version")},(0,d.tx)("proto.state_management.update_controls")),_=1===a?(0,d.tx)("proto.state_management.new_controls"):(0,d.tx)("proto.state_management.old_controls"),h=r.createElement(M.N,{trusted:!0,newTab:!0,href:"https://help.figma.com/hc/articles/14397859494295"},s?(0,d.tx)("proto.state_management.controls_help_link_new"):(0,d.tx)("proto.state_management.controls_help_link")),f=r.createElement("div",{className:"prototype_state_management_version_panel--versionControls--siAOf"},r.createElement(rw.JU,{className:"prototype_state_management_version_panel--label--vvYMX"},_,h),r.createElement("div",{className:"prototype_state_management_version_panel--buttonContainer--rJZ-y"},E)),v=r.createElement("div",{className:"prototype_state_management_version_panel--containerUI3--V5tpG"},r.createElement(iV.J,null,_),r.createElement(iV.J,null,h),y),b=r.createElement("div",{className:"prototype_state_management_version_panel--containerUI3TwoCol--AAp8u"},r.createElement("span",{className:"prototype_state_management_version_panel--labelWrapperUI3--37g5A"},r.createElement(iV.J,null,_)),r.createElement("span",{className:"prototype_state_management_version_panel--helpLinkWrapperUI3--BttuC"},h),y);return r.createElement(rf.k,{name:"prototype_state_management_version_panel"},r.createElement(rw.Zk,{className:s?"prototype_state_management_version_panel--panelUI3--8-Db5":void 0},s?c?v:b:f))}let E8="created_noodle";function E5(e){let{shouldHideTitle:t=!1,category:n,newActionIndexPath:a}=e,o=(0,i0.YT)()===i0.Oz.TWO_COL,{detailProps:l,detailPropsMultipleActions:i,interactionsOnSelectedNodesAndComponents:s,updateSelectionProperties:c,selectedInteractions:d}=(0,i4.Ay)(e.category);(0,eW.h)(()=>{if(void 0!==mV.sn.get(E8)){let e=mV.sn.stop(E8);(0,ez.sx)(E8,{elapsedMs:e,numConnectors:d.length},{forwardToDatadog:!0})}});let{showPanel:p,transition:m}=(0,i0.n6)(l,i,d),{interactionType:u="NONE",interactionMaintained:E=!1,interactionDuration:g=.3,keyTrigger:y=EX,transitionTimeout:_=.8,mediaHitTime:h=0}=i.interactionEvent,f=(0,i0.iC)(d),v=r.createElement(E4,{interactionType:u,timeout:_,mediaHitTime:h,maintained:E,interactionDuration:g,keyTrigger:y,recordingKey:as.Pt(e,i0.Qe),shouldHideTitle:t,interactionsOnSelectedNodes:s,category:n,stateManagementVersion:f,autoOpenVariablePicker:e.autoOpenVariablePicker,newActionIndexPath:a,resetNewActionIndexPath:e.resetNewActionIndexPath,onNewActionAdded:e.onNewActionAdded,onSelect:e.onSelect,selectedActionIndex:e.selectedActionIndex,expandedRows:e.expandedRows,setExpandedRows:e.setExpandedRows,deleteButtonPressed:e.deleteButtonPressed,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder});return r.createElement("div",null,v,!o&&p&&r.createElement(E2,{transition:m,recordingKey:as.Pt(e,"stateManagementVersionPanel"),updateSelectionProperties:c,stateManagementVersion:f,selectedInteractions:d}))}var E3=n(235733),E7=n(436347);function E6(e,t,n){let[a,r,o]=e.path,l=t[a].conditionalActions;if((0,rl.hS)(l)){let e=l?.[r].actions?.length??0;if(o>=e){if(0===e){n([a],!0);return}n([a,r,o-1],!0);return}}}function E9(e,t,n){let a=e.path[0]>=t.length,r=0===e.path.length;if(a){n([t.length-1],!0);return}if(r){n([0],!0);return}}var ge=n(277687);let gt=()=>{i.glU.setSelectedInteractions([]),(0,s.kc)().prototype_ai_magic_link_show_suggestion_toast&&ac.Y5.showMagicLinkSuggestedVisualBell("create_node_transition"),ac.Y5.deselectProperty()},gn=(0,nK.jz)("197px"),ga=(0,nK.c8)("50%");function gr(e){var t;return e&&a?.height<369?a=t={...a,height:369}:a??={width:440,height:e?369:320,leftWidthPct:45}}let go=r.memo(function(){let e=(0,o.d4)(gc),t=(0,i4.HS)(),{selectedInteractions:n}=(0,i4.Ay)(t),a=n.length>0,[l,i]=r.useState(!1),s=as.v_(i0.dJ,"keydown",t=>"Shift"!==t.key?as.aH:(i(!0),e&&a)?void 0:as.aH),c=as.v_(i0.dJ,"keyup",t=>"Shift"!==t.key?as.aH:(i(!1),e&&a)?void 0:as.aH);if(r.useEffect(()=>(document.addEventListener("keydown",s),document.addEventListener("keyup",c),()=>{document.removeEventListener("keydown",s),document.removeEventListener("keyup",c)}),[s,c]),!e||!a)return null;let d=n.some(e=>e.actions?.some(e=>"CONDITIONAL"===e.connectionType));return r.createElement(gl,{category:t,containsConditional:d,pressingShiftKey:l,initialX:e.initialX,initialY:e.initialY,shouldPin:e.shouldPin,setPressingShiftKey:i})}),gl=r.memo(function({category:e,containsConditional:t,pressingShiftKey:n,initialX:l,initialY:s,shouldPin:c,setPressingShiftKey:p}){let m=(0,o.wA)(),[u,E]=r.useState(!1),[,g]=(0,y.fp)(E7.x),_=(0,r.useRef)(null),[h,f]=r.useState(!1),v=c||u,b=(0,ew.GS)(),S=(0,i0.YT)(),T=S===i0.Oz.SINGLE_COL,I=S===i0.Oz.TWO_COL,[P,C]=r.useState(new uG.Op(b?[0]:[])),{selectedInteractions:k,differentLengthActions:A,interactionsOnSelectedNodesAndComponents:w,mergedActions:O,detailProps:x,detailPropsMultipleActions:R,updateSelectionProperties:L}=(0,i4.Ay)(e);var D=P.path.length>0?P:new uG.Op([0]);let M=D.isConditional(),K=(e,t)=>D=new uG.Op(e);b&&D.path[0]>=O.length&&!M?E9(P,O,K):b&&M&&E6(P,O,K);let F=r.useCallback((e,t)=>{t?C(new uG.Op(e)):C(new uG.Op([]))},[]);r.useEffect(()=>{if((0,mM.vA)(O.length>0,"the interactions panel should always have actions if rendered"),!b)return;let e=P.isConditional();if(e){if(e){E6(P,O,F);return}}else{E9(P,O,F);return}},[O,P,b,F]);let{shouldShowAdvancedPrototypingPaywall:V,showAdvancedPrototypinglMultipleActionsModal:U}=(0,i0.zt)(),{showPanel:B,transition:G}=(0,i0.n6)(x,R,k),z=(0,i0.iC)(k);var W=[];I?O.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&W.push(new uG.Op([t]))}):O.length<4&&O.forEach((e,t)=>{W.push(new uG.Op([t]))});let[H,Y]=r.useState(W),$=r.useRef(null),X=n&&!v&&!h,j=(0,nK.jz)(sl.prototypeInteractionModalWidth),Q=(0,nK.jz)(sl.prototypeInteractionModalExpandedWidth),J=gr(B).width,q=t?Q:j;I&&(q=J);let[Z,ee]=r.useState(c),et=(0,N._X)({subscribeToUpdates_expensive:!c}),en=r.useCallback(()=>{u||(m((0,io._P)({name:"prototype_interaction_details_modal_dragged"})),E(!0))},[m,u,E]),ea=r.useMemo(()=>{let e=new tL.Mi(l,s);if(c)return I?new tL.Mi(e.x-(J-j),e.y):t?new tL.Mi(e.x-(Q-j),e.y):e;{let t=(0,N.$g)(et,e);return new tL.Mi(t.x-q/2,t.y+30)}},[q,l,s,t,c,et,I,Q,j,J]);r.useEffect(()=>{if(!n)return;let e=e=>{!e.shiftKey&&n&&p(!1)};return document.addEventListener("mousemove",e),()=>{document.removeEventListener("mousemove",e)}},[n,p]),r.useEffect(()=>{g(X)},[g,X]),r.useEffect(()=>{ee(c)},[c]),r.useEffect(()=>()=>{m((0,io._P)({name:"prototype_interaction_details_modal_closed"}))},[m]);let el=r.useRef(null),[ei,es]=r.useState(!1);r.useEffect(()=>{ei&&(es(!1),el.current?.scrollToBottom())},[ei,es,el]);let[ec,ed]=r.useState(new uG.Op([])),ep=(0,eo.q5)(),em=r.useCallback((e,t)=>{let n=e.event.clipboardData||window.clipboardData;switch(t){case rC.zy.COPY:case rC.zy.CUT:{let a=JSON.parse(JSON.stringify(k)),r=(0,E3.l)(a),o=cP.fG(ep?.key||null,{prototypeInteractions:r});if(cP.C4(n,o,""),t===rC.zy.CUT){let e=[];for(let t of k){let{sourceNodeID:n,id:a}=t;n&&a&&e.push(iG.d({nodeID:n,interactionID:a}))}rE.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(e)),ac.Y5.deselectProperty()}e.accept()}}},[ep?.key,k]),eu=r.useRef(!1),[eE,eg]=r.useState(!1),{firstVariableSetMode:ey,firstVariableSetID:e_}=uf(),eh=(0,er.p8)("currentPage"),ef=r.useCallback((e,t,n,a)=>{m((0,io._P)({name:"Prototype delete action",params:{action:e,source:"panel",connector_id:t,page_id:n,actionInConditionalAction:a}}))},[m]),ev=r.useCallback(e=>{if(w&&k){var t=!1,n=!1;if(V)U();else{for(let o=0;o<k?.length;o++){let l=k[o],i=[];if(l&&l.actions){var a=0,r=[];for(let o=0;o<l.actions.length;o++){let s=l.actions[o];if(o!==e)void 0!==H.find(e=>e.equals([o]))&&r.push(new uG.Op([a])),i.push(s),a++;else{let e=l.id?l.id:ir.Hr;ef(s.connectionType?s.connectionType:"NONE",(0,ir.dI)(e),eh),o===l.actions.length-1&&(t=!0),2===l.actions.length&&(n=!0)}Y(r)}k[o].actions=i}}let o=w.map(e=>k.find(t=>t.id===e.id)??e);ac.Y5.updateSelectionProperties({prototypeInteractions:o}),n&&b&&Y([new uG.Op([0])]),t&&I&&C(new uG.Op([e-1]))}}},[w,k,V,U,H,eh,ef,I,b]),eb=r.useCallback(e=>{if(!w||!k||!e.path.length||void 0===e.path[0])return;let[t,n,a]=e.path,r=e.isConditional();if(V)U();else if(r){let e=!1,r=!1,o=k.map(o=>{let l=o.actions;if(!l)return o;let i=l.map((l,i)=>{if(i!==t||"CONDITIONAL"!==l.connectionType)return l;let s=l.conditionalActions;if(!s)return l;let c=s.map((t,l)=>{if(l!==n)return t;let i=t.actions;if(!i)return t;let s=i[a];s&&ef(s.connectionType?s.connectionType:"NONE",(0,ir.dI)(o.id??ir.Hr),eh,!0);let c=i.filter((e,t)=>t!==a);return e=a===i.length-1,r=0===c.length,{...t,actions:c}});return{...l,conditionalActions:c}});return{...o,actions:i}}),l=w.map(e=>o.find(t=>t.id===e.id)??e);ac.Y5.updateSelectionProperties({prototypeInteractions:l}),r?C(new uG.Op([t])):!r&&e&&C(new uG.Op([t,n,a-1]))}else ev(t);document.activeElement?.blur()},[w,k,V,U,ev,eh,ef]),eS=r.createElement(mK.P,{className:I?"prototype_interaction_edit_modal--ui3TwoColScrollContainer--IWuQ4":EJ,useBottomPinning:!I,ref:el,allowScrollAndZoomOver:!0,"data-not-draggable":!0},r.createElement(E5,{shouldHideTitle:!0,recordingKey:I?as.Pt("leftCol",i0.dJ):i0.dJ,category:e,autoOpenVariablePicker:eu,newActionIndexPath:ec,resetNewActionIndexPath:()=>{ed(new uG.Op([]))},onNewActionAdded:e=>{ed(e)},selectedActionIndex:P,onSelect:F,expandedRows:H,setExpandedRows:Y,deleteButtonPressed:ev,autoOpenExpressionBuilder:eE,setAutoOpenExpressionBuilder:eg})),eT=1===k.length,eN=k[0],eI=eN.actions&&eN.actions.length<2,eP=eN.actions&&1===eN.actions.length&&eN.actions[0],eC=!eP||"NONE"===eP.connectionType,ek=eT&&eI&&eC;var eA=ir.Hr;let eO=r.createElement(uY,{skipPaywall:ek,addButtonPressed:e=>{if(!k)return;if(("CONDITIONAL"===e.connectionType||"SET_VARIABLE"===e.connectionType||"SET_VARIABLE_MODE"===e.connectionType)&&V){U();return}"SET_VARIABLE_MODE"===e.connectionType&&(e.targetVariableSetID=e_,e.targetVariableModeID=ey),"SET_VARIABLE"===e.connectionType&&eu&&(eu.current=!0),b&&"CONDITIONAL"===e.connectionType&&eg(!0);let t=!1;var n=null,a=b&&!A&&!ek&&k[0].actions&&1===k[0].actions.length;if(A||ek)for(var r=0;r<k.length;r++){let t=k[r];t.actions=[e];let n=t.id,a=t.sourceNodeID;(0,i0.uU)(t.stateManagementVersion)&&n&&a&&Ep.zZ.recordInteractionUpgraded(n,a),t.stateManagementVersion=1}else for(var r=0;r<k.length;r++){let a=k[r];if(a.actions){if((0,i0.uU)(a.stateManagementVersion)&&(a.id&&a.sourceNodeID&&Ep.zZ.recordInteractionUpgraded(a.id,a.sourceNodeID),a.actions?.forEach(e=>{e.transitionResetScrollPosition=!e.transitionPreserveScroll})),I){if(P.isConditional()){let n=P.path[0],r=P.path[1],o=P.path[2],l=a.actions?.[n],i=l.conditionalActions?.[r].actions?.length??0;n===a.actions.length-1&&o===i-1&&(t=!0),l.conditionalActions?.[r].actions?.splice(o+1,0,e)}else{let n=P.path[0]+1;n===a.actions.length&&(t=!0),a.actions?.splice(n,0,e)}}else a.actions?.push(e);eA=a.id?a.id:ir.Hr}else a.actions=[e],eA=a.id?a.id:ir.Hr;if(a.stateManagementVersion=1,I){let e=[...P.path];e[e.length-1]+=1,n=new uG.Op([...e])}else n=new uG.Op([a.actions.length-1])}let o=w.map(e=>k.find(t=>t.id===e.id)??e);if(ac.Y5.updateSelectionProperties({prototypeInteractions:o}),a||I){var l=[];o[0].actions?.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&l.push(new uG.Op([t]))}),Y(l)}es&&(!I||t)&&es(!0),ed&&ed(n),m((0,io._P)({name:"Prototype add action",params:{action:e.connectionType?e.connectionType:"NONE",source:"panel",connector_id:(0,ir.dI)(eA),page_id:eh}}))},renderButton:!0,recordingKey:i0.dJ,isNestedInConditional:I&&P.isConditional()}),ex=k.some(e=>void 0!==e.actions&&e.actions?.length>1),eR=!P.isConditional()&&!ex,eL=r.createElement(eV.K,{onClick:()=>eb(P),"aria-label":(0,d.t)("proto.prototype_panel.delete"),disabled:eR,recordingKey:as.Pt(i0.dJ,"actionDeleteButton"),htmlAttributes:{"data-tooltip":(0,d.t)("proto.prototype_panel.delete"),"data-tooltip-type":rM.Ib.TEXT}},r.createElement(rD.U,{svg:EL.A},r.createElement(iU.O,null))),eD=r.createElement("div",{className:"prototype_interaction_edit_modal--ui3FooterContainer--oYsXM"},eO," ",eL),eM=r.createElement(m0.c.Provider,{value:m0.P.LEFT},r.createElement("div",{className:I?"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeftResizable--16pLu":"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeft--UYWSG",ref:$,style:I?{width:`${gr(B).leftWidthPct}%`}:void 0},r.createElement(EQ,{category:e,recordingKey:i0.dJ,headerButtons:r.createElement(r.Fragment,null)}),r.createElement("div",{className:E0}),eS,r.createElement("div",{className:E0}),r.createElement(r.Fragment,null,eD))),eK=O.length>0?r.createElement(m0.c.Provider,{value:m0.P.RIGHT},r.createElement(mK.P,{allowScrollAndZoomOver:!0,"data-not-draggable":!0,className:I?"prototype_interaction_edit_modal--ui3ScrollContainerRight--LJr-n":void 0},r.createElement(gi,{selectedActionIndex:D,handleExpandUI3:(e,t)=>{!t&&O.length>1?Y(H.filter(t=>!t.equals(e))):H.find(t=>t.equals(e))||Y([...H,new uG.Op(e)])},autoOpenVariablePicker:eu,autoOpenExpressionBuilder:eE,setAutoOpenExpressionBuilder:eg}))):null,eF=r.useRef(gn),[,eU]=(0,mD.i)({disabled:!I,onDragStart(){$.current&&(eF.current=$.current.getBoundingClientRect().width)},onDrag(e){if($.current&&eF.current){let t=gr(B),n=eF.current+e.delta.x,r=n/t.width*100;n<gn?r=gn/t.width*100:r>ga&&(r=ga),$.current.style.width=`${r}%`,a={...t,leftWidthPct:r}}}}),eB=I?r.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColPanelContainer--e8MK8"},r.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColInnerContainer--ZvJj2"},eM,r.createElement("div",{className:"prototype_interaction_edit_modal--dividerVertical--Noi1C"},r.createElement("div",{...eU({className:"prototype_interaction_edit_modal--verticalResizeHandle--xkc8V"})})),eK),B&&r.createElement(E2,{transition:G,recordingKey:as.Pt(i0.dJ,"stateManagementVersionPanel"),updateSelectionProperties:L,stateManagementVersion:z,selectedInteractions:k})):eS;return r.createElement(mF.ht.Provider,{value:r.useMemo(()=>({autoCloseOnScroll:!v}),[v])},r.createElement(rk.vL,{name:"Prototype Draggable modal",className:"prototype_interaction_edit_modal--prototypeDraggableModal--njJ6A",handleClipboard:em},r.createElement(lW.vx,{ref:_,dataTestId:"in-context-prototype-interaction-edit-modal",title:t=>r.createElement("div",{className:"prototype_interaction_edit_modal--onboardingRow--UlvE0"},r.createElement(gs,{category:e,recordingKey:i0.dJ,createActionTrigger:eO,closeButton:t})),containerClassName:eG()({[EJ]:!I,[Eq]:I,[EZ]:T,"prototype_interaction_edit_modal--abovePropertiesPanel--hFejC":Z,"prototype_interaction_edit_modal--belowPropertiesPanel--f1Jfl":!Z,"prototype_interaction_edit_modal--modalExpandedWidth--IDl6k":t&&!b,"prototype_interaction_edit_modal--modalWidth--cCH7B":!t&&!b,"prototype_interaction_edit_modal--hideModal--RSp-R":X}),contentContainerClassName:eG()({[EJ]:!I,[Eq]:I,[EZ]:T}),headerClassName:"prototype_interaction_edit_modal--multilineInteractionDetailsHeader--OE8Wr",allowWheelPassthrough:!0,initialPosition:ea,headerSize:"small",onClose:gt,recordingKey:"interactionDetailsModal",arrowPosition:c?void 0:lW.F_.TOP,arrowRelativeX:c?void 0:q/2,onDragStart:()=>{ee(!0),en()},canRenderBelowViewport:!0,allowAutoExpanding:!0,dragHeaderOnly:!0,onFocus:()=>f(!0),allowResizeHeight:I,allowResizeWidth:I,fullFrame:I,minWidth:I?440:void 0,minHeight:I?B?369:320:void 0,maxWidth:I?800:void 0,maxHeight:I?800:void 0,initialHeight:I?gr(B).height-lW.uF:void 0,initialWidth:I?gr(B).width:void 0,onResize:I?e=>{a={...gr(B),height:e.height,width:e.width}}:void 0},b?eB:eS)))});function gi({selectedActionIndex:e,autoOpenVariablePicker:t,handleExpandUI3:n,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:o}){let l=(0,i4.HS)(),{selectedInteractions:i,mergedActions:s,makeUpdateSelectionPropertiesForActionIndex:c,makeUpdateMultipleDestinationNodesForActionIndex:d,detailPropsMultipleActions:p}=(0,i4.Ay)(l),m=e.path[0],u=d(m),E=c(m),g=(0,i0.iC)(i),y=p.interactionEvent.interactionType??"NONE";if(e.isConditional()){let n=e.path[1],l=e.path[2],c=s[m],d=((0,rl.hS)(c.conditionalActions)&&c.conditionalActions?c.conditionalActions:[])[n],p=d?.actions?.[l];return p?r.createElement("div",{className:E1},r.createElement(EM,{key:l,updateMultipleDestinationNodes:u.appendActionIndex(n).appendActionIndex(l),action:p,recordingKey:as.Pt(i0.dJ,i0.Qe,i0.eG,m),updateSelectionProperties:E.appendActionIndex(n).appendActionIndex(l),onDeleteAction:z.lQ,interactionType:y,actionIndexPath:e.path,numActions:s.length,isNestedInConditional:!0,stateManagementVersion:g,selectedInteractions:i,onDrop:z.lQ,onSelect:z.lQ,onExpand:z.lQ,selectedActionIndex:e,expandedRows:[e],autoOpenVariablePicker:t,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:o,isNarrowPanel:!0})):null}return r.createElement("div",{className:E1},r.createElement(EM,{key:m,updateMultipleDestinationNodes:u,action:s[m],recordingKey:as.Pt(i0.dJ,i0.Qe,i0.eG,m),updateSelectionProperties:E,onDeleteAction:z.lQ,interactionType:y,actionIndexPath:[m],numActions:s.length,isNestedInConditional:!1,stateManagementVersion:g,selectedInteractions:i,onDrop:z.lQ,onSelect:z.lQ,onExpand:n,selectedActionIndex:e,autoOpenVariablePicker:t,expandedRows:[e],autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:o,isNarrowPanel:!0}))}function gs({category:e,recordingKey:t,closeButton:n,createActionTrigger:a}){let l=(0,o.wA)(),{selectedInteractions:c}=(0,i4.Ay)(e),p=(0,i0.YT)(),m=p===i0.Oz.TWO_COL,u=p===i0.Oz.SINGLE_COL,E=(()=>{if(1!==c.length)return 0;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id};return i.X3B.getMatchingInteractions(iG.d(t)).length})(),g=(0,s.kc)().prototype_hide_matching_noodles&&1===c.length&&E>1&&r.createElement(eV.K,{actionOnPointerDown:!0,onClick:()=>{if(1!==c.length)return;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=i.X3B.getMatchingInteractions(iG.d(t));i.glU.selectInteractionsAndSourceNodes(n);let a=(0,d.t)("proto.interaction_details.visual_bell.selected_n_matching_interactions",{total_num_interactions:n.length});ac.Y5.showVisualBellWithUndo("selected-matching-noodles",a,!1),l((0,io._P)({name:"prototype_select_matching_interactions",params:{num_connectors:n.length}}))},"aria-label":(0,d.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:E}),htmlAttributes:{tabIndex:-1,onMouseEnter:()=>{if(1!==c.length)return;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=i.X3B.getMatchingInteractions(iG.d(t));i.glU.hoverInteractions(n)},onMouseLeave:()=>i.glU.hoverInteractions([]),"data-tooltip":(0,d.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:E}),"data-tooltip-type":rM.Ib.TEXT}},r.createElement(rD.U,{svg:ge.A},r.createElement(nz.A,null))),y=r.createElement(EQ,{category:e,recordingKey:t,headerButtons:r.createElement(r.Fragment,null,g,a,n)}),_=r.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeader--Ka7aM"},(0,d.tx)("proto.interaction_details.header"),r.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeaderButtons--UqykU"},g,n)),h=r.createElement(r.Fragment,null,(0,d.tx)("proto.interaction_details.header"),r.createElement("div",{className:"prototype_interaction_edit_modal--ui3CollapsedModalHeaderButtons--7yPuD"},g,a,n));return m?_:u?h:y}let gc=e=>e.pickerShown?.id===tM.o$?e.pickerShown:null;var gd=n(61916),gp=n(921742),gm=n(29717),gu=n(988947),gE=n(161883),gg=n(146942),gy=n(326864),g_=n(369717),gh=n(882203),gf=n(976667),gv=n(645374);let gb="offscreen_indicators--indicatorGraphicBlue---nYr-",gS="offscreen_indicators--indicatorGraphicPurple--FAz-M",gT=(0,nK.jz)(rF.J4v),gN=(0,nK.jz)(rF.v5y),gI=(0,nK.jz)(rF.M$q),gP=(0,nK.jz)(rF.y9S);function gC(){let e=[],t=(0,sY.kl)("selectionRegions"),n=(0,rl.E7)(t);n&&(e=n);let a=(0,o.d4)(e=>e.mirror.appModel.hoveredNode);if(a&&(0,s.kc)().ce_offscreen_indicators_for_hovered_nodes){let t=(0,E.UN)().get(a);if(t){let n=t.absoluteBoundingBox;e=[...e,{bounds:{height:n.h,width:n.w,x:n.x,y:n.y},regionType:t.isPrimaryInstance||t.isInstanceSublayer||t.isComponentish||t.isSymbolSublayer?i$.fV.SYMBOLS_ONLY:i$.fV.MIXED_OR_NO_SYMBOLS}]}}let l=!!e&&e.length>=1,i=(0,N._X)({subscribeToUpdates_expensive:l});return i&&e?r.createElement(gk,{viewportInfo:i,regions:e}):null}function gk({viewportInfo:e,regions:t}){let n=(0,r.useContext)(gf.kw),a=(0,r.useMemo)(()=>n.getCommentsWrapperOffset(e),[n,e]),l=a.x,i=a.y,s={transform:`translate(${l}px, ${i}px)`},c=(0,ew.GS)(),d=(0,aj.b)(),p=c&&!d,m=(0,o.d4)(e=>e.mirror?.appModel.showUi),u=(0,aJ.dP)()+(p?gI:gT),E=(0,aJ.qw)()+u+(p?gI:gN),g=(0,eZ.Ye)(),{isPropertiesPanelCollapsed:y}=(0,a3.iT)(),_=(p&&m&&!g?u:0)-3.5,h=(p&&m&&!y?E:0)-7,f=(0,eS.J2)((0,aJ.UK)().renderRulers)&&m?gP:0,v={x:_+f,y:-3.5+f,width:e.width-h-f,height:e.height- -7-f},b={x:_+f,y:-3.5+f,width:e.width-h-f,height:e.height- -7-f};return r.createElement(r.Fragment,null,r.createElement(gv.p,null,r.createElement("div",{"aria-hidden":!0,"data-forward-events-to-fullscreen":!0,className:"offscreen_indicators--overlay--pNOlw",style:s},!!t?.length&&r.createElement("div",null,t.map((t,n)=>{let a=(0,N.Z0)(e,{x:t.bounds.x,y:t.bounds.y}),o=(0,N.Z0)(e,{x:t.bounds.x+t.bounds.width,y:t.bounds.y+t.bounds.height}),l={x:a.x,y:a.y,width:o.x-a.x,height:o.y-a.y};return l.x<v.x+v.width&&l.x+l.width>v.x&&l.y+l.height>v.y&&l.y<v.y+v.height?null:r.createElement(gA,{key:n,viewportBounds:b,viewportInfo:e,indicatorViewportBounds:l,selectionBoundsScaledWidth:function(e,t){let n=Math.max(e.x,t.x);return Math.max(Math.min(e.x+e.width,t.x+t.width)-n,10)}(l,b),selectionBoundsScaledHeight:function(e,t){let n=Math.max(e.y,t.y);return Math.max(Math.min(e.y+e.height,t.y+t.height)-n,10)}(l,b),selectionRegionType:t.regionType})})))))}function gA({viewportBounds:e,viewportInfo:t,indicatorViewportBounds:n,selectionBoundsScaledWidth:a,selectionBoundsScaledHeight:l,selectionRegionType:i}){let s=function(e,t){let n=0-t.x,a=0+e.width-t.x,r=0-t.y,o=0+e.height-t.y,l=Math.abs(n)<a?n:a,i=Math.abs(r)<o?r:o,s=n<0!=a<0,c=r<0!=o<0;return s&&c?Math.abs(l)<Math.abs(i)?{x:t.x+l,y:t.y}:{x:t.x,y:t.y+i}:!s&&c?{x:t.x+l,y:t.y}:s&&!c?{x:t.x,y:t.y+i}:{x:t.x+l,y:t.y+i}}(t,{x:n.x+n.width/2,y:n.y+n.height/2});s.x-=a/2,s.y-=l/2;let c=(0,o.d4)(e=>e.mirror?.appModel.showUi),d=(0,eS.J2)((0,aJ.UK)().renderRulers)&&c?gP:0,p=(0,ew.GS)(),m=(0,aj.b)(),u=p&&!m,E=u?gI:gT,g=u?gI:gN,y=(0,aJ.dP)()+E,_=(0,aJ.qw)()+g,h=(0,eZ.Ye)(),{isPropertiesPanelCollapsed:f}=(0,a3.iT)(),v=1+(c&&u&&!h?y+1:0)+d,b=Math.max(v,t.width-1-a-(c&&u&&!f?_+1:0)),S=1+d,T=Math.max(S,t.height-1-l-1),N=tL.Mi.bound(s,{min:{x:v,y:S},max:{x:b,y:T}}),I=n.y+n.height<e.y,P=n.y>e.y+e.height,C=n.x+n.width<e.x,k=n.x>e.x+e.width;N.x+=t.x,N.y+=t.y;let A=Math.min(t.width-2-(c&&u?_+y:0),a),w=Math.min(t.height-2,l);return r.createElement("div",{className:"offscreen_indicators--indicator---T9xk",style:{transform:`translate3D(${N.x}px, ${N.y}px, 0)`}},(I||P)&&r.createElement("div",{style:{position:"absolute",height:1.5,width:A,marginTop:P?w-1.5:0},className:eG()({[gb]:i===i$.fV.MIXED_OR_NO_SYMBOLS,[gS]:i===i$.fV.SYMBOLS_ONLY})}),(C||k)&&r.createElement("div",{style:{position:"absolute",left:0,height:w,width:1.5,marginLeft:k?A-1.5:0},className:eG()({[gb]:i===i$.fV.MIXED_OR_NO_SYMBOLS,[gS]:i===i$.fV.SYMBOLS_ONLY})}))}var gw=n(77266);let gO=r.memo(({shouldShowDragAndDropBorder:e})=>{let t=(0,er.p8)("isReadOnly"),n=(0,o.d4)(e=>e.progressBarState),a=(0,er.p8)("loadingEmbeds"),u=(0,eS.ut)(i.Ez5?.uiState().showCanvasSearch,!1),E=(0,eT.Lk)(),g=(0,r.useRef)(null),y=(0,o.d4)(e=>e.userFlags),_=!!(0,s.kc)().internal_only_debug_tools||!!y.has_cursor_bot_onboarding_v2,h=(0,o.d4)(e=>e.openFile),f=h?h.key:"",v=(0,o.d4)(e=>e.universalInsertModal),b=(0,o.wA)();(0,eg.Gb)(f),(0,eb.W)(),function(){let e=(0,lE.VW)(),t=(0,rg.ZC)(e?.guid),n=(0,er.p8)("activeUserAction"),a=(0,i5.LC)();r.useEffect(()=>{(e?.guid!==t&&t||![i.QOV.DEFAULT,i.QOV.CLICKING_TO_CHANGE_SELECTION].includes(n))&&(0,i9.KY)({actionToClear:i3.JT.FIND_INSPIRATION})},[e,n,t,a])}();let S=(0,ef.BI)(),T=(0,eE.l7)(),{fpl_accessible_areas_for_design:N,fpl_a11y_accessible_areas_fullscreen_shortcuts:I}=(0,s.kc)(),P=r.createElement(eI.e,{condition:!!(I&&N),wrapper:e=>r.createElement(eN.m,{role:"region","aria-label":(0,d.t)("fullscreen_actions.left_sidebar_label")},e)},T?r.createElement(c.tH,{boundaryKey:"DevModeLeftPanel",fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING,sentryTags:{area:l.eBU.DEVELOPER_TOOLS}},r.createElement(m.O,null)):r.createElement(mb,null));return r.createElement(aH,null,r.createElement(ey.ED,null),r.createElement(cf.sk,null,n.mode!==i.Oin.OFF&&r.createElement("div",{className:gw._q}),r.createElement(nR.pO,{initialFilterState:{currentPage:!1}},a.map(e=>r.createElement(aB._,{key:`loading-embed-${e}`,nodeId:e})),r.createElement(cv.qn,null),r.createElement(g_.u,null),u&&r.createElement(mI.n,null),(0,s.kc)().ce_al_experiments_on&&r.createElement(mI.n,null),r.createElement(aU.GR,null),r.createElement(aU.bu,null),r.createElement(gp.J,null),r.createElement(cv.XI,{commentsDetailContainerRef:g}),r.createElement(gC,null),(0,s.kc)().cursor_bot&&_&&r.createElement(mT.S,null),r.createElement(cB,null),r.createElement(aF.J,null),r.createElement(mS.Nz,null),r.createElement("div",{ref:g}),!(0,eh.T)()&&P,!t&&r.createElement(go,null),r.createElement(aV.G,null,T?null:r.createElement(r.Fragment,null,r.createElement(gx,null),!!S?.shouldOptimizeForIpadApp&&r.createElement(gg.K,null),!!S?.shouldOptimizeForIpadApp&&r.createElement(gy.t,null))),e&&r.createElement(mS.X5,null),(0,s.kc)().aip_flower_garden&&r.createElement(aR,null)),r.createElement(eP.A,{isFigjamEditor:!1,isDesignEditor:!0,isSlidesEditor:!1,openFile:h}),r.createElement(gd.l,{defaultViewTabsAvailable:!0,defaultViewAssetsTabVisible:!0}),v.showing&&r.createElement(c.tH,{boundaryKey:"FdBrowseResourceModal",onError:()=>{b(p.F.enqueue({message:"Unable to open inserts menu",type:"react-error"}))},fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING},r.createElement(gu.k,null))),E&&r.createElement(mN.K,{className:gw.PA},r.createElement(gE.s,null)))}),gx=r.memo(function(){let e=(0,er.p8)("topLevelMode"),t=(0,er.ax)(),n=(0,er.dH)();return(0,ev.z)({topLevelMode:i.lyf.PREVIEW,eventName:"Preview Mode Selection Changed",teamFilesOnly:!0}),r.useEffect(()=>{t&&e===i.lyf.PREVIEW&&n!==i.NLJ.COMMENTS&&(0,e_.NT)(i.FAf.INSPECT)},[t,e,n]),r.createElement(r.Fragment,null,r.createElement(ch,null),r.createElement(gR,null))}),gR=r.memo(function(){return r.createElement(r.Fragment,null,r.createElement(eC.p,null,r.createElement(ek.L,null)),r.createElement(eC.p,{featureFlag:"starting_points_modal"},r.createElement(ta,null)),r.createElement(eC.p,null,r.createElement(eu,null)),r.createElement(eC.p,null,r.createElement(gm.e,null)),r.createElement(eC.p,null,r.createElement(R,null)),r.createElement(eC.p,null,r.createElement(L.A,null)),r.createElement(eC.p,null,r.createElement(tI,null)),r.createElement(eC.p,null,r.createElement(tO,null)),r.createElement(eC.p,{featureFlag:"mobile_prompt_sidebar_modal"},r.createElement(mR,null)),r.createElement(eC.p,null,r.createElement(D.S,null)),r.createElement(eC.p,null,r.createElement(nx,null)),r.createElement(eC.p,{featureFlag:"cmty_visual_assets_nux"},r.createElement(t_,null)))});function gL(){let[e,t]=(0,r.useState)(!1);return r.createElement(aG.c,{loadedCommentsProvider:!1},r.createElement(gh.v,{setShouldShowDragAndDropBorder:t,isDragTarget:!1},r.createElement(gO,{shouldShowDragAndDropBorder:e})))}},700201:(e,t,n)=>{"use strict";n.d(t,{f:()=>g});var a=n(411855),r=n(744952),o=n(462132),l=n(454475),i=n(171946),s=n(345202),c=n(248172),d=n(148467),p=n(216422),m=n(820139),u=n(260783),E=n(501191);function g({resolvedTypes:e,recordingKey:t}){let{showing:n,toggle:l,hide:p}=(0,s.BK)("expression-builder-create-variable"),m=a.useRef(null),g=r.rf(r.Pt(t,"createVariableDropdown"),"click",a.useCallback(()=>{1===e.length?v(e[0]):l()},[e,l])),[_,h]=a.useState(!1),f=a.useRef(null),v=e=>{let t=m.current?.getBoundingClientRect();t&&(f.current={initialPosition:new o.Mi(t.left,t.top),resolvedType:e},h(!0))},b=()=>{h(!1)};return a.createElement(a.Fragment,null,a.createElement("button",{ref:m,className:u.ZS,onClick:g},a.createElement(i.B,{svg:E.A})),_&&(_&&f.current?a.createElement(d.U,{initialPosition:f.current.initialPosition,initialWidth:d.i,resolvedType:f.current.resolvedType,onCreateVariable:b,onClose:b}):null),n&&m.current&&a.createElement(c.Cf,{arrowOffsetFromRectLeft:14,leanPadding:0,lean:"right",targetRect:m.current.getBoundingClientRect()},e.map(e=>a.createElement(y,{key:e,resolvedType:e,onClose:p,showCreationModal:v,recordingKey:t}))))}function y({resolvedType:e,onClose:t,showCreationModal:n,recordingKey:o}){let i=(0,m.F)(e),s=r.rf(r.Pt(o,"createVariableOption",i.name),"click",a.useCallback(()=>{n(e),t()},[t,e,n]));return a.createElement(l.c$,{className:u.Fs,onClick:s},a.createElement(p.i,{type:e,showTooltip:!1}),i.name)}},626502:(e,t,n)=>{var a=n(341692),r=0/0;e.exports=function(e,t){var n=null==e?0:e.length;return n?a(e,t)/n:r}},774886:(e,t,n)=>{var a=n(626502),r=n(109169);e.exports=function(e){return a(e,r)}}}]);

//# debugId=7baa5104-b8e8-590b-b8d5-69ff3dd61e38

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/213df8aa0d0aed12518649a10f0af2f87e57f7a0/fullscreen_design-2ddb2636df3777dc.min.js.map